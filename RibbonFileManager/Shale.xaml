<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:RibbonFileManager"
                    xmlns:Fluent="clr-namespace:Fluent;assembly=Fluent"
                    xmlns:FluentHelpers="clr-namespace:Fluent.Helpers;assembly=Fluent"
                    xmlns:converters="clr-namespace:Fluent.Converters;assembly=Fluent"
                    xmlns:conv="clr-namespace:Start9.UI.Wpf.Converters;assembly=Start9.UI.Wpf"
                    xmlns:disk="clr-namespace:WindowsSharp.DiskItems;assembly=WindowsSharp"
                    xmlns:ui="clr-namespace:Start9.UI.Wpf;assembly=Start9.UI.Wpf"
                    xmlns:win="clr-namespace:Start9.UI.Wpf.Windows;assembly=Start9.UI.Wpf"
                    xmlns:tic="clr-namespace:Start9.UI.Wpf.Statics;assembly=Start9.UI.Wpf"
                    xmlns:styleSelectors="clr-namespace:Fluent.StyleSelectors;assembly=Fluent"
                    xmlns:templateSelectors="clr-namespace:Fluent.TemplateSelectors;assembly=Fluent"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib"
                    xmlns:mgrbase="clr-namespace:NT6FileManagerBase;assembly=NT6FileManagerBase"
                    xmlns:e="http://schemas.microsoft.com/expression/2010/interactivity">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="pack://application:,,,/Start9.UI.Wpf;component/Themes/Shale.xaml"/>
        <!--ResourceDictionary Source="pack://application:,,,/Fluent;Component/Themes/Generic.xaml" /-->
        <!--ResourceDictionary Source="pack://application:,,,/Fluent;Component/Themes/Common.xaml" /-->
        <!--ResourceDictionary Source="pack://application:,,,/Fluent;component/Themes/Generic.xaml"/>
        <ResourceDictionary Source="pack://application:,,,/Fluent;component/Themes/Styles.xaml" />
        <ResourceDictionary Source="pack://application:,,,/Fluent;component/Themes/Themes/Light.Blue.xaml" /-->
    </ResourceDictionary.MergedDictionaries>
    
    <!--#region Converters-->
    
    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    <MenuScrollingVisibilityConverter x:Key="MenuScrollingVisibilityConverter"/>
    <converters:ObjectToImageConverter x:Key="ObjectToImageConverter"/>
    
    <!--#endregion Converters-->


    <!--#region Main Window Styles-->

    <Style x:Key="{x:Type local:MainWindow}" TargetType="{x:Type local:MainWindow}" BasedOn="{StaticResource {x:Type win:DecoratableWindow}}">
        <Setter Property="BorderThickness" Value="0,54,0,0"/>
    </Style>

    <Style x:Key="RootGridStyle" TargetType="{x:Type Grid}">
        <Setter Property="Margin" Value="0,24,0,0"/> <!--{Binding BorderThickness, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type win:DecoratableWindow}}}/-->
    </Style>

    <!--#endregion Main Window Styles-->


    <!--#region Main Ribbon Styles-->

    <Style x:Key="{x:Type Fluent:Ribbon}" TargetType="{x:Type Fluent:Ribbon}">
        <Setter Property="Background">
            <Setter.Value>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource HorizontalPanelBackgroundGradientStops}"/>
            </Setter.Value>
        </Setter>
        <Setter Property="BorderBrush" Value="{DynamicResource HorizontalPanelBorderBrush}"/>
        <Setter Property="BorderThickness" Value="0,0,0,1"/>
        <Setter Property="Foreground" Value="{DynamicResource ButtonForegroundBrush}" />
        <!--Setter Property="FocusVisualStyle" Value="{DynamicResource ControlStyleEmptyFocus}" /-->
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="Fluent:FrameworkHelper.UseLayoutRounding" Value="True" />
        <!--Setter Property="TitleBar" Value="{Binding TitleBar, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:IRibbonWindow}}, FallbackValue={x:Null}}" /-->
        <Setter Property="QuickAccessToolBarHeight" Value="24"/> <!--{Binding TitleBar.ActualHeight, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:IRibbonWindow}}, FallbackValue=23}" /-->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:Ribbon}">
                    <!--ControlTemplate.Resources>
                        <Style BasedOn="{StaticResource MenuSeparatorStyle}" TargetType="{x:Type Separator}" />
                    </ControlTemplate.Resources-->
                    <Border Background="Transparent">
                        <Grid x:Name="PART_LayoutRoot"  Width="Auto" Height="Auto">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Fluent:RibbonTabControl x:Name="PART_RibbonTabControl" Menu="{TemplateBinding Menu}" ContentHeight="{TemplateBinding ContentHeight}" ContextMenu="{Binding ContextMenu, ElementName=PART_LayoutRoot}" AreTabHeadersVisible="{TemplateBinding AreTabHeadersVisible}" IsToolBarVisible="{TemplateBinding IsToolBarVisible}" IsMouseWheelScrollingEnabled="{TemplateBinding IsMouseWheelScrollingEnabled}" />
                            <ContentControl x:Name="quickAccessToolBarHolder" Grid.Row="1" Height="{TemplateBinding QuickAccessToolBarHeight}" HorizontalAlignment="Left">
                                <Fluent:QuickAccessToolBar x:Name="PART_QuickAccessToolBar" ShowAboveRibbon="{Binding ShowQuickAccessToolBarAboveRibbon, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsMenuDropDownVisible="{TemplateBinding IsQuickAccessToolBarMenuDropDownVisible}" HorizontalAlignment="Left" Focusable="False" />
                            </ContentControl>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsQuickAccessToolBarVisible" Value="False">
                            <Setter Property="Visibility" TargetName="quickAccessToolBarHolder" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_QuickAccessToolBar" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="IsCollapsed" Value="True">
                            <Setter Property="Visibility" TargetName="PART_RibbonTabControl" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="quickAccessToolBarHolder" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="QuickAccessToolBar" Value="{x:Null}">
                            <Setter Property="Content" TargetName="quickAccessToolBarHolder" Value="{x:Null}" />
                            <Setter Property="Visibility" TargetName="quickAccessToolBarHolder" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ShowQuickAccessToolBarAboveRibbon" Value="True">
                            <Setter Property="Content" TargetName="quickAccessToolBarHolder" Value="{x:Null}" />
                            <Setter Property="Visibility" TargetName="quickAccessToolBarHolder" Value="Collapsed" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:RibbonTabControl}" TargetType="{x:Type Fluent:RibbonTabControl}">
        <Setter Property="VerticalAlignment" Value="Top"/>
        <Setter Property="Background" Value="{Binding Background, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:Ribbon}}}"/>
        <Setter Property="BorderBrush" Value="{Binding BorderBrush, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:Ribbon}}}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Foreground" Value="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:Ribbon}}}" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="CanMinimize" Value="{Binding CanMinimize, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:Ribbon}}, Mode=TwoWay}" />
        <Setter Property="IsMinimized" Value="{Binding IsMinimized, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:Ribbon}}, Mode=TwoWay}" />
        <Setter Property="ContentGapHeight" Value="{Binding ContentGapHeight, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:Ribbon}}}" />
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:RibbonTabControl}">
                    <ControlTemplate.Resources>
                        <Style TargetType="{x:Type ScrollViewer}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ScrollViewer}">
                                        <Grid x:Name="Grid" IsHitTestVisible="True">
                                            <ScrollContentPresenter  Margin="{TemplateBinding Padding}" x:Name="PART_ScrollContentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" CanContentScroll="{TemplateBinding CanContentScroll}" IsHitTestVisible="True" />
                                            <RepeatButton Command="{x:Static ScrollBar.LineLeftCommand}" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" Focusable="false" HorizontalAlignment="Left" Width="13" Height="Auto" VerticalAlignment="Stretch" Style="{DynamicResource ScrollButtonStyle}">
                                                <RepeatButton.Visibility>
                                                    <MultiBinding FallbackValue="Visibility.Collapsed" Converter="{StaticResource MenuScrollingVisibilityConverter}" ConverterParameter="0">
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ComputedHorizontalScrollBarVisibility" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="HorizontalOffset" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ExtentWidth" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ViewportWidth" />
                                                    </MultiBinding>
                                                </RepeatButton.Visibility>
                                                <Path Fill="{DynamicResource BlackBrush}" Stretch="Fill" Stroke="{x:Null}" StrokeThickness="0" HorizontalAlignment="Center" Margin="0" VerticalAlignment="Center" Width="3" Height="5" Data="M0,0L1,1 1,-1z" />
                                            </RepeatButton>
                                            <RepeatButton Command="{x:Static ScrollBar.LineRightCommand}" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" Focusable="false" HorizontalAlignment="Right" Width="13" Height="Auto" VerticalAlignment="Stretch" Style="{DynamicResource ScrollButtonStyle}">
                                                <RepeatButton.Visibility>
                                                    <MultiBinding FallbackValue="Visibility.Collapsed" Converter="{StaticResource MenuScrollingVisibilityConverter}" ConverterParameter="100">
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ComputedHorizontalScrollBarVisibility" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="HorizontalOffset" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ExtentWidth" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ViewportWidth" />
                                                    </MultiBinding>
                                                </RepeatButton.Visibility>
                                                <Path Fill="{DynamicResource BlackBrush}" Stretch="Fill" Stroke="{x:Null}" StrokeThickness="0" HorizontalAlignment="Center" Margin="0" VerticalAlignment="Center" Width="3" Height="5" Data="M1,0L0,1 0,-1z" />
                                            </RepeatButton>
                                        </Grid>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="CanContentScroll" Value="True" />
                            <Setter Property="HorizontalScrollBarVisibility" Value="Auto" />
                            <Setter Property="VerticalScrollBarVisibility" Value="Disabled" />
                            <Setter Property="PanningMode" Value="HorizontalOnly" />
                        </Style>
                    </ControlTemplate.Resources>
                    <Grid x:Name="ContentGrid" KeyboardNavigation.TabNavigation="Local" Height="Auto" VerticalAlignment="Top">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition x:Name="rowDefinition" MinHeight="{TemplateBinding ContentHeight}" MaxHeight="{TemplateBinding ContentHeight}" />
                            <RowDefinition x:Name="rowDefinition1" MinHeight="{TemplateBinding ContentGapHeight}" MaxHeight="{TemplateBinding ContentGapHeight}" />
                        </Grid.RowDefinitions>
                        <Border x:Name="border" HorizontalAlignment="Stretch" Margin="0,-1,0,0" Width="Auto" BorderThickness="0" Grid.Row="1" BorderBrush="{Binding Path=SelectedItem.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                        <!--Border HorizontalAlignment="Stretch" Margin="1,0,1,0" Grid.Row="1" Grid.RowSpan="1" KeyboardNavigation.TabNavigation="Local" KeyboardNavigation.DirectionalNavigation="Contained" KeyboardNavigation.TabIndex="2"-->
                        <Border Background="{TemplateBinding Background}"  BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Grid.Row="1" Grid.RowSpan="1" KeyboardNavigation.TabNavigation="Local" KeyboardNavigation.DirectionalNavigation="Contained" KeyboardNavigation.TabIndex="2" HorizontalAlignment="Stretch">
                            <!--Background="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.Content.Background}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.Content.BorderBrush}" BorderThickness="{DynamicResource Fluent.Ribbon.Values.RibbonTabControl.Content.BorderThickness}" TextElement.Foreground="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.Content.Foreground}"-->
                            <ContentControl x:Name="mainContentControl" Margin="0" Focusable="False" HorizontalAlignment="Stretch">
                                <ContentPresenter x:Name="PART_SelectedContentPresenter" ContentSource="SelectedContent" HorizontalAlignment="Stretch" Margin="0"/>
                            </ContentControl>
                        </Border>
                        <!--Border Margin="0" VerticalAlignment="Stretch" Grid.Row="2" Background="{Binding Path=SelectedItem.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}" /-->
                        <Grid x:Name="TabsGrid" Background="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.TabsGrid.Background}" TextElement.Foreground="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.TabsGrid.Foreground}" HorizontalAlignment="Stretch" Width="Auto" Margin="0" Grid.Row="0" KeyboardNavigation.TabIndex="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Fluent:WindowSteeringHelperControl Grid.ColumnSpan="4" />
                            <!-- Margin on bottom is need to keep the border surrounding the content area visible below the menu presenter -->
                            <ContentPresenter Grid.Column="0" VerticalAlignment="Stretch" ContentSource="Menu" Margin="0,0,0,1" />
                            <Fluent:RibbonScrollViewer Grid.Column="1" Visibility="{Binding AreTabHeadersVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}" HorizontalAlignment="Left" Margin="0" Width="Auto" Style="{DynamicResource RibbonTabScrollViewer}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsHitTestVisible="True" IsTabStop="False">
                                <Grid HorizontalAlignment="Stretch">
                                    <ui:TravellingSelector TargetPanel="{Binding ElementName=PART_TabsContainer}" SelectedObjectIndex="{TemplateBinding SelectedIndex}"  AnimationDuration="0:0:0.250" Width="{Binding ActualWidth, ElementName=PART_TabsContainer}" Height="{Binding ActualHeight, ElementName=PART_TabsContainer}" IsHitTestVisible="False">
                                        <!--Collection="{Binding ItemsSource, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=OneWay}" SelectedObject="{Binding SelectedItem, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=OneWay}"-->
                                        <ui:TravellingSelector.AnimationEase>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </ui:TravellingSelector.AnimationEase>
                                        <ui:TravellingSelector.Template>
                                            <ControlTemplate TargetType="{x:Type ui:TravellingSelector}">
                                                <Grid Background="#01000000">
                                                    <Border x:Name="PART_Selector" HorizontalAlignment="Left" VerticalAlignment="Top" Width="{TemplateBinding SelectionWidth}" Height="{TemplateBinding SelectionHeight}">
                                                        <!--Background="#01000000"-->
                                                        <Border Margin="-2,0,-2,1" ClipToBounds="True">
                                                            <!--RenderTransform="{Binding SelectorTransform, RelativeSource={RelativeSource Mode=TemplatedParent}}"-->
                                                            <Border x:Name="SelectedBorder" Margin="4,0" BorderBrush="{DynamicResource SelectedHighlightBrush}" BorderThickness="0,0,0,2" RenderTransformOrigin="0.5,1">
                                                                <Border.RenderTransform>
                                                                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                                                                </Border.RenderTransform>
                                                                <Rectangle Fill="{Binding BorderBrush, ElementName=SelectedBorder}" Opacity="1" Height="2" VerticalAlignment="Bottom" Margin="0,-2">
                                                                    <Rectangle.Effect>
                                                                        <BlurEffect Radius="5"/>
                                                                    </Rectangle.Effect>
                                                                </Rectangle>
                                                            </Border>
                                                        </Border>
                                                    </Border>
                                                </Grid>
                                                <!--ControlTemplate.Triggers>
                                            <Trigger Property="SelectionExists" Value="True">
                                                <Trigger.EnterActions>
                                                    <BeginStoryboard>
                                                        <Storyboard>
                                                            <DoubleAnimation Storyboard.TargetName="SelectedBorder" Storyboard.TargetProperty="RenderTransform.ScaleX" To="1" Duration="0:0:0.125">
                                                                <DoubleAnimation.EasingFunction>
                                                                    <CubicEase EasingMode="EaseOut"/>
                                                                </DoubleAnimation.EasingFunction>
                                                            </DoubleAnimation>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </Trigger.EnterActions>
                                                <Trigger.ExitActions>
                                                    <BeginStoryboard>
                                                        <Storyboard>
                                                            <DoubleAnimation Storyboard.TargetName="SelectedBorder" Storyboard.TargetProperty="RenderTransform.ScaleX" To="0" Duration="0:0:0.125">
                                                                <DoubleAnimation.EasingFunction>
                                                                    <CubicEase EasingMode="EaseOut"/>
                                                                </DoubleAnimation.EasingFunction>
                                                            </DoubleAnimation>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </Trigger.ExitActions>
                                            </Trigger>
                                        </ControlTemplate.Triggers-->
                                            </ControlTemplate>
                                        </ui:TravellingSelector.Template>
                                    </ui:TravellingSelector>
                                    <Fluent:RibbonTabsContainer x:Name="PART_TabsContainer" IsItemsHost="True" Height="Auto" HorizontalAlignment="Stretch" Margin="0" KeyboardNavigation.TabIndex="1" />
                                </Grid>
                            </Fluent:RibbonScrollViewer>
                            <StackPanel HorizontalAlignment="Right" Grid.Column="3" Orientation="Horizontal" Margin="0,0,0,1">
                                <Fluent:ToggleButton x:Name="PART_MinimizeButton" Width="30" Height="30" IsChecked="{Binding Path=IsMinimized, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding CanMinimize, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Fluent:ToggleButton.Style>
                                        <Style TargetType="{x:Type Fluent:ToggleButton}">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TitlebarIdleForegroundBrush}" />
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type Fluent:ToggleButton}">
                                                        <Grid Background="{TemplateBinding Background}">
                                                            <ContentPresenter x:Name="ContentPresenter" Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Margin="0,0,1,0" Effect="{DynamicResource DropShadow}" RenderTransformOrigin="0.5,0.5">
                                                                <ContentPresenter.RenderTransform>
                                                                    <RotateTransform Angle="0"/>
                                                                </ContentPresenter.RenderTransform>
                                                            </ContentPresenter>
                                                        </Grid>
                                                        <ControlTemplate.Triggers>
                                                            <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}" Value="False">
                                                                <Setter Property="Foreground" Value="{DynamicResource TitlebarInactiveIdleForegroundBrush}" />
                                                            </DataTrigger>
                                                            <Trigger Property="IsEnabled" Value="False">
                                                                <!--Setter Property="Foreground" Value="{DynamicResource TitlebarDisabledForegroundBrush}" /-->
                                                                <Setter Property="Opacity" Value="0.5"/>
                                                            </Trigger>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Foreground" Value="{DynamicResource TitlebarHoverForegroundBrush}" />
                                                            </Trigger>
                                                            <Trigger Property="IsPressed" Value="True">
                                                                <Setter Property="Foreground" Value="{DynamicResource TitlebarPressedForegroundBrush}" />
                                                            </Trigger>
                                                            <Trigger Property="IsChecked" Value="True">
                                                                <Trigger.EnterActions>
                                                                    <BeginStoryboard>
                                                                        <Storyboard>
                                                                            <DoubleAnimation Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="RenderTransform.Angle" To="-180" Duration="0:0:0.125"/>
                                                                        </Storyboard>
                                                                    </BeginStoryboard>
                                                                </Trigger.EnterActions>
                                                                <Trigger.ExitActions>
                                                                    <BeginStoryboard>
                                                                        <Storyboard>
                                                                            <DoubleAnimation Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="RenderTransform.Angle" To="0" Duration="0:0:0.125"/>
                                                                        </Storyboard>
                                                                    </BeginStoryboard>
                                                                </Trigger.ExitActions>
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <Path HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 6 L 6 0 L 12 6" Stroke="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type ToggleButton}}}" StrokeThickness="2"/>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </Fluent:ToggleButton.Style>
                                </Fluent:ToggleButton>
                                <StackPanel x:Name="PART_ToolbarPanel" Visibility="{Binding IsToolBarVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}" Orientation="Horizontal" />
                            </StackPanel>
                        </Grid>
                        <Popup x:Name="PART_Popup" PlacementTarget="{Binding Path=SelectedTabItem, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" Placement="Custom" AllowsTransparency="True" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" IsOpen="{TemplateBinding IsDropDownOpen}" HorizontalOffset="0" VerticalOffset="-10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition MinHeight="20" MaxHeight="20" />
                                    <!-- Needed for overlapping Keytips -->
                                    <RowDefinition MinHeight="{TemplateBinding ContentHeight}" MaxHeight="{TemplateBinding ContentHeight}" />
                                    <RowDefinition MinHeight="{TemplateBinding ContentGapHeight}" MaxHeight="{TemplateBinding ContentGapHeight}" />
                                    <RowDefinition Height="20" />
                                    <!-- Needed for overlapping Keytips -->
                                </Grid.RowDefinitions>
                                <Border Grid.Row="1" Grid.RowSpan="2" BorderThickness="0,0,0,1" Margin="1,0" BorderBrush="{Binding Path=SelectedItem.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}" Background="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.Content.Background}" TextElement.Foreground="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.Content.Foreground}" KeyboardNavigation.TabNavigation="Local" KeyboardNavigation.DirectionalNavigation="Contained">
                                    <ContentControl x:Name="popupContentControl" Focusable="False" Margin="0" />
                                </Border>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMinimized" Value="False">
                            <Setter TargetName="PART_MinimizeButton" Property="Icon" Value="{DynamicResource Fluent.Ribbon.Images.RibbonCollapse}" />
                            <Setter TargetName="PART_MinimizeButton" Property="ToolTip">
                                <Setter.Value>
                                    <Fluent:ScreenTip Title="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.MinimizeButtonScreenTipTitle, Mode=OneWay}" Text="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.MinimizeButtonScreenTipText, Mode=OneWay}" />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <Trigger Property="IsMinimized" Value="True">
                            <Setter Property="MinHeight" TargetName="rowDefinition" Value="0" />
                            <Setter Property="MinHeight" TargetName="rowDefinition1" Value="0" />
                            <!-- Switch content to popup -->
                            <Setter Property="Content" TargetName="mainContentControl" Value="{x:Null}" />
                            <Setter Property="Content" TargetName="popupContentControl" Value="{Binding ElementName=PART_SelectedContentPresenter, Mode=OneWay}" />
                            <!-- Switch content to popup END -->
                            <Setter TargetName="PART_MinimizeButton" Property="Icon" Value="{DynamicResource Fluent.Ribbon.Images.RibbonExpand}" />
                            <Setter TargetName="PART_MinimizeButton" Property="ToolTip">
                                <Setter.Value>
                                    <Fluent:ScreenTip Title="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.ExpandButtonScreenTipTitle, Mode=OneWay}" Text="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.ExpandButtonScreenTipText, Mode=OneWay}" />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsDropDownOpen" Value="True" />
                                <Condition Property="IsMinimized" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_MinimizeButton" Property="Icon" Value="{DynamicResource Fluent.Ribbon.Images.RibbonPin}" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:RibbonTabItem}" TargetType="{x:Type Fluent:RibbonTabItem}">
        <Setter Property="FocusVisualStyle" Value="{DynamicResource ControlStyleEmptyFocus}" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="MinHeight" Value="30" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="IsMinimized" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:RibbonTabControl}}, Path=IsMinimized, Mode=OneWay, FallbackValue=False}" />
        <Setter Property="IsOpen" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:RibbonTabControl}}, Path=IsDropDownOpen, Mode=OneWay, FallbackValue=True}" />
        <Setter Property="Indent" Value="12" />
        <Setter Property="Foreground" Value="{DynamicResource TitlebarIdleForegroundBrush}" />
        <Setter Property="ActiveTabBackground" Value="Transparent" />
        <Setter Property="ActiveTabBorderBrush" Value="Transparent" />
        <Setter Property="Fluent:RibbonProperties.MouseOverBackground" Value="Transparent"/>
        <Setter Property="Fluent:RibbonProperties.MouseOverForeground" Value="White"/>
        <Setter Property="HeaderTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" Text="{Binding}" TextWrapping="NoWrap" TextTrimming="None" />
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:RibbonTabItem}">
                    <Grid x:Name="grid" Height="Auto">
                        <Grid Visibility="Collapsed">
                            <Border x:Name="mouseOverBorder" Margin="1,0,1,0" Background="{TemplateBinding Background}" />
                            <Border x:Name="groupBorder" Margin="0,0,0,1" BorderThickness="0" Background="{Binding Group.Background, RelativeSource={RelativeSource TemplatedParent}, FallbackValue=Transparent}" OpacityMask="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.Contextual.Background.OpacityMask}" />
                            <Border x:Name="selectedBorder" Visibility="Collapsed" Margin="1,0,1,0" VerticalAlignment="Stretch" BorderBrush="{TemplateBinding ActiveTabBorderBrush}" BorderThickness="1,1,1,0" Background="{TemplateBinding ActiveTabBackground}" />
                        </Grid>
                        <Grid ClipToBounds="True" Margin="-2,0,-2,1">
                            <Border x:Name="HoverBorder" Margin="4,0" BorderThickness="0,0,0,2" BorderBrush="{DynamicResource HoverHighlightBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" RenderTransformOrigin="0.5,1">
                                <Border.RenderTransform>
                                    <ScaleTransform ScaleX="0" ScaleY="1"/>
                                </Border.RenderTransform>
                                <Rectangle Fill="{Binding BorderBrush, ElementName=HoverBorder}" Opacity="1" Height="2" VerticalAlignment="Bottom" Margin="0,-2">
                                    <Rectangle.Effect>
                                        <BlurEffect Radius="5"/>
                                    </Rectangle.Effect>
                                </Rectangle>
                            </Border>
                        </Grid>
                        <Border x:Name="PART_ContentContainer" HorizontalAlignment="Stretch" Margin="6,2,4,0" VerticalAlignment="Stretch" Padding="15,0,0,0">
                            <ContentControl AutomationProperties.Name="{TemplateBinding Header}" AutomationProperties.AutomationId="{TemplateBinding Name}" Content="{TemplateBinding Header}" ContentTemplate="{TemplateBinding HeaderTemplate}" Margin="5,1,5,4" HorizontalAlignment="Center" VerticalAlignment="Center" Height="Auto" Effect="{DynamicResource DropShadow}"/>
                        </Border>
                        <Grid x:Name="separatorGrid" Margin="0" Visibility="Collapsed" HorizontalAlignment="Right" Width="1">
                            <!--Rectangle x:Name="separatorRectangle1" Fill="{TemplateBinding BorderBrush}" Stroke="{TemplateBinding BorderBrush}" Margin="0" Width="1"/-->
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding IsActive, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}" Value="False"/>
                                <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Mode=Self}}" Value="False"/>
                                <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Mode=Self}}" Value="False"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Foreground" Value="{DynamicResource TitlebarInactiveIdleForegroundBrush}" />
                        </MultiDataTrigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" TargetName="PART_ContentContainer" Value="0.5"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasRightGroupBorder" Value="False" />
                                <Condition Property="HasLeftGroupBorder" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Margin" TargetName="groupBorder" Value="2,0,0,0" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasLeftGroupBorder" Value="False" />
                                <Condition Property="HasRightGroupBorder" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Margin" TargetName="groupBorder" Value="0,0,2,0" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasLeftGroupBorder" Value="False" />
                                <Condition Property="HasRightGroupBorder" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Margin" TargetName="groupBorder" Value="0,0,0,0" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasLeftGroupBorder" Value="True" />
                                <Condition Property="HasRightGroupBorder" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Margin" TargetName="groupBorder" Value="2,0,2,0" />
                        </MultiTrigger>
                        <Trigger Property="IsSeparatorVisible" Value="True">
                            <Setter Property="Visibility" TargetName="separatorGrid" Value="Visible" />
                            <Setter Property="Margin" TargetName="PART_ContentContainer" Value="6,2,6,0" />
                        </Trigger>
                        <Trigger Property="Group" Value="{x:Null}">
                            <Setter Property="Visibility" TargetName="groupBorder" Value="Collapsed" />
                            <Setter Property="Margin" TargetName="separatorGrid" Value="-1,0,0,1" />
                        </Trigger>
                        <Trigger Property="Selector.IsSelected" Value="True">
                            <Setter Property="Visibility" TargetName="selectedBorder" Value="Visible" />
                        </Trigger>
                        <!-- Foreground for Selected, with group -->
                        <!--Trigger Property="Selector.IsSelected" Value="True">
                            <Setter Property="Foreground" Value="{Binding Group.TabItemSelectedForeground, RelativeSource={RelativeSource Self}}" />
                        </Trigger-->
                        <!-- Foreground for selected, no group -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Selector.IsSelected" Value="True" />
                                <Condition Property="Group" Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <!--Setter Property="Foreground" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.Selected.Foreground}" /-->
                            <Setter Property="Foreground" Value="{DynamicResource TitlebarHoverForegroundBrush}" />
                        </MultiTrigger>
                        <!-- Background and foreground for MouseOver, with group -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" Value="{Binding Path=(Fluent:RibbonProperties.MouseOverBackground), RelativeSource={RelativeSource Self}}" />
                            <!--Setter Property="Foreground" Value="{Binding Group.TabItemMouseOverForeground, RelativeSource={RelativeSource Self}}" /-->
                        </MultiTrigger>
                        <!-- Foreground for selected MouseOver, with group -->
                        <!--MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="Selector.IsSelected" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Foreground" Value="{Binding Group.TabItemSelectedMouseOverForeground, RelativeSource={RelativeSource Self}}" />
                        </MultiTrigger-->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="Selector.IsSelected" Value="False" />
                                <Condition Property="Group" Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBorder" Storyboard.TargetProperty="RenderTransform.ScaleX" To="1" Duration="0:0:0.125">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBorder" Storyboard.TargetProperty="RenderTransform.ScaleX" To="0" Duration="0:0:0.125">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                            <Setter Property="TextElement.Foreground" Value="{DynamicResource TitlebarHoverForegroundBrush}" />
                        </MultiTrigger>
                        <!-- Background for Selected, Minimized, IsOpen, with group -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Selector.IsSelected" Value="True" />
                                <Condition Property="IsMinimized" Value="True" />
                                <Condition Property="IsOpen" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" TargetName="grid" Value="Transparent" />
                        </MultiTrigger>
                        <!-- Background for Selected, Minimized, IsOpen, no group -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Selector.IsSelected" Value="True" />
                                <Condition Property="IsMinimized" Value="True" />
                                <Condition Property="IsOpen" Value="True" />
                                <Condition Property="Group" Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" TargetName="grid" Value="Transparent" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Group" Value="{x:Null}">
                <Setter Property="BorderBrush" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.BorderBrush}" />
            </Trigger>
            <!--Trigger Property="IsSelected" Value="True">
                <Setter Property="Fluent:RibbonProperties.MouseOverForeground" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.Selected.MouseOver.Foreground}" />
            </Trigger-->
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsContextual, RelativeSource={RelativeSource Self}}" Value="True" />
                    <Condition Binding="{Binding Group.Visibility, RelativeSource={RelativeSource Self}}" Value="Collapsed" />
                </MultiDataTrigger.Conditions>
                <Setter Property="Visibility" Value="Collapsed" />
            </MultiDataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:RibbonGroupBox}" TargetType="{x:Type Fluent:RibbonGroupBox}">
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Height" Value="Auto" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Foreground" Value="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:RibbonTabControl}}}"/> <!--, DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" /-->
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="Fluent:KeyTip.Margin" Value="0,15,0,0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:RibbonGroupBox}">
                    <ControlTemplate.Resources>
                        <ResourceDictionary>
                            <Style TargetType="Separator" BasedOn="{StaticResource {x:Type Separator}}" />
                            <!--Style x:Key="{x:Type ScrollBar}" TargetType="{x:Type ScrollBar}" BasedOn="{StaticResource {x:Type ScrollBar}}" /-->
                            <!--Style x:Key="{x:Type ScrollViewer}" TargetType="{x:Type ScrollViewer}" BasedOn="{StaticResource {x:Type ScrollViewer}}" /-->
                            <Style TargetType="ScrollBar" x:Key="{x:Type ScrollBar}">
                                <Setter Property="SnapsToDevicePixels" Value="True" />
                                <Setter Property="Foreground"  Value="{DynamicResource BlackBrush}" />
                                <Style.Triggers>
                                    <Trigger Property="Orientation" Value="Horizontal">
                                        <Setter Property="Width" Value="Auto" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type ScrollBar}">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition MaxWidth="18" />
                                                            <ColumnDefinition Width="0.00001*" />
                                                            <ColumnDefinition MaxWidth="18" />
                                                        </Grid.ColumnDefinitions>
                                                        <Border Grid.ColumnSpan="3" Margin="0" Background="{DynamicResource Fluent.Ribbon.Brushes.ScrollBar.Background}" />
                                                        <RepeatButton x:Name="repeatButton" Grid.Column="0" Style="{DynamicResource ScrollBarLineButton}" Width="17" Command="ScrollBar.LineLeftCommand" Content="M 4 0 L 4 8 L 0 4 Z" Margin="1,1,0,1" Background="{DynamicResource WhiteBrush}" />
                                                        <Track Name="PART_Track" Grid.Column="1" IsDirectionReversed="False" Margin="0,1,0,1" ViewportSize="{TemplateBinding ViewportSize}">
                                                            <Track.Resources>
                                                                <!-- Set the Thumb's minimum height to 50.
                      The Thumb's minimum height is half the
                      value of VerticalScrollBarButtonHeightKey. -->
                                                                <sys:Double x:Key="{x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}">36</sys:Double>
                                                            </Track.Resources>
                                                            <Track.DecreaseRepeatButton>
                                                                <RepeatButton Style="{DynamicResource ScrollBarPageButton}" Command="ScrollBar.PageLeftCommand" />
                                                            </Track.DecreaseRepeatButton>
                                                            <Track.Thumb>
                                                                <Thumb Style="{DynamicResource ScrollBarThumb}" Margin="0,0,0,0" />
                                                            </Track.Thumb>
                                                            <Track.IncreaseRepeatButton>
                                                                <RepeatButton Style="{DynamicResource ScrollBarPageButton}" Command="ScrollBar.PageRightCommand" />
                                                            </Track.IncreaseRepeatButton>
                                                        </Track>
                                                        <RepeatButton x:Name="repeatButton1" Grid.Column="3" Style="{DynamicResource ScrollBarLineButton}" Width="17" Command="ScrollBar.LineRightCommand" Content="M 0 0 L 4 4 L 0 8 Z" Margin="0,1,1,1" Background="{DynamicResource WhiteBrush}" />
                                                    </Grid>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" TargetName="repeatButton" Value="{x:Null}" />
                                                            <Setter Property="Background" TargetName="repeatButton1" Value="{x:Null}" />
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Height" Value="17" />
                                    </Trigger>
                                    <Trigger Property="Orientation" Value="Vertical">
                                        <Setter Property="Height" Value="Auto" />
                                        <Setter Property="Template" Value="{DynamicResource VerticalScrollBar}" />
                                        <Setter Property="Width" Value="17" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                            <Style x:Key="{x:Type ScrollViewer}" TargetType="{x:Type ScrollViewer}">
                                <Style.Triggers>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    </Trigger>
                                </Style.Triggers>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type ScrollViewer}">
                                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                                <Grid x:Name="Grid" Background="{TemplateBinding Background}">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="*" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Rectangle x:Name="Corner" Grid.Column="1" Fill="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" Grid.Row="1" />
                                                    <ScrollContentPresenter x:Name="PART_ScrollContentPresenter" CanContentScroll="{TemplateBinding CanContentScroll}" CanHorizontallyScroll="False" CanVerticallyScroll="False" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Grid.Column="0" Margin="{TemplateBinding Padding}" Grid.Row="0" />
                                                    <ScrollBar x:Name="PART_VerticalScrollBar" AutomationProperties.AutomationId="VerticalScrollBar" Cursor="Arrow" Grid.Column="1" Maximum="{TemplateBinding ScrollableHeight}" Minimum="0" Grid.Row="0" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportHeight}" />
                                                    <ScrollBar x:Name="PART_HorizontalScrollBar" AutomationProperties.AutomationId="HorizontalScrollBar" Cursor="Arrow" Grid.Column="0" Maximum="{TemplateBinding ScrollableWidth}" Minimum="0" Orientation="Horizontal" Grid.Row="1" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportWidth}" />
                                                </Grid>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ResourceDictionary>
                    </ControlTemplate.Resources>
                    <!--ControlTemplate.Resources>
                        <ResourceDictionary>
                            <Style TargetType="Separator" BasedOn="{StaticResource GroupBoxSeparator}" />
                            <Style x:Key="{x:Type ScrollBar}" TargetType="{x:Type ScrollBar}" BasedOn="{StaticResource ScrollBarWhite}" />
                            <Style x:Key="{x:Type ScrollViewer}" TargetType="{x:Type ScrollViewer}" BasedOn="{StaticResource ScrollViewerStyle}" />
                        </ResourceDictionary>
                    </ControlTemplate.Resources-->
                    <Grid x:Name="grid2" HorizontalAlignment="Stretch">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" />
                        <Grid>
                            <ContentControl x:Name="border1" Focusable="False">
                                <Grid x:Name="PART_ParentPanel" Margin="0,1,0,2" Height="Auto">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Fluent:RibbonGroupBoxWrapPanel x:Name="PART_UpPanel" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="Stretch" Width="Auto" Height="Auto" IsItemsHost="True" Margin="4,0,4,0" />
                                    <Grid x:Name="PART_DownGrid" MaxWidth="{Binding ActualWidth, ElementName=PART_ParentPanel}" Margin="0,-2,2,2" Grid.Row="1" VerticalAlignment="Bottom" Height="Auto">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <ContentControl Content="{TemplateBinding Header}" ContentStringFormat="{TemplateBinding HeaderStringFormat}" ContentTemplate="{TemplateBinding HeaderTemplate}" Foreground="{TemplateBinding Foreground}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2,0" KeyboardNavigation.IsTabStop="False" />
                                        <!--ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" Foreground="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Header.Foreground}"-->
                                        <Fluent:Button Margin="0,0,1,1" x:Name="PART_DialogLauncherButton" HorizontalAlignment="Stretch" Width="15" Height="14" Grid.Column="1" Focusable="False" IsTabStop="False" Template="{DynamicResource DialogLauncherButtonControlTemplate}" Background="Transparent" BorderBrush="Transparent" VerticalAlignment="Bottom" Icon="{TemplateBinding LauncherIcon}" Header="{TemplateBinding LauncherText}" Command="{Binding LauncherCommand, RelativeSource={RelativeSource TemplatedParent}}" CommandTarget="{Binding LauncherCommandTarget, RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="{Binding LauncherCommandParameter, RelativeSource={RelativeSource TemplatedParent}}" ToolTip="{Binding LauncherToolTip, RelativeSource={RelativeSource TemplatedParent}}" IsEnabled="{Binding IsLauncherEnabled, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </Grid>
                                </Grid>
                            </ContentControl>
                            <Grid x:Name="grid1" Margin="0" Width="Auto" Height="Auto" Visibility="Collapsed" Grid.RowSpan="2">
                                <ContentControl Content="{TemplateBinding Header}" ContentStringFormat="{TemplateBinding HeaderStringFormat}" ContentTemplate="{TemplateBinding HeaderTemplate}" ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" Foreground="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Header.Foreground}" Style="{DynamicResource Fluent.Ribbon.Styles.RibbonGroupBox.TwoLineHeaderContentControl}" Fluent:RibbonGroupBox.IsCollapsedHeaderContentPresenter="True" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="5,38,5,0" KeyboardNavigation.IsTabStop="False" />
                                <Border HorizontalAlignment="Center" VerticalAlignment="Top" Width="31" Height="31" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Collapsed.BorderBrush}" BorderThickness="1" Margin="5,3,8,0">
                                    <ContentPresenter x:Name="iconImage" Height="16" Content="{converters:ObjectToImageConverter {Binding Icon, RelativeSource={RelativeSource TemplatedParent}}, '16,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}" Width="16" SnapsToDevicePixels="True" />
                                </Border>
                                <Popup x:Name="PART_Popup" Width="Auto" Height="Auto" AllowsTransparency="True" PlacementTarget="{Binding ElementName=grid1, Mode=OneWay}" IsOpen="{TemplateBinding IsDropDownOpen}">
                                    <Grid Width="Auto" Height="Auto" Margin="0,20">
                                        <Border x:Name="border" Height="Auto" Background="{DynamicResource Fluent.Ribbon.Brushes.Ribbon.Background}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.BorderBrush}" BorderThickness="1">
                                            <!--d:LayoutOverrides="Width"-->
                                            <ContentControl x:Name="popupContent" />
                                        </Border>
                                    </Grid>
                                </Popup>
                            </Grid>
                            <Rectangle x:Name="separator" Fill="{DynamicResource HorizontalPanelBorderBrush}" HorizontalAlignment="Right" VerticalAlignment="Stretch" Width="1" Height="Auto" Grid.RowSpan="2" Margin="0,4" Visibility="{Binding IsSeparatorVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}" />
                            <!--Fill="{DynamicResource Fluent.Ribbon.Brushes.GroupSeparator.Background}"-->
                        </Grid>
                        <Image x:Name="PART_SnappedImage" Stretch="Uniform" Visibility="Collapsed" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="State" Value="Collapsed">
                            <Setter Property="Visibility" TargetName="grid1" Value="Visible" />
                            <Setter Property="UIElement.Visibility" TargetName="border1" Value="Collapsed" />
                            <Setter Property="HorizontalAlignment" TargetName="grid2" Value="Left" />
                            <Setter Property="Content" TargetName="border1" Value="{x:Null}" />
                            <Setter Property="Content" TargetName="popupContent" Value="{Binding ElementName=PART_ParentPanel}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="State" Value="Collapsed" />
                                <Condition Property="IsMouseOver" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Collapsed.MouseOver.Background}" />
                        </MultiTrigger>
                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Setter Property="Background" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.DropDownOpen.Background}" />
                        </Trigger>
                        <Trigger Property="IsLauncherVisible" Value="False">
                            <Setter Property="Visibility" TargetName="PART_DialogLauncherButton" Value="Collapsed" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <!--Setter Property="HeaderTemplateSelector" Value="{Binding Source={x:Static templateSelectors:RibbonGroupBoxHeaderTemplateSelector.Instance}}" /-->
        <Style.Triggers>
            <Trigger Property="State" Value="QuickAccess">
                <Setter Property="Template" Value="{DynamicResource RibbonGroupBoxDropDownButtonControlTemplate}" />
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="22" />
                <Setter Property="Focusable" Value="False" />
                <Setter Property="SnapsToDevicePixels" Value="False" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:TwoLineLabel}" TargetType="{x:Type Fluent:TwoLineLabel}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:TwoLineLabel}">
                    <StackPanel x:Name="stackPanel" Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Center">
                        <AccessText TextWrapping="Wrap" x:Name="PART_TextRun" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <StackPanel x:Name="stackPanel1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <AccessText TextWrapping="Wrap" x:Name="PART_TextRun2" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            <Border x:Name="border" Height="Auto" Width="5" HorizontalAlignment="Center" Margin="0">
                                <Path x:Name="path" Width="5" Height="3" StrokeThickness="0" Data="M0,0L5,0 2.5,3z" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,2,0,0" SnapsToDevicePixels="True" Fill="{TemplateBinding Foreground}" />
                            </Border>
                        </StackPanel>
                    </StackPanel>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasTwoLines" Value="False">
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="HorizontalAlignment" TargetName="stackPanel" Value="Left" />
                            <Setter Property="Margin" TargetName="border" Value="0" />
                            <Setter Property="VerticalAlignment" TargetName="stackPanel" Value="Center" />
                            <Setter Property="VerticalAlignment" TargetName="border" Value="Center" />
                            <Setter Property="Margin" TargetName="stackPanel1" Value="3,0,0,0" />
                            <Setter Property="VerticalAlignment" TargetName="stackPanel1" Value="Center" />
                        </Trigger>
                        <Trigger Property="HasGlyph" Value="False">
                            <Setter Property="Visibility" TargetName="path" Value="Collapsed" />
                            <Setter Property="Width" TargetName="border" Value="0.1" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:QuickAccessToolBar}" TargetType="{x:Type Fluent:QuickAccessToolBar}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Height" Value="24"/>
        <Setter Property="Margin" Value="21,0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:QuickAccessToolBar}">
                    <DockPanel x:Name="PART_RootPanel" KeyboardNavigation.TabNavigation="Local" Background="#01000000">
                        <ContentControl x:Name="menuContentControl" DockPanel.Dock="Right" HorizontalAlignment="Right" Focusable="False">
                            <Fluent:DropDownButton CanAddToQuickAccessToolBar="False" x:Name="PART_MenuDownButton" HorizontalAlignment="Right" VerticalAlignment="Stretch" DockPanel.Dock="Right" IsEnabled="{TemplateBinding IsEnabled}" Size="Small" ToolTip="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarDropDownButtonTooltip, Mode=OneWay}" KeyboardNavigation.TabIndex="3">
                                <!--Visibility="{Binding IsMenuDropDownVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}" -->
                                <!--Icon="{DynamicResource Fluent.Ribbon.Images.QuickAccessToolbarDropDown}"-->
                                <Fluent:DropDownButton.Style>
                                    <Style TargetType="{x:Type Fluent:DropDownButton}">
                                        <Setter Property="Foreground" Value="{DynamicResource TitlebarIdleForegroundBrush}" />
                                        <Setter Property="Padding" Value="0"/>
                                        <Setter Property="ItemsPanel">
                                            <Setter.Value>
                                                <ItemsPanelTemplate>
                                                    <StackPanel Orientation="Vertical" />
                                                </ItemsPanelTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type Fluent:DropDownButton}">
                                                    <Grid Background="#01000000">
                                                        <Grid x:Name="PART_ButtonBorder" Background="#01000000">
                                                            <ContentPresenter x:Name="iconImage" Width="16" Height="16" HorizontalAlignment="Center" VerticalAlignment="Center" Content="{converters:ObjectToImageConverter {Binding Icon, RelativeSource={RelativeSource TemplatedParent}}, '16,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}" Margin="{TemplateBinding Padding}" SnapsToDevicePixels="True" TextElement.Foreground="{TemplateBinding Foreground}"/>
                                                        </Grid>
                                                        <Popup x:Name="PART_Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                                                            <Grid Name="DropDown" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Top">
                                                                <Border x:Name="PART_DropDownBorder" MinWidth="{TemplateBinding ActualWidth}" SnapsToDevicePixels="True" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                                    <Border CornerRadius="3" Margin="4,3,4,5" Effect="{DynamicResource DropShadow}">
                                                                        <Border.Background>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                                                                        </Border.Background>
                                                                        <!--Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BorderBrush}" BorderThickness="1"-->
                                                                        <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                                            <!--Border VerticalAlignment="Top" Width="Auto" Height="Auto" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderThickness="1" /-->
                                                                            <Grid Margin="3,1,3,0" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                                                <Grid.RowDefinitions>
                                                                                    <RowDefinition Height="*" />
                                                                                    <RowDefinition Height="Auto" />
                                                                                </Grid.RowDefinitions>
                                                                                <ScrollViewer x:Name="PART_ScrollViewer" Style="{DynamicResource MenuScrollViewer}" IsTabStop="False" MaxHeight="{TemplateBinding MaxDropDownHeight}" SnapsToDevicePixels="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                                                                                    <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Local" Margin="0,0,0,1" />
                                                                                </ScrollViewer>
                                                                                <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BorderBrush}" BorderThickness="0,1,0,0" Grid.Row="1" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BackgroundBrush}">
                                                                                    <Grid>
                                                                                        <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                                                                        <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                                                                    </Grid>
                                                                                </Border>
                                                                            </Grid>
                                                                        </Grid>
                                                                    </Border>
                                                                </Border>
                                                            </Grid>
                                                        </Popup>
                                                    </Grid>
                                                    <!--ControlTemplate.Triggers>
                                                        <Trigger Property="IsEnabled" Value="False">
                                                            <Setter Property="Opacity" TargetName="iconImage" Value="0.5" />
                                                            <Setter Property="Effect" TargetName="iconImage">
                                                                <Setter.Value>
                                                                    <Fluent:GrayscaleEffect />
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers-->
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="ResizeMode" Value="None">
                                                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Collapsed" />
                                                        </Trigger>
                                                        <Trigger Property="ResizeMode" Value="Both">
                                                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Collapsed" />
                                                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Visible" />
                                                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                                                        </Trigger>
                                                        <Trigger Property="ResizeMode" Value="Vertical">
                                                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Collapsed" />
                                                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Visible" />
                                                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Opacity" Value="0.5"/>
                                            </Trigger>
                                            <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}" Value="False">
                                                <Setter Property="Foreground" Value="{DynamicResource TitlebarInactiveIdleForegroundBrush}" />
                                            </DataTrigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Foreground" Value="{DynamicResource TitlebarHoverForegroundBrush}" />
                                            </Trigger>
                                            <Trigger Property="IsDropDownOpen" Value="True">
                                                <Setter Property="Foreground" Value="{DynamicResource TitlebarPressedForegroundBrush}" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Fluent:DropDownButton.Style>
                                <Fluent:DropDownButton.Icon>
                                    <StackPanel Width="5" Orientation="Vertical" UseLayoutRounding="True" Effect="{DynamicResource DropShadow}" VerticalAlignment="Center">
                                        <Rectangle Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:DropDownButton}}}" Height="1" HorizontalAlignment="Stretch" Margin="0,0,0,3"/>
                                        <Path Width="5" Height="3" Data="M0,0L5,0 2.5,3z" Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:DropDownButton}}}" HorizontalAlignment="Stretch"/>
                                    </StackPanel>
                                </Fluent:DropDownButton.Icon>
                            <!--Style="{DynamicResource ToolbarDropDownButtonStyle}"-->
                                <Fluent:GroupSeparatorMenuItem Style="{DynamicResource MenuGroupSeparatorStyle}" Header="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarMenuHeader, Mode=OneWay}" />
                                <StackPanel x:Name="PART_MenuPanel" />
                                <Rectangle Width="1" VerticalAlignment="Stretch" Margin="2" Fill="{DynamicResource TitlebarBorderBrush}"/>
                                <!--Separator x:Name="menuSeparator"/-->
                                <Rectangle x:Name="menuSeparator" Width="1" Fill="{DynamicResource TitlebarBorderBrush}" VerticalAlignment="Stretch" Margin="2"/>
                                <Fluent:MenuItem x:Name="PART_ShowBelow" CanAddToQuickAccessToolBar="False" Header="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarMenuShowBelow, Mode=OneWay}" />
                                <Fluent:MenuItem x:Name="PART_ShowAbove" CanAddToQuickAccessToolBar="False" Header="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarMenuShowAbove, Mode=OneWay}" Visibility="Collapsed" />
                            </Fluent:DropDownButton>
                        </ContentControl>
                        <Fluent:DropDownButton x:Name="PART_ToolbarDownButton" HorizontalAlignment="Right" Visibility="Collapsed" VerticalAlignment="Stretch" Style="{DynamicResource ToolbarDropDownButtonStyle}" DockPanel.Dock="Right" Fluent:KeyTip.Keys="00" Size="Small" IsEnabled="{TemplateBinding IsEnabled}" Icon="{DynamicResource Fluent.Ribbon.Images.QuickAccessToolbarExtender}" ToolTip="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarMoreControlsButtonTooltip, Mode=OneWay}" KeyboardNavigation.TabIndex="2" KeyboardNavigation.TabNavigation="Local">
                            <Fluent:DropDownButton.ContextMenu>
                                <ContextMenu />
                            </Fluent:DropDownButton.ContextMenu>
                            <StackPanel Orientation="Horizontal" Background="{TemplateBinding Background}" Width="Auto" Height="26" Margin="-1">
                                <StackPanel Orientation="Horizontal" x:Name="PART_ToolBarOverflowPanel" HorizontalAlignment="Left" Width="Auto" Height="Auto" VerticalAlignment="Center" Margin="1,0,0,0" />
                                <ContentControl x:Name="popupContentControl" VerticalAlignment="Center" HorizontalAlignment="Left" Background="{x:Null}" Focusable="False" Padding="0" Margin="1,0" />
                            </StackPanel>
                        </Fluent:DropDownButton>
                        <StackPanel x:Name="PART_ToolBarPanel" Orientation="Horizontal" Width="Auto" Height="Auto" VerticalAlignment="Stretch" KeyboardNavigation.TabNavigation="Local" KeyboardNavigation.TabIndex="1" />
                    </DockPanel>
                    <ControlTemplate.Triggers>
                        <Trigger Property="CanQuickAccessLocationChanging" Value="False">
                            <Setter Property="Visibility" TargetName="PART_ShowBelow" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ShowAbove" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="menuSeparator" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ShowAboveRibbon" Value="False">
                            <Setter Property="Visibility" TargetName="PART_ShowBelow" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ShowAbove" Value="Visible" />
                        </Trigger>
                        <Trigger Property="HasOverflowItems" Value="True">
                            <Setter Property="Visibility" TargetName="PART_ToolbarDownButton" Value="Visible" />
                            <Setter Property="Content" TargetName="popupContentControl" Value="{Binding ElementName=PART_MenuDownButton, Mode=OneWay}" />
                            <Setter Property="Content" TargetName="menuContentControl" Value="{x:Null}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:RibbonTitleBar}" TargetType="{x:Type Fluent:RibbonTitleBar}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="Height" Value="24"/>
        <Setter Property="HeaderTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center" Text="{Binding}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" />
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:RibbonTitleBar}">
                    <Grid>
                        <ContentPresenter x:Name="PART_QuickAccessToolbarHolder" ContentSource="QuickAccessToolBar" />
                        <ContentPresenter x:Name="PART_HeaderHolder" ContentSource="Header" ContentStringFormat="{TemplateBinding HeaderStringFormat}" ContentTemplate="{TemplateBinding HeaderTemplate}" ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" IsHitTestVisible="False" />
                        <Fluent:RibbonContextualGroupsContainer x:Name="PART_ItemsContainer" IsItemsHost="True" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsCollapsed" Value="True">
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_QuickAccessToolbarHolder" />
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_ItemsContainer" />
                        </Trigger>
                        <Trigger Property="HideContextTabs" Value="True">
                            <Setter Property="Visibility" Value="Hidden" TargetName="PART_ItemsContainer" />
                            <Setter Property="Visibility" Value="Hidden" TargetName="PART_QuickAccessToolbarHolder" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:KeyTip}" TargetType="{x:Type Fluent:KeyTip}">
        <Setter Property="Foreground" Value="{DynamicResource ButtonForegroundBrush}" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="3"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:KeyTip}">
                    <!--Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"-->
                        <Border UseLayoutRounding="True" Effect="{DynamicResource DropShadow}" CornerRadius="3" Margin="4,3,4,5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                            </Border.Background>
                            <Grid Margin="{TemplateBinding Padding}">
                                <TextBlock Foreground="{TemplateBinding Foreground}" Text="{TemplateBinding Content}" TextWrapping="Wrap" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="4,-1,4,1" />
                            </Grid>
                        </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:ScreenTip}" TargetType="{x:Type Fluent:ScreenTip}">
        <Setter Property="Foreground" Value="{DynamicResource ButtonForegroundBrush}" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="3"/>
        <Setter Property="Width" Value="205" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:ScreenTip}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="5" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="5" />
                        </Grid.RowDefinitions>
                        <Border Grid.RowSpan="1"
                    BorderThickness="1"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    Background="{TemplateBinding Background}">
                            <Grid>
                                <StackPanel x:Name="screenTipPanel">
                                    <TextBlock x:Name="title"
                                   TextWrapping="Wrap"
                                   Margin="7,8,7,10"
                                   FontWeight="Bold"
                                   Text="{TemplateBinding Property=Title}" />
                                    <Grid x:Name="imageAndTextSection">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Image x:Name="image" 
                                   Margin="7,5,3,7"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Top"
                                   Stretch="Uniform"
                                   Source="{TemplateBinding Property=Image}"
                                   MaxHeight="48" />
                                        <TextBlock Text="{TemplateBinding Property=Text}"
                                       TextWrapping="Wrap"
                                       Margin="8,0,8,6"
                                       Grid.Column="1" />
                                    </Grid>
                                    <Border x:Name="separator"
                                Height="2"
                                Width="Auto"
                                HorizontalAlignment="Stretch"
                                Visibility="{Binding ElementName=disableReasonSection, Path=Visibility}"
                                Margin="5"
                                Background="{DynamicResource GrayBrush6}"
                                BorderThickness="0,0,0,1"
                                IsEnabled="{Binding Path=IsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Control, AncestorLevel=2}}" />
                                    <Grid x:Name="disableReasonSection">
                                        <Image Width="16"
                                   Height="16"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Top"
                                   Margin="5,0,0,0"
                                   Stretch="Uniform"
                                   Source="{DynamicResource Fluent.Ribbon.Images.Warning}" />
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <TextBlock x:Name="disableReasonHeader"
                                           x:Uid="disableReasonHeader"
                                           Text="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.ScreenTipDisableReasonHeader, Mode=OneWay}"
                                           TextWrapping="Wrap"
                                           Margin="28,0,5,2"
                                           HorizontalAlignment="Stretch"
                                           Grid.Row="0"
                                           FontWeight="Bold" />
                                            <TextBlock x:Name="disableReasonText"
                                           Text="{TemplateBinding Property=DisableReason}"
                                           TextWrapping="Wrap"
                                           Margin="28,0,5,6"
                                           HorizontalAlignment="Stretch"
                                           Grid.Row="1" />
                                            <TextBlock x:Name="helpText"
                                           TextWrapping="Wrap"
                                           Margin="28,0,5,6"
                                           Grid.RowSpan="1"
                                           Grid.Row="2"
                                           HorizontalAlignment="Stretch"
                                           Text="{Binding Text, ElementName=textBlock, Mode=Default}" />
                                        </Grid>
                                    </Grid>
                                    <Border x:Name="separator2"
                                Height="2"
                                Width="Auto"
                                HorizontalAlignment="Stretch"
                                Visibility="{TemplateBinding Property=HelpLabelVisibility}"
                                Margin="5"
                                Background="{DynamicResource GrayBrush6}"
                                BorderThickness="0,0,0,1" />
                                    <Grid x:Name="helpSection"
                              Visibility="{TemplateBinding Property=HelpLabelVisibility}">
                                        <Image Width="16"
                                   Height="16"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Top"
                                   Margin="5,0,0,0"
                                   Stretch="Uniform"
                                   Source="{DynamicResource Fluent.Ribbon.Images.Help}" />
                                        <TextBlock x:Uid="HelpText"
                                       x:Name="textBlock"
                                       Text="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.ScreenTipF1LabelHeader, Mode=OneWay}"
                                       TextWrapping="Wrap"
                                       Margin="28,0,6,6"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Stretch" />
                                        <ContentControl x:Name="helpTopic"
                                            Content="{TemplateBinding Property=HelpTopic}"
                                            Visibility="Collapsed" />
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled"
                     SourceName="separator"
                     Value="False">
                            <Setter Property="Visibility"
                        TargetName="disableReasonSection"
                        Value="Visible" />
                        </Trigger>
                        <Trigger Property="IsEnabled"
                     SourceName="separator"
                     Value="True">
                            <Setter Property="Visibility"
                        TargetName="disableReasonSection"
                        Value="Collapsed" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Content"
                               SourceName="helpTopic"
                               Value="{x:Null}" />
                                <Condition Property="Text"
                               Value=""
                               SourceName="disableReasonText" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Visibility"
                        TargetName="separator"
                        Value="Collapsed" />
                        </MultiTrigger>
                        <Trigger Property="Text"
                     SourceName="disableReasonText"
                     Value="">
                            <Setter Property="Visibility"
                        TargetName="disableReasonSection"
                        Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="Content"
                     SourceName="helpTopic"
                     Value="{x:Null}">
                            <Setter Property="Visibility"
                        TargetName="helpText"
                        Value="Collapsed" />
                            <Setter Property="Visibility"
                        TargetName="helpSection"
                        Value="Collapsed" />
                            <Setter Property="Visibility"
                        TargetName="separator2"
                        Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="Visibility"
                     SourceName="disableReasonSection"
                     Value="Visible">
                            <Setter Property="Visibility"
                        TargetName="helpText"
                        Value="Collapsed" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Text"
                               Value="" />
                                <Condition Property="Image"
                               Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Visibility"
                        TargetName="imageAndTextSection"
                        Value="Collapsed" />
                        </MultiTrigger>
                        <Trigger Property="Image"
                     Value="{x:Null}">
                            <Setter Property="Visibility"
                        TargetName="image"
                        Value="Collapsed" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--#endregion Main Ribbon Styles-->
    
    
    <!--#region Ribbon Control Styles-->

    <Style x:Key="{x:Type Fluent:Button}" TargetType="{x:Type Fluent:Button}">
        <!--Setter Property="Height" Value="68" /-->
        <Setter Property="MinWidth" Value="50" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Foreground" Value="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:Ribbon}}}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="2,-3,2,-4"/>
        <Setter Property="Padding" Value="6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:Button}">
                    <Grid Background="{TemplateBinding Background}">
                        <!--Border x:Name="HoverBackground" Background="Transparent" BorderBrush="{DynamicResource ToolbarButtonHoverBorderBrush}" BorderThickness="1" CornerRadius="4" Opacity="0">
                            <Border BorderThickness="1" CornerRadius="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}">
                                <Border BorderThickness="0,1,0,2" CornerRadius="2" Background="{DynamicResource ToolbarButtonHoverTertiaryBackgroundBrush}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}"/>
                            </Border>
                        </Border-->
                        <Border x:Name="HoverBackground" Opacity="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-3" UseLayoutRounding="True">
                            <Border.Background>
                                <VisualBrush>
                                    <VisualBrush.Visual>
                                        <Grid Background="#01000000" Width="{Binding ActualWidth, ElementName=HoverBackground}" Height="{Binding ActualHeight, ElementName=HoverBackground}">
                                            <Border CornerRadius="3" Effect="{DynamicResource TertiaryDropShadow}" Margin="3" UseLayoutRounding="True">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource CardListViewSelectedBackgroundGradientStops}"/>
                                                </Border.Background>
                                            </Border>
                                        </Grid>
                                    </VisualBrush.Visual>
                                </VisualBrush>
                            </Border.Background>
                        </Border>
                        <StackPanel x:Name="ContentStackPanel" Margin="{TemplateBinding Padding}" Orientation="Vertical">
                            <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" VerticalAlignment="Center" Width="16" Height="16" SnapsToDevicePixels="True" Content="{TemplateBinding Icon}"/>
                            <!--Breaks Stuff if un-commented out -->
                            <!--{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='16,16'}-->
                            <Fluent:TwoLineLabel x:Name="ControlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Foreground="{TemplateBinding Foreground}"/>
                        </StackPanel>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Size" Value="Small">
                            <Setter TargetName="ControlLabel" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        <Trigger Property="Size" Value="Middle">
                            <Setter TargetName="ControlLabel" Property="HasTwoLines" Value="False"/>
                            <Setter TargetName="ContentStackPanel" Property="Orientation" Value="Horizontal"/>
                            <Setter TargetName="ControlLabel" Property="Margin" Value="2,0"/>
                        </Trigger>
                        <Trigger Property="Size" Value="Large">
                            <Setter TargetName="iconImage" Property="Width" Value="32"/>
                            <Setter TargetName="iconImage" Property="Height" Value="32"/>
                            <Setter TargetName="iconImage" Property="Content" Value="{Binding LargeIcon, RelativeSource={RelativeSource Mode=TemplatedParent}}"/>
                            <Setter TargetName="iconImage" Property="Margin" Value="0,0,0,5"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="Opacity" To="0.5" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <!--Setter Property="Foreground" Value="{DynamicResource ToolbarButtonDisabledForegroundBrush}" /-->
                        </Trigger>
                        <!--Trigger Property="Size" Value="Small">
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="Visibility" TargetName="controlLabel" Value="Collapsed" />
                            <Setter Property="HasTwoLines" TargetName="controlLabel" Value="False" />
                            <Setter Property="Width" TargetName="iconImage" Value="16" />
                            <Setter Property="Height" TargetName="iconImage" Value="16" />
                            <Setter Property="Margin" TargetName="iconImage" Value="2,0,2,0" />
                            <Setter Property="Content" TargetName="iconImage" Value="{TemplateBinding Icon, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='16,16'}" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="2,0,2,0" />
                        </Trigger-->
                        <!--Trigger Property="Size" Value="Middle">
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="Width" TargetName="stackPanel" Value="Auto" />
                            <Setter Property="VerticalAlignment" TargetName="iconImage" Value="Center" />
                            <Setter Property="HasTwoLines" TargetName="controlLabel" Value="False" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="2,0,2,0" />
                            <Setter Property="Width" TargetName="iconImage" Value="16" />
                            <Setter Property="Height" TargetName="iconImage" Value="16" />
                            <Setter Property="Margin" TargetName="iconImage" Value="2,0,2,0" />
                            <Setter Property="Content" TargetName="iconImage" Value="{TemplateBinding Icon, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='16,16'}" />
                            <Setter Property="VerticalAlignment" TargetName="controlLabel" Value="Center" />
                        </Trigger-->
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="76" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="30" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="30" />
                <Setter Property="Width" Value="22" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:DropDownButton}" TargetType="{x:Type Fluent:DropDownButton}">
        <!--Setter Property="Height" Value="68" /-->
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Foreground" Value="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="Margin" Value="2,-3,2,-4"/>
        <Setter Property="Padding" Value="6"/>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Vertical" />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:DropDownButton}">
                    <!--ControlTemplate.Resources>
                        <Style BasedOn="{StaticResource MenuSeparatorStyle}" TargetType="{x:Type Separator}" />
                    </ControlTemplate.Resources-->
                    <Grid>
                        <!--Border x:Name="PART_ButtonBorder" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}"                     HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}" Height="Auto"-->
                        <!--StackPanel x:Name="stackPanel" Margin="{TemplateBinding Padding}" Width="Auto" Orientation="Vertical">
                            <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" Height="32" VerticalAlignment="Center" Content="{converters:ObjectToImageConverter {Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}}, '32,32', {Binding RelativeSource={RelativeSource TemplatedParent}}}" Width="32" Margin="0,2,0,0" SnapsToDevicePixels="True" /> 
                            <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2 0 2 2" HasGlyph="{TemplateBinding HasTriangle}" />
                        </StackPanel-->
                        <Grid x:Name="PART_ButtonBorder">
                            <Border x:Name="HoverBackground" Opacity="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-3" UseLayoutRounding="True">
                                <Border.Background>
                                    <VisualBrush>
                                        <VisualBrush.Visual>
                                            <Grid Background="#01000000" Width="{Binding ActualWidth, ElementName=HoverBackground}" Height="{Binding ActualHeight, ElementName=HoverBackground}">
                                                <Border CornerRadius="3" Effect="{DynamicResource TertiaryDropShadow}" Margin="3" UseLayoutRounding="True">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource CardListViewSelectedBackgroundGradientStops}"/>
                                                    </Border.Background>
                                                </Border>
                                            </Grid>
                                        </VisualBrush.Visual>
                                    </VisualBrush>
                                </Border.Background>
                            </Border>
                            <StackPanel x:Name="stackPanel" Margin="{TemplateBinding Padding}" Width="Auto" Orientation="Vertical">
                                <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" Height="32" VerticalAlignment="Center" Content="{converters:ObjectToImageConverter {Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}}, '32,32', {Binding RelativeSource={RelativeSource TemplatedParent}}}" Width="32" Margin="0,2,0,0" SnapsToDevicePixels="True" />
                                <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2 0 2 2" HasGlyph="{TemplateBinding HasTriangle}" />
                            </StackPanel>
                        </Grid>
                        <Popup x:Name="PART_Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                            <Grid Name="DropDown" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Top">
                                <Border x:Name="PART_DropDownBorder" MinWidth="{TemplateBinding ActualWidth}" SnapsToDevicePixels="True" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                    <Border CornerRadius="3" Margin="4,3,4,5" Effect="{DynamicResource DropShadow}">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                                        </Border.Background>
                                        <!--Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BorderBrush}" BorderThickness="1"-->
                                        <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                            <Border VerticalAlignment="Top" Width="Auto" Height="Auto" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderThickness="1" />
                                            <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <ScrollViewer x:Name="PART_ScrollViewer" Style="{DynamicResource MenuScrollViewer}" IsTabStop="False" Margin="1" MaxHeight="{TemplateBinding MaxDropDownHeight}" SnapsToDevicePixels="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                                                    <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Local" Margin="2,2,2,0"/>
                                                </ScrollViewer>
                                                <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BorderBrush}" BorderThickness="0,1,0,0" Grid.Row="1" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BackgroundBrush}">
                                                    <Grid>
                                                        <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                                        <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                                    </Grid>
                                                </Border>
                                            </Grid>
                                        </Grid>
                                    </Border>
                                </Border>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="ResizeMode" Value="None">
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Both">
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Vertical">
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="Size" Value="Small">
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="Content" TargetName="iconImage" Value="{converters:ObjectToImageConverter {Binding Icon, RelativeSource={RelativeSource TemplatedParent}}, '16,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}" />
                            <Setter Property="HasTwoLines" TargetName="controlLabel" Value="False" />
                            <Setter Property="Text" TargetName="controlLabel" Value="" />
                            <Setter Property="Width" TargetName="iconImage" Value="16" />
                            <Setter Property="Height" TargetName="iconImage" Value="16" />
                            <Setter Property="Margin" TargetName="iconImage" Value="2,0,0,0" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="-2,0,2,1" />
                            <Setter Property="Width" TargetName="controlLabel" Value="10" />
                            <Setter Property="VerticalAlignment" TargetName="controlLabel" Value="Center" />
                        </Trigger>
                        <Trigger Property="Size" Value="Middle">
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="Content" TargetName="iconImage" Value="{converters:ObjectToImageConverter {Binding Icon, RelativeSource={RelativeSource TemplatedParent}}, '16,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}" />
                            <Setter Property="Width" TargetName="stackPanel" Value="Auto" />
                            <Setter Property="VerticalAlignment" TargetName="iconImage" Value="Center" />
                            <Setter Property="HasTwoLines" TargetName="controlLabel" Value="False" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="2,0,2,1" />
                            <!--Setter Property="VerticalAlignment" TargetName="PART_ButtonBorder" Value="Stretch" /-->
                            <Setter Property="Width" TargetName="iconImage" Value="16" />
                            <Setter Property="Height" TargetName="iconImage" Value="16" />
                            <Setter Property="Margin" TargetName="iconImage" Value="2,0,2,0" />
                            <Setter Property="VerticalAlignment" TargetName="controlLabel" Value="Center" />
                        </Trigger>
                        <Trigger Property="Size" Value="Large">
                            <Setter TargetName="iconImage" Property="Margin" Value="0,2,0,5"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="False"/>
                                <Condition Property="IsDropDownOpen" Value="False"/>
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <!--Trigger Property="IsDropDownOpen" Value="True">
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                        </Trigger-->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" TargetName="iconImage" Value="0.5" />
                            <Setter Property="Opacity" TargetName="controlLabel" Value="0.5" />
                            <Setter Property="Effect" TargetName="iconImage">
                                <Setter.Value>
                                    <Fluent:GrayscaleEffect />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <!--MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.Background}" />
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                        </MultiTrigger-->
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!--Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="68" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="22" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="32" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger-->
            <Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="76" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="30" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="30" />
                <Setter Property="Width" Value="30" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:MenuItem}" TargetType="{x:Type Fluent:MenuItem}">
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Hidden" />
        <Setter Property="Margin" Value="0,0,0,3"/>
        <Setter Property="Background" Value="#01000000" />
        <Setter Property="Foreground" Value="{DynamicResource ButtonForegroundBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type MenuItem}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" MinWidth="25" MaxWidth="41" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Border x:Name="HoverBackground" CornerRadius="{Binding Path=(tic:AttachedProperties.CornerCurves), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource CornerCurvesToCornerRadiusConverter}, ConverterParameter='3,3,3,3;0,0,0,0'}" Margin="0" Padding="0" BorderBrush="{DynamicResource ButtonHoverBorderBrush}" BorderThickness="1" Opacity="0" Grid.ColumnSpan="3">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1"  GradientStops="{DynamicResource ButtonHoverBackgroundGradientStops}"/>
                            </Border.Background>
                            <Border CornerRadius="{Binding Path=(tic:AttachedProperties.CornerCurves), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource CornerCurvesToCornerRadiusConverter}, ConverterParameter='2,2,2,2;0,0,0,0'}" Margin="1" Padding="0" BorderBrush="Transparent" BorderThickness="0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonHoverSecondaryBackgroundGradientStops}"/>
                                </Border.Background>
                            </Border>
                        </Border>
                        <Border x:Name="border" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Visibility="Collapsed" Grid.Column="0" Grid.ColumnSpan="3">
                        </Border>
                        <ContentPresenter x:Name="textBlock" ContentSource="Header" ContentTemplate="{TemplateBinding HeaderTemplate}" ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" Width="Auto" Height="Auto" Margin="5,3,3,3" VerticalAlignment="Center" Grid.Column="1" RecognizesAccessKey="True" />
                        <Image x:Name="checkedImage" HorizontalAlignment="Center" VerticalAlignment="Center" Width="16" Height="16" Stretch="Uniform" Source="{DynamicResource Fluent.Ribbon.Images.Checked}" Visibility="Collapsed" SnapsToDevicePixels="True" />
                        <Border x:Name="iconImageBorder" BorderThickness="1">
                            <!--ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" MinHeight="16" VerticalAlignment="Center" Content="{converters:ObjectToImageConverter {Binding Icon, RelativeSource={RelativeSource TemplatedParent}}, '16,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}" MinWidth="16" Margin="3,2,2,2" SnapsToDevicePixels="True" /-->
                            <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" MinHeight="16" VerticalAlignment="Center" Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}}" MinWidth="16" Margin="3,2,2,2" SnapsToDevicePixels="True" />
                        </Border>
                        <TextBlock x:Name="gestureTextBlock" Text="{TemplateBinding InputGestureText}" Width="Auto" Height="Auto" Margin="3,3,15,3" VerticalAlignment="Center" Grid.Column="2" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="InputGestureText" Value="{x:Null}">
                            <Setter Property="Visibility" TargetName="gestureTextBlock" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="InputGestureText" Value="">
                            <Setter Property="Visibility" TargetName="gestureTextBlock" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter Property="Background" TargetName="iconImageBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.ToggleButton.Checked.Background}" />
                            <Setter Property="BorderBrush" TargetName="iconImageBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.ToggleButton.Checked.BorderBrush}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Icon" Value="{x:Null}" />
                                <Condition Property="IsChecked" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Visibility" TargetName="checkedImage" Value="Visible" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsHighlighted" Value="True" />
                                <Condition Property="IsEnabled" Value="True" />
                            </MultiTrigger.Conditions>
                            <!--Setter Property="Visibility" TargetName="border" Value="Visible" /-->
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" TargetName="iconImage" Value="0.5" />
                            <Setter Property="Opacity" TargetName="checkedImage" Value="0.5" />
                            <Setter Property="Opacity" TargetName="textBlock" Value="0.5" />
                            <Setter Property="Opacity" TargetName="gestureTextBlock" Value="0.5" />
                            <Setter Property="Effect" TargetName="iconImage">
                                <Setter.Value>
                                    <Fluent:GrayscaleEffect />
                                </Setter.Value>
                            </Setter>
                            <Setter Property="Effect" TargetName="checkedImage">
                                <Setter.Value>
                                    <Fluent:GrayscaleEffect />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Fluent:MenuItem.IsSplited" Value="True" />
                    <Condition Property="HasItems" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type MenuItem}">
                            <Grid Background="{TemplateBinding Background}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" MinWidth="25" MaxWidth="41" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Rectangle Grid.Column="2" HorizontalAlignment="Right" Margin="0,4,23,4" Stroke="{DynamicResource Fluent.Ribbon.Brushes.Separator.BorderBrush}" Width="1" />
                                <Grid HorizontalAlignment="Stretch" Margin="0" Width="Auto" Grid.Column="0" Grid.ColumnSpan="3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="0.905*" />
                                        <ColumnDefinition x:Name="columnDefinition" Width="23" />
                                    </Grid.ColumnDefinitions>
                                    <Border x:Name="PART_ButtonBorder" Visibility="Collapsed" Background="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.Background}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" BorderThickness="1" Margin="0,0,-1,0">
                                        <!--Background="#01000000"-->
                                    </Border>
                                    <Border x:Name="HoverBackground" CornerRadius="{Binding Path=(tic:AttachedProperties.CornerCurves), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource CornerCurvesToCornerRadiusConverter}, ConverterParameter='3,0,0,3;0,0,0,0'}" Margin="0" Padding="0" BorderBrush="{DynamicResource ButtonHoverBorderBrush}" BorderThickness="1,1,0,1" Opacity="0" IsHitTestVisible="False" Grid.Column="0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1"  GradientStops="{DynamicResource ButtonHoverBackgroundGradientStops}"/>
                                        </Border.Background>
                                        <Border x:Name="InnerHoverBackground" CornerRadius="{Binding Path=(tic:AttachedProperties.CornerCurves), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource CornerCurvesToCornerRadiusConverter}, ConverterParameter='2,0,0,2;0,0,0,0'}" Margin="1" Padding="0" BorderBrush="Transparent" BorderThickness="0" IsHitTestVisible="False">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonHoverSecondaryBackgroundGradientStops}"/>
                                            </Border.Background>
                                        </Border>
                                    </Border>
                                    <Border x:Name="SelectedBackground" CornerRadius="{Binding CornerRadius, ElementName=HoverBackground}" Margin="0" Padding="0" BorderBrush="{DynamicResource ButtonPressedBorderBrush}" BorderThickness="1,1,0,1" Opacity="0" Grid.Column="0" IsHitTestVisible="False">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonPressedBackgroundGradientStops}"/>
                                        </Border.Background>
                                        <Border CornerRadius="{Binding CornerRadius, ElementName=InnerHoverBackground}" Margin="1" Padding="0" BorderBrush="Transparent" BorderThickness="0" IsHitTestVisible="False">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonPressedSecondaryBackgroundGradientStops}"/>
                                            </Border.Background>
                                        </Border>
                                    </Border>
                                    <Border x:Name="Submenu_Border" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Visibility="Collapsed" Background="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.Background}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" BorderThickness="1" Grid.Column="1" />
                                    <Border x:Name="SubmenuHoverBackground" CornerRadius="{Binding Path=(tic:AttachedProperties.CornerCurves), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource CornerCurvesToCornerRadiusConverter}, ConverterParameter='0,3,3,0;0,0,0,0'}" Margin="0" Padding="0" BorderBrush="{DynamicResource ButtonHoverBorderBrush}" BorderThickness="1" Opacity="0" IsHitTestVisible="False" Grid.Column="1">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1"  GradientStops="{DynamicResource ButtonHoverBackgroundGradientStops}"/>
                                        </Border.Background>
                                        <Border x:Name="SubmenuInnerHoverBackground" CornerRadius="{Binding Path=(tic:AttachedProperties.CornerCurves), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource CornerCurvesToCornerRadiusConverter}, ConverterParameter='0,2,2,0;0,0,0,0'}" Margin="1" Padding="0" BorderBrush="Transparent" BorderThickness="0" IsHitTestVisible="False">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonHoverSecondaryBackgroundGradientStops}"/>
                                            </Border.Background>
                                        </Border>
                                    </Border>
                                    <Border x:Name="SubmenuSelectedBackground" CornerRadius="{Binding CornerRadius, ElementName=SubmenuHoverBackground}" Margin="0" Padding="0" BorderBrush="{DynamicResource ButtonPressedBorderBrush}" BorderThickness="1" Opacity="0" IsHitTestVisible="False" Grid.Column="1">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonPressedBackgroundGradientStops}"/>
                                        </Border.Background>
                                        <Border CornerRadius="{Binding CornerRadius, ElementName=SubmenuInnerHoverBackground}" Margin="1" Padding="0" BorderBrush="Transparent" BorderThickness="0" IsHitTestVisible="False">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonPressedSecondaryBackgroundGradientStops}"/>
                                            </Border.Background>
                                        </Border>
                                    </Border>
                                    <Path Data="M 0 0 L 4 4 L 0 8 Z" Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:MenuItem}}}" HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="1"/>
                                </Grid>
                                <ContentPresenter x:Name="textBlock" ContentSource="Header" ContentTemplate="{TemplateBinding HeaderTemplate}" ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" Width="Auto" Height="Auto" Margin="5,3,3,3" VerticalAlignment="Center" Grid.Column="1" RecognizesAccessKey="True" />
                                <Image x:Name="checkedImage" HorizontalAlignment="Center" VerticalAlignment="Center" Width="16" Height="16" Stretch="Uniform" Source="{DynamicResource Fluent.Ribbon.Images.Checked}" Visibility="Collapsed" SnapsToDevicePixels="True" />
                                <Border x:Name="iconImageBorder" BorderThickness="1">
                                    <!--ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" MinHeight="16" VerticalAlignment="Center" Content="{converters:ObjectToImageConverter {Binding Icon, RelativeSource={RelativeSource TemplatedParent}}, '16,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}" MinWidth="16" Margin="3,2,2,2" SnapsToDevicePixels="True" /-->
                                    <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" MinHeight="16" VerticalAlignment="Center" Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}}" MinWidth="16" Margin="3,2,2,2" SnapsToDevicePixels="True" />
                                </Border>
                                <Path x:Name="path" Stretch="Fill" Stroke="{x:Null}" HorizontalAlignment="Right" Margin="1,0,9,0" Width="4" Data="M0,0L1,1 0,2z" Height="7" Grid.Column="3" Fill="{DynamicResource Fluent.Ribbon.MenuItem.SubMenu.Arrow.Fill}" />
                                <Popup x:Name="PART_Popup" Placement="Right" IsOpen="{TemplateBinding IsSubmenuOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                                    <Grid x:Name="DropDown" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Stretch">
                                        <Border x:Name="DropDownBorder" SnapsToDevicePixels="True" Background="#01000000" BorderBrush="{DynamicResource HorizontalPanelBorderBrush}" BorderThickness="1,0,0,0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                <Border VerticalAlignment="Stretch" Width="Auto" Height="Auto" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" />
                                                <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="*" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Path Fill="{x:Null}" Stretch="Fill" Stroke="{DynamicResource Fluent.Ribbon.Brushes.Separator.BorderBrush}" HorizontalAlignment="Left" Margin="24,0,0,0" Width="1" Height="Auto" Data="M0,0L0,1" Grid.RowSpan="2" Visibility="Visible" />
                                                    <ScrollViewer Margin="1" x:Name="PART_ScrollViewer" Style="{DynamicResource MenuScrollViewer}" SnapsToDevicePixels="True">
                                                        <StackPanel x:Name="PART_MenuPanel" Orientation="Vertical" IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                                    </ScrollViewer>
                                                    <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BorderBrush}" BorderThickness="0,1,0,0" Grid.Row="1" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BackgroundBrush}">
                                                        <Grid>
                                                            <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                                            <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                                        </Grid>
                                                    </Border>
                                                </Grid>
                                            </Grid>
                                        </Border>
                                    </Grid>
                                </Popup>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="Fluent:MenuItem.ResizeMode" Value="None">
                                    <Setter Property="Visibility" TargetName="resizeBorder" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="Fluent:MenuItem.ResizeMode" Value="Both">
                                    <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Collapsed" />
                                    <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Visible" />
                                    <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                                </Trigger>
                                <Trigger Property="Fluent:MenuItem.ResizeMode" Value="Vertical">
                                    <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Collapsed" />
                                    <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Visible" />
                                    <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                                </Trigger>
                                <!--Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Background" TargetName="iconImageBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.ToggleButton.Checked.Background}" />
                                    <Setter Property="BorderBrush" TargetName="iconImageBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.ToggleButton.Checked.BorderBrush}" />
                                </Trigger-->
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="Icon" Value="{x:Null}" />
                                        <Condition Property="IsChecked" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Visibility" TargetName="checkedImage" Value="Visible" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsHighlighted" Value="False" />
                                        <!--Condition Property="IsEnabled" Value="False" /-->
                                        <Condition Property="IsSubmenuOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <!--Setter Property="Visibility" TargetName="PART_ButtonBorder" Value="Visible" />
                                    <Setter Property="Visibility" TargetName="Submenu_Border" Value="Visible" /-->
                                    <MultiTrigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                                <DoubleAnimation Storyboard.TargetName="SubmenuHoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </MultiTrigger.EnterActions>
                                    <MultiTrigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                                <DoubleAnimation Storyboard.TargetName="SubmenuHoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </MultiTrigger.ExitActions>
                                </MultiTrigger>
                                <Trigger Property="IsSubmenuOpen" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="SubmenuSelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>
                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="SubmenuSelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                    <!--Setter Property="Background" TargetName="Submenu_Border" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" /-->
                                </Trigger>
                                <!--Trigger Property="IsSubmenuOpen" Value="True">
                                    <Setter TargetName="SelectedBackground" Property="Visibility" Value="Visible"/>
                                </Trigger-->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <!--SourceName="PART_ButtonBorder" -->
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>
                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Opacity" TargetName="iconImage" Value="0.5" />
                                    <Setter Property="Opacity" TargetName="checkedImage" Value="0.5" />
                                    <Setter Property="Opacity" TargetName="textBlock" Value="0.5" />
                                    <Setter Property="Effect" TargetName="iconImage">
                                        <Setter.Value>
                                            <Fluent:GrayscaleEffect />
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Effect" TargetName="checkedImage">
                                        <Setter.Value>
                                            <Fluent:GrayscaleEffect />
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Fluent:MenuItem.IsSplited" Value="False" />
                    <Condition Property="HasItems" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="Template" Value="{DynamicResource HeaderMenuItemTemplate}" />
            </MultiTrigger>
            <DataTrigger Binding="{Binding Description, RelativeSource={RelativeSource Self}, Converter={x:Static converters:IsNullConverter.Instance}}" Value="False">
                <Setter Property="Template" Value="{DynamicResource MenuItemWithDescriptionTemplate}" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:ContextMenu}" TargetType="{x:Type Fluent:ContextMenu}">
        <Setter Property="MinWidth" Value="0" />
        <Setter Property="MinHeight" Value="0" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="Padding" Value="3,3,3,0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:ContextMenu}">
                    <ControlTemplate.Resources>
                        <!--Style BasedOn="{StaticResource MenuSeparatorStyle}" TargetType="{x:Type Separator}" />
                        <Style TargetType="{x:Type Fluent:GroupSeparatorMenuItem}" BasedOn="{StaticResource MenuGroupSeparatorStyle}" /-->
                        <Style x:Key="{x:Type Fluent:MenuItem}" TargetType="{x:Type Fluent:MenuItem}" BasedOn="{StaticResource {x:Type Fluent:MenuItem}}">
                            <Setter Property="Margin" Value="0,0,0,-6"/>
                        </Style>
                    </ControlTemplate.Resources>
                    <Grid Margin="4,3,4,5">
                        <Border UseLayoutRounding="True" Effect="{DynamicResource DropShadow}" CornerRadius="3">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                            </Border.Background>
                            <Grid Margin="{TemplateBinding Padding}">
                                <Grid HorizontalAlignment="Left" VerticalAlignment="Top">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <ScrollViewer x:Name="PART_ScrollViewer" SnapsToDevicePixels="True" VerticalScrollBarVisibility="Auto">
                                        <!--Style="{DynamicResource MenuScrollViewer}"-->
                                        <StackPanel IsItemsHost="True" Orientation="Vertical" Margin="0,0,0,9" Width="Auto" Height="Auto" x:Name="PART_ItemsHost" HorizontalAlignment="Left" VerticalAlignment="Top" />
                                    </ScrollViewer>
                                    <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BorderBrush}" BorderThickness="0,1,0,0" Grid.Row="1" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BackgroundBrush}">
                                        <Grid>
                                            <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                            <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                        </Grid>
                                    </Border>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="FlowDirection" Value="RightToLeft">
                            <Setter Property="Cursor" TargetName="PART_ResizeBothThumb" Value="SizeNESW" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="None">
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Both">
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Vertical">
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type Fluent:ApplicationMenu}">
        <Setter Property="Background" Value="{DynamicResource Fluent.Ribbon.Brushes.AccentBaseColorBrush}" />
        <Setter Property="Foreground" Value="{DynamicResource TitlebarIdleForegroundBrush}" />
        <!--Setter Property="Header" Value="{DynamicResource Fluent.Ribbon.Images.ApplicationMenu}" /-->
        <!--Setter Property="ItemContainerStyleSelector" Value="{x:Static styleSelectors:ApplicationMenuItemContainerStyleSelector.Instance}" /-->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:ApplicationMenu}">
                    <Grid Margin="0">
                        <ContentControl x:Name="buttonContent">
                            <!--Width="{Binding ActualWidth, ElementName=PART_ButtonBorder}" Height="{Binding ActualHeight, ElementName=PART_ButtonBorder}"-->
                            <Border x:Name="PART_ButtonBorder" MinWidth="60" Background="#01000000">
                                <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" ClipToBounds="True">
                                    <Rectangle x:Name="PopupSizingAid" Fill="#01000000" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,5,4,0"/>
                                    <Border x:Name="ButtonHoverBackground" BorderThickness="0" BorderBrush="Transparent" Margin="0,0,3,-2" IsHitTestVisible="False" Background="{DynamicResource HoverHighlightBrush}" RenderTransformOrigin="0.5,1">
                                        <Border.RenderTransform>
                                            <ScaleTransform ScaleX="1" ScaleY="0"/>
                                        </Border.RenderTransform>
                                        <Border.OpacityMask>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Offset="0" Color="Transparent"/>
                                                <GradientStop Offset="1" Color="#7F000000"/>
                                            </LinearGradientBrush>
                                        </Border.OpacityMask>
                                        <Border.Effect>
                                            <BlurEffect Radius="5"/>
                                        </Border.Effect>
                                    </Border>
                                    <ContentControl x:Name="contentPresenter" FontWeight="Bold" Content="{TemplateBinding Header}" Margin="10,0" VerticalAlignment="Center" HorizontalAlignment="Center" Effect="{DynamicResource DropShadow}"/>
                                    <!--{converters:ObjectToImageConverter {Binding Header, RelativeSource={RelativeSource TemplatedParent}}, '32,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}-->
                                </Grid>
                            </Border>
                        </ContentControl>
                        <Popup x:Name="PART_Popup" Placement="Custom" CustomPopupPlacementCallback="{x:Static FluentHelpers:PopupHelper.SimplePlacementCallback}" PlacementTarget="{Binding ElementName=buttonContent}" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                            <!--MaxHeight="{TemplateBinding MaxDropDownHeight}"-->
                            <!--VerticalOffset="{Binding ElementName=buttonContent, Path=ActualHeight}"-->
                            <Grid Name="DropDown" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Top">
                                <Border x:Name="PART_DropDownBorder" MinWidth="{TemplateBinding ActualWidth}" SnapsToDevicePixels="True" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                    <Grid>
                                        <DockPanel Margin="5,5,14,24" Effect="{DynamicResource SecondaryDropShadow}">
                                            <DockPanel DockPanel.Dock="Top" Height="{Binding Path=ActualHeight, ElementName=PopupSizingAid}">
                                                <Grid Width="{Binding Path=ActualWidth, ElementName=PopupSizingAid}" ClipToBounds="True" DockPanel.Dock="Left">
                                                    <Border BorderBrush="{Binding Background,ElementName=PopupHeaderRightBorder}" BorderThickness="5" CornerRadius="0,0,7,0" Margin="-10,-10,-5,-5"/>
                                                </Grid>
                                                <Border x:Name="PopupHeaderRightBorder" CornerRadius="3,3,0,0">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,10" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                                                    </Border.Background>
                                                </Border>
                                            </DockPanel>
                                            <Border CornerRadius="3,0,3,3">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,-0.1" EndPoint="0,1" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                                                </Border.Background>
                                            </Border>
                                        </DockPanel>
                                        <DockPanel Margin="7">
                                            <Rectangle DockPanel.Dock="Top" Height="{Binding Path=ActualHeight, ElementName=PopupSizingAid}" Fill="Transparent" Opacity="0" Visibility="Hidden"/>
                                            <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Top" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                                <Grid HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="*" />
                                                        <RowDefinition Height="Auto" MinHeight="17" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" MinWidth="100" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <ScrollViewer Style="{DynamicResource MenuScrollViewer}" Grid.Row="0" Grid.Column="0" IsTabStop="False" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Hidden">
                                                        <StackPanel Orientation="Vertical" ScrollViewer.VerticalScrollBarVisibility="Auto" IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                                    </ScrollViewer>
                                                    <Border Grid.Row="0" Grid.Column="1" BorderThickness="1,0,0,0" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.Separator.BorderBrush}" Width="{TemplateBinding RightPaneWidth}">
                                                        <ScrollViewer x:Name="PART_ScrollViewer" Style="{DynamicResource MenuScrollViewer}" IsTabStop="False" Margin="1" SnapsToDevicePixels="True" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Hidden">
                                                            <ContentPresenter ContentSource="RightPaneContent" x:Name="PART_RightContentPresenter" />
                                                        </ScrollViewer>
                                                    </Border>
                                                    <Border Grid.Row="1" Grid.ColumnSpan="2" BorderThickness="0,1,0,0" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.Separator.BorderBrush}" Background="{DynamicResource Fluent.Ribbon.Brushes.Ribbon.Background}" Margin="0">
                                                        <ContentPresenter ContentSource="FooterPaneContent" />
                                                    </Border>
                                                </Grid>
                                            </Grid>
                                        </DockPanel>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding IsActive, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}" Value="False"/>
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="contentPresenter" Property="Foreground" Value="{DynamicResource TitlebarInactiveIdleForegroundBrush}" />
                        </MultiDataTrigger>
                        <Trigger SourceName="buttonContent" Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="ButtonHoverBackground" Storyboard.TargetProperty="RenderTransform.ScaleY" To="1" Duration="0:0:0.0625"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="ButtonHoverBackground" Storyboard.TargetProperty="RenderTransform.ScaleY" To="0" Duration="0:0:0.0625"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" TargetName="PART_ButtonBorder" Value="0.5" />
                            <Setter Property="Effect" TargetName="contentPresenter">
                                <Setter.Value>
                                    <Fluent:GrayscaleEffect />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:SplitButton}" TargetType="{x:Type Fluent:SplitButton}">
        <!--Setter Property="Height" Value="68" /-->
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Foreground" Value="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="Fluent:KeyTip.AutoPlacement" Value="False" />
        <Setter Property="Margin" Value="2,-3,2,-4"/>
        <Setter Property="Padding" Value="6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:SplitButton}">
                    <!--ControlTemplate.Resources>
                        <Style BasedOn="{StaticResource MenuSeparatorStyle}" TargetType="{x:Type Separator}" />
                    </ControlTemplate.Resources-->
                    <Grid>
                        <Border x:Name="HoverBackground" Opacity="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-3,-3,-3,-11" UseLayoutRounding="True">
                            <Border.Background>
                                <VisualBrush>
                                    <VisualBrush.Visual>
                                        <Grid Background="#01000000" Width="{Binding ActualWidth, ElementName=HoverBackground}" Height="{Binding ActualHeight, ElementName=HoverBackground}">
                                            <Border CornerRadius="3" Effect="{DynamicResource TertiaryDropShadow}" Margin="3" UseLayoutRounding="True">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                                                </Border.Background>
                                            </Border>
                                        </Grid>
                                    </VisualBrush.Visual>
                                </VisualBrush>
                            </Border.Background>
                        </Border>
                        <Border Name="PART_ButtonBorder" Background="#01000000" BorderBrush="Transparent" VerticalAlignment="Stretch">
                            <StackPanel Orientation="Vertical" Name="stackPanel" KeyboardNavigation.TabNavigation="Local">
                                <Grid Margin="0">
                                    <Fluent:ToggleButton x:Name="PART_Button" Command="{TemplateBinding Command}" CommandParameter="{TemplateBinding CommandParameter}" CommandTarget="{TemplateBinding CommandTarget}" IsEnabled="{TemplateBinding IsButtonEnabled}" ToolTip="{TemplateBinding ToolTip}" GroupName="{Binding GroupName, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsChecked="{Binding IsChecked, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsDefinitive="{TemplateBinding IsDefinitive}" CanAddToQuickAccessToolBar="{TemplateBinding CanAddButtonToQuickAccessToolBar}" LargeIcon="{Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}}" Icon="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}}">
                                        <Fluent:ToggleButton.Style>
                                            <Style TargetType="{x:Type Fluent:ToggleButton}">
                                                <Setter Property="Width" Value="Auto" />
                                                <Setter Property="Foreground" Value="{Binding Foreground, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <Setter Property="BorderThickness" Value="1" />
                                                <Setter Property="Margin" Value="0,2,0,0"/>
                                                <Setter Property="Padding" Value="2,6,2,2"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type Fluent:ToggleButton}">
                                                            <Border x:Name="border" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}" Height="Auto">
                                                                <Grid>
                                                                    <Border x:Name="HoverBackground" CornerRadius="3,3,0,0" Margin="3,1,3,-1" Opacity="0">
                                                                        <Border.Background>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1.5" GradientStops="{DynamicResource CardListViewSelectedBackgroundGradientStops}"/>
                                                                        </Border.Background>
                                                                    </Border>
                                                                    <StackPanel x:Name="stackPanel" Width="Auto" Margin="{TemplateBinding Padding}" Orientation="Vertical">
                                                                        <ContentPresenter x:Name="iconImage" Width="32" Height="32" Margin="0,-1,0,0" HorizontalAlignment="Center" VerticalAlignment="Center" Content="{Binding LargeIcon, RelativeSource={RelativeSource Mode=TemplatedParent}}" SnapsToDevicePixels="True" />
                                                                        <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2,0,2,-2" />
                                                                    </StackPanel>
                                                                </Grid>
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="Size" Value="Small">
                                                                    <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                                                                    <Setter Property="Visibility" TargetName="controlLabel" Value="Collapsed" />
                                                                    <Setter Property="HasTwoLines" TargetName="controlLabel" Value="False" />
                                                                    <Setter Property="Width" TargetName="iconImage" Value="16" />
                                                                    <Setter Property="Height" TargetName="iconImage" Value="16" />
                                                                    <Setter Property="Margin" TargetName="iconImage" Value="1,0,2,0" />
                                                                    <Setter Property="Content" TargetName="iconImage" Value="{Binding Icon, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                                    <Setter Property="Margin" TargetName="controlLabel" Value="2,-2,2,2" />
                                                                </Trigger>
                                                                <Trigger Property="Size" Value="Middle">
                                                                    <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                                                                    <Setter Property="Width" TargetName="stackPanel" Value="Auto" />
                                                                    <Setter Property="VerticalAlignment" TargetName="iconImage" Value="Center" />
                                                                    <Setter Property="HasTwoLines" TargetName="controlLabel" Value="False" />
                                                                    <Setter Property="Margin" TargetName="controlLabel" Value="2,2,2,2" />
                                                                    <Setter Property="VerticalAlignment" TargetName="border" Value="Stretch" />
                                                                    <Setter Property="Width" TargetName="iconImage" Value="16" />
                                                                    <Setter Property="Height" TargetName="iconImage" Value="16" />
                                                                    <Setter Property="Margin" TargetName="iconImage" Value="1,0,2,0" />
                                                                    <Setter Property="VerticalAlignment" TargetName="controlLabel" Value="Center" />
                                                                    <Setter Property="Content" TargetName="iconImage" Value="{Binding Icon, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                                </Trigger>
                                                                <Trigger Property="Size" Value="Large">
                                                                    <Setter TargetName="controlLabel" Property="Visibility" Value="Collapsed"/>
                                                                </Trigger>
                                                                <Trigger Property="IsEnabled" Value="False">
                                                                    <Setter Property="Opacity" TargetName="iconImage" Value="0.5" />
                                                                    <Setter Property="Opacity" TargetName="controlLabel" Value="0.5" />
                                                                    <Setter Property="Effect" TargetName="iconImage">
                                                                        <Setter.Value>
                                                                            <Fluent:GrayscaleEffect />
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Trigger>
                                                                <MultiTrigger>
                                                                    <MultiTrigger.Conditions>
                                                                        <Condition Property="IsMouseOver" Value="False"/>
                                                                        <Condition Property="IsChecked" Value="False"/>
                                                                    </MultiTrigger.Conditions>
                                                                    <MultiTrigger.EnterActions>
                                                                        <BeginStoryboard>
                                                                            <Storyboard>
                                                                                <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                                                            </Storyboard>
                                                                        </BeginStoryboard>
                                                                    </MultiTrigger.EnterActions>
                                                                    <MultiTrigger.ExitActions>
                                                                        <BeginStoryboard>
                                                                            <Storyboard>
                                                                                <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                                                            </Storyboard>
                                                                        </BeginStoryboard>
                                                                    </MultiTrigger.ExitActions>
                                                                </MultiTrigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="Size" Value="Middle">
                                                        <Setter Property="Height" Value="30" />
                                                        <Setter Property="HorizontalAlignment" Value="Left" />
                                                    </Trigger>
                                                    <Trigger Property="Size" Value="Small">
                                                        <Setter Property="Height" Value="30" />
                                                        <Setter Property="Width" Value="30" />
                                                        <Setter Property="HorizontalAlignment" Value="Left" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Fluent:ToggleButton.Style>
                                    </Fluent:ToggleButton>
                                    <!--Style="{DynamicResource InnerButtonStyle}"-->
                                    <!--Header="{TemplateBinding Header}" -->
                                    <!--ContentPresenter x:Name="iconImage" Width="32" Height="32" Margin="0,2,0,0" HorizontalAlignment="Center" VerticalAlignment="Center" Content="{Binding LargeIcon, RelativeSource={RelativeSource Mode=TemplatedParent}}" SnapsToDevicePixels="True" /-->
                                </Grid>
                                <Border BorderThickness="0,0,0,0" Name="downBorder" BorderBrush="Transparent" Background="Transparent" Margin="0,0,0,0">
                                    <Grid>
                                        <Border x:Name="LowerHoverBackground" CornerRadius="0,0,3,3" Margin="4,0,4,2" Opacity="0">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,-1" EndPoint="0,0.75" GradientStops="{DynamicResource CardListViewSelectedBackgroundGradientStops}"/>
                                            </Border.Background>
                                        </Border>
                                        <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2,1,2,2" HasGlyph="{TemplateBinding HasTriangle}" />
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </Border>
                        <Popup x:Name="PART_Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                            <Grid Name="DropDown" IsEnabled="{TemplateBinding IsEnabled}" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Top">
                                <Border x:Name="PART_DropDownBorder" MinWidth="{TemplateBinding ActualWidth}" SnapsToDevicePixels="True" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BorderBrush}" BorderThickness="1" HorizontalAlignment="Stretch" VerticalAlignment="Top"> <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                        <Border VerticalAlignment="Top" Width="Auto" Height="Auto" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderThickness="1" />
                                        <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <ScrollViewer x:Name="PART_ScrollViewer" Style="{DynamicResource MenuScrollViewer}" Margin="1" MaxHeight="{TemplateBinding MaxDropDownHeight}" SnapsToDevicePixels="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                                                <StackPanel x:Name="PART_MenuPanel" Orientation="Vertical" IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                            </ScrollViewer>
                                            <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BorderBrush}" BorderThickness="0,1,0,0" Grid.Row="1" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BackgroundBrush}">
                                                <Grid>
                                                    <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                                    <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                                </Grid>
                                            </Border>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="ResizeMode" Value="None">
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Both">
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Vertical">
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                        </Trigger>
                        <Trigger Property="Size" Value="Small">
                            <Setter Property="Size" TargetName="PART_Button" Value="Small" />
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="Width" TargetName="controlLabel" Value="10" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="0,-19,0,0" />
                            <Setter Property="Text" TargetName="controlLabel" Value="" />
                            <Setter Property="Padding" TargetName="downBorder" Value="1,0,0,0" />
                        </Trigger>
                        <Trigger Property="Size" Value="Middle">
                            <Setter Property="Size" TargetName="PART_Button" Value="Middle" />
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="Width" TargetName="controlLabel" Value="10" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="0,-19,0,0" />
                            <Setter Property="Text" TargetName="controlLabel" Value="" />
                            <Setter TargetName="PART_Button" Property="Header" Value="{Binding Header,RelativeSource={RelativeSource Mode=TemplatedParent}}"/>
                        </Trigger>
                        <Trigger Property="Size" Value="Large">
                            <Setter TargetName="PART_Button" Property="Height" Value="42"/>
                        </Trigger>
                        <Trigger Property="IsButtonEnabled" Value="False">
                            <Setter Property="IsEnabled" TargetName="PART_Button" Value="False" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="IsEnabled" TargetName="PART_Button" Value="False" />
                            <Setter Property="Opacity" TargetName="controlLabel" Value="0.5" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="False"/>
                                <Condition Property="IsDropDownOpen" Value="False"/>
                                <Condition Property="IsChecked" Value="False"/>
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition SourceName="downBorder" Property="IsMouseOver" Value="False"/>
                                <Condition Property="IsDropDownOpen" Value="False"/>
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <!--Trigger Property="IsDropDownOpen" Value="True">
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="PART_Button" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="downBorder" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                            <Setter Property="Background" TargetName="downBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                            <Setter Property="BorderBrush" TargetName="downBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                        </MultiTrigger-->
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!--Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="68" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Bottom" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="22" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Right" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.Margin" Value="0,0,-5,0" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="32" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Right" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.Margin" Value="0,0,-5,0" />
            </Trigger-->
            <Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="76" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="30" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="30" />
                <Setter Property="Width" Value="30" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:ToggleButton}" TargetType="{x:Type Fluent:ToggleButton}">
        <!--Setter Property="Height" Value="68" /-->
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Foreground" Value="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="2,-3,2,-4"/>
        <Setter Property="Padding" Value="6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:ToggleButton}">
                    <Border x:Name="border" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}" Height="Auto">
                        <Grid>
                            <Border x:Name="HoverBackground" Opacity="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-3" UseLayoutRounding="True">
                                <Border.Background>
                                    <VisualBrush>
                                        <VisualBrush.Visual>
                                            <Grid Background="#01000000" Width="{Binding ActualWidth, ElementName=HoverBackground}" Height="{Binding ActualHeight, ElementName=HoverBackground}">
                                                <Border CornerRadius="3" Effect="{DynamicResource TertiaryDropShadow}" Margin="3" UseLayoutRounding="True">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource CardListViewSelectedBackgroundGradientStops}"/>
                                                    </Border.Background>
                                                </Border>
                                            </Grid>
                                        </VisualBrush.Visual>
                                    </VisualBrush>
                                </Border.Background>
                            </Border>
                            <StackPanel x:Name="stackPanel" Width="Auto" Margin="{TemplateBinding Padding}" Orientation="Vertical">
                                <ContentPresenter x:Name="iconImage" Width="32" Height="32" Margin="0,2,0,0" HorizontalAlignment="Center" VerticalAlignment="Center" Content="{Binding LargeIcon, RelativeSource={RelativeSource Mode=TemplatedParent}}" SnapsToDevicePixels="True" />
                                <!--Content="{converters:ObjectToImageConverter {Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}}, '32,32', {Binding RelativeSource={RelativeSource TemplatedParent}}}"-->
                                <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2 0 2 0" />
                            </StackPanel>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Size" Value="Small">
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="Visibility" TargetName="controlLabel" Value="Collapsed" />
                            <Setter Property="HasTwoLines" TargetName="controlLabel" Value="False" />
                            <Setter Property="Width" TargetName="iconImage" Value="16" />
                            <Setter Property="Height" TargetName="iconImage" Value="16" />
                            <Setter Property="Margin" TargetName="iconImage" Value="1,0,2,0" />
                            <Setter Property="Content" TargetName="iconImage" Value="{Binding Icon, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                            <!--Setter Property="Content" TargetName="iconImage" Value="{converters:ObjectToImageConverter {Binding Icon, RelativeSource={RelativeSource TemplatedParent}}, '16,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}" /-->
                            <Setter Property="Margin" TargetName="controlLabel" Value="2,-2,2,2" />
                        </Trigger>
                        <Trigger Property="Size" Value="Middle">
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" />
                            <Setter Property="Width" TargetName="stackPanel" Value="Auto" />
                            <Setter Property="VerticalAlignment" TargetName="iconImage" Value="Center" />
                            <Setter Property="HasTwoLines" TargetName="controlLabel" Value="False" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="2,2,2,2" />
                            <Setter Property="VerticalAlignment" TargetName="border" Value="Stretch" />
                            <Setter Property="Width" TargetName="iconImage" Value="16" />
                            <Setter Property="Height" TargetName="iconImage" Value="16" />
                            <Setter Property="Margin" TargetName="iconImage" Value="1,0,2,0" />
                            <Setter Property="VerticalAlignment" TargetName="controlLabel" Value="Center" />
                            <Setter Property="Content" TargetName="iconImage" Value="{Binding Icon, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                            <!--Setter Property="Content" TargetName="iconImage" Value="{converters:ObjectToImageConverter {Binding Icon, RelativeSource={RelativeSource TemplatedParent}}, '16,16', {Binding RelativeSource={RelativeSource TemplatedParent}}}" /-->
                        </Trigger>
                        <!--Trigger Property="IsChecked" Value="True">
                            <Setter Property="Background" TargetName="border" Value="{DynamicResource Fluent.Ribbon.Brushes.ToggleButton.Checked.Background}" />
                            <Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource Fluent.Ribbon.Brushes.ToggleButton.Checked.BorderBrush}" />
                        </Trigger-->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" TargetName="iconImage" Value="0.5" />
                            <Setter Property="Opacity" TargetName="controlLabel" Value="0.5" />
                            <Setter Property="Effect" TargetName="iconImage">
                                <Setter.Value>
                                    <Fluent:GrayscaleEffect />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="False"/>
                                <Condition Property="IsChecked" Value="False"/>
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <!--MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsPressed" Value="False" />
                                <Condition Property="IsChecked" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" TargetName="border" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.Background}" />
                            <Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsPressed" Value="False" />
                                <Condition Property="IsChecked" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" TargetName="border" Value="{DynamicResource Fluent.Ribbon.Brushes.ToggleButton.CheckedMouseOver.Background}" />
                            <Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource Fluent.Ribbon.Brushes.ToggleButton.CheckedMouseOver.BorderBrush}" />
                        </MultiTrigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="border" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                        </Trigger-->
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="76" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="30" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="30" />
                <Setter Property="Width" Value="30" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <!--Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="68" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="22" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="22" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger-->
        </Style.Triggers>
    </Style>

    <DataTemplate x:Key="TransferToDataTemplate" DataType="{x:Type disk:DiskItem}">
        <StackPanel Orientation="Horizontal" Margin="-24,0,0,0">
            <Rectangle Width="16" Height="16" Fill="{Binding ItemSmallIcon, Converter={StaticResource IconToImageBrushConverter}, ConverterParameter='16'}" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding ItemDisplayName}" Margin="6,0" VerticalAlignment="Center"/>
        </StackPanel>
    </DataTemplate>

    <!--#endregion Ribbon Control Styles-->

    <!--#region Main Ribbon Icons-->

    <DropShadowEffect x:Key="IconOuterShadow" Color="Black" Direction="270" ShadowDepth="3" BlurRadius="12.5" Opacity="0.375" />
    <DropShadowEffect x:Key="IconStrongOuterShadow" Color="Black" Direction="270" ShadowDepth="3" BlurRadius="12.5" Opacity="0.625" />
    <DropShadowEffect x:Key="IconInnerShadow" Color="Black" Direction="270" ShadowDepth="3" BlurRadius="12.5" Opacity="0.625" />
    <DropShadowEffect x:Key="IconAltInnerShadow" Color="Black" Direction="270" ShadowDepth="3" BlurRadius="12.5" Opacity="0.625" />
    
    <LinearGradientBrush x:Key="IconPrimaryFillBrush" StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource DarkIconGradientStops}"/>
    <LinearGradientBrush x:Key="IconSecondaryFillBrush" StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource DarkIconGradientStops2}"/>
    <LinearGradientBrush x:Key="IconTertiaryFillBrush" StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource DarkIconGradientStops3}"/>
    <LinearGradientBrush x:Key="IconForegroundBrush" StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource LightIconGradientStops}"/>

    <LinearGradientBrush x:Key="IconRedForegroundBrush" StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource RedIconGradientStops}"/>
    <LinearGradientBrush x:Key="IconGreenForegroundBrush" StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource GreenIconGradientStops}"/>

    <Grid x:Key="CopyButtonLargeIcon" Width="32" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid Width="30" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="#01000000">
            <Grid HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 0 L 13 0 L 18 5 L 18 22 L 0 22 Z" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}"/>
                <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconInnerShadow}"/>
            </Grid>
            <Grid HorizontalAlignment="Right" VerticalAlignment="Bottom" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 0 L 13 0 L 18 5 L 18 22 L 0 22 Z" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}"/>
                <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconInnerShadow}"/>
            </Grid>
        </Grid>
    </Grid>

    <Grid x:Key="CopyButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid Width="15" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="#01000000">
            <Grid HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 0 L 7 0 L 9 2 L 9 12 L 0 12 Z" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}"/>
                <Path Data="M 0 0 L 0 2 L 2 2 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconInnerShadow}"/>
            </Grid>
            <Grid HorizontalAlignment="Right" VerticalAlignment="Bottom" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 0 L 7 0 L 9 2 L 9 12 L 0 12 Z" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}"/>
                <Path Data="M 0 0 L 0 2 L 2 2 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconInnerShadow}"/>
            </Grid>
        </Grid>
    </Grid>

    <Grid x:Key="PasteButtonLargeIcon" Width="32" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid Width="24" Height="28" HorizontalAlignment="Center" VerticalAlignment="Center">
            <Border Background="{DynamicResource IconForegroundBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="3" CornerRadius="1" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 6 L 7 0 L 14 6 Z" HorizontalAlignment="Center" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconTertiaryFillBrush}" Margin="0,-6" Effect="{DynamicResource IconAltInnerShadow}"/>
            </Border>
        </Grid>
    </Grid>

    <Grid x:Key="PasteButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid Width="12" Height="14" HorizontalAlignment="Center" VerticalAlignment="Center">
            <Border Background="{DynamicResource IconForegroundBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="1.5" CornerRadius="1" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 2 L 3 0 L 7 2 Z" HorizontalAlignment="Center" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconTertiaryFillBrush}" Margin="0,-2" Effect="{DynamicResource IconAltInnerShadow}"/>
            </Border>
        </Grid>
    </Grid>

    <Grid x:Key="CutButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource IconStrongOuterShadow}">
        <Canvas Effect="{DynamicResource IconStrongOuterShadow}">
            <Canvas.RenderTransform>
                <TransformGroup>
                    <ScaleTransform ScaleX="3.875" ScaleY="{Binding ScaleX,RelativeSource={RelativeSource Mode=Self}}"/>
                    <TranslateTransform X="0" Y="0"/>
                </TransformGroup>
            </Canvas.RenderTransform>
            <Path StrokeLineJoin="Miter" StrokeStartLineCap="Flat" StrokeEndLineCap="Flat" Fill="{DynamicResource IconPrimaryFillBrush}" Width="16" Height="16">
                <Path.Data>
                    <PathGeometry Figures="m 1.4708861 -0.00001 c 0 0 -0.2464724 0.49366 -0.1644 0.69142 l 0.670614 1.61589 c 0 0 0.189067 0.85221 0.395972 1.26078 0.288377 0.56945 1.124315 0.96138 1.1649 0.37407 0.07374 -1.06707 -1.184756 -1.78836 -1.184756 -1.78836 z m 0.960677 2.58553 c 0.59033 0.16408 1.17456 1.4012 0.751955 1.3918 -0.531087 -0.0118 -1.057042 -1.47661 -0.751955 -1.3918 z" FillRule="NonZero"/>
                </Path.Data>
            </Path>
            <Path StrokeLineJoin="Miter" StrokeStartLineCap="Flat" StrokeEndLineCap="Flat" Fill="{DynamicResource IconPrimaryFillBrush}" Width="16" Height="16">
                <Path.Data>
                    <PathGeometry Figures="m 2.7622621 -0.00001 c 0 0 0.2464724 0.49366 0.1644 0.69142 l -0.670613 1.61589 c 0 0 -0.189067 0.85221 -0.395973 1.26078 -0.288377 0.56945 -1.12431503 0.96138 -1.16490003 0.37407 -0.07374 -1.06707 1.18475603 -1.78836 1.18475603 -1.78836 z m -0.960677 2.58553 c -0.59033 0.16408 -1.17456003 1.4012 -0.751955 1.3918 0.531088 -0.0118 1.057042 -1.47661 0.751955 -1.3918 z" FillRule="NonZero"/>
                </Path.Data>
            </Path>
        </Canvas>
    </Grid>

    <Grid x:Key="CopyPathButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Border Height="12" VerticalAlignment="Center" Background="{DynamicResource IconPrimaryFillBrush}" BorderThickness="0" CornerRadius="1" Effect="{DynamicResource IconStrongOuterShadow}">
            <TextBlock Foreground="{DynamicResource IconForegroundBrush}" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Stretch" FontSize="7" Text="\\..."/>
        </Border>
    </Grid>

    <Grid x:Key="PasteShortcutButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Background="#01000000">
        <Border Width="14" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="{DynamicResource IconPrimaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="2" CornerRadius="1" Effect="{DynamicResource IconStrongOuterShadow}">
            <Grid>
                <Path Data="M 0 2 L 2 0 L 4 2 Z" HorizontalAlignment="Center" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Margin="0,-2" Effect="{DynamicResource IconAltInnerShadow}"/>
                <Canvas Width="8" Height="8" Background="{DynamicResource IconForegroundBrush}" Margin="-2,0,1,0">
                    <Canvas.OpacityMask>
                        <VisualBrush>
                            <VisualBrush.Visual>
                                <Grid Width="8" Height="8" Background="#01000000">
                                    <Path Data="M 0 0 L 4 0 L 4 4 Z" Fill="Black" Stroke="Black" StrokeThickness="0" HorizontalAlignment="Right" VerticalAlignment="Top"/>
                                    <Path Data="M 8 0 L 4 4 L 4 8 L 4 4 Z" Fill="Black" Stroke="Black" StrokeThickness="1"/>
                                </Grid>
                            </VisualBrush.Visual>
                        </VisualBrush>
                    </Canvas.OpacityMask>
                </Canvas>
            </Grid>
        </Border>
    </Grid>

    <Grid x:Key="MoveToButtonLargeIcon" Width="30" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
            <Path Data="M 0 0 L 20 4 L 20 18 L 22 20 L 22 28 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
            <Path Data="M 0 0 L 7 5 L 8 32 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
        </Grid>
        <Path Data="M 0 8 L 8 0 L 8 5 L 16 5 L 16 11 L 8 11 L 8 16 Z" Fill="{DynamicResource IconTertiaryFillBrush}" Stroke="Transparent" StrokeThickness="0" HorizontalAlignment="Right" VerticalAlignment="Center" Effect="{DynamicResource IconInnerShadow}"/>
    </Grid>

    <Grid x:Key="CopyToButtonLargeIcon" Width="30" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
            <Path Data="M 0 0 L 20 4 L 20 18 L 22 20 L 22 28 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
            <Path Data="M 0 0 L 7 5 L 8 32 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
        </Grid>
        <Grid Width="30" Height="32" HorizontalAlignment="Right" VerticalAlignment="Center" RenderTransformOrigin="1,0.5" Effect="{DynamicResource IconInnerShadow}">
            <Grid.RenderTransform>
                <ScaleTransform ScaleX="0.5" ScaleY="0.5"/>
            </Grid.RenderTransform>
            <Grid HorizontalAlignment="Left" VerticalAlignment="Top">
                <Path Data="M 0 0 L 13 0 L 18 5 L 18 22 L 0 22 Z" StrokeThickness="0" Fill="{DynamicResource IconTertiaryFillBrush}"/>
                <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconTertiaryFillBrush}" Effect="{DynamicResource IconStrongOuterShadow}"/>
            </Grid>
            <Grid HorizontalAlignment="Right" VerticalAlignment="Bottom" Effect="{DynamicResource IconInnerShadow}">
                <Path Data="M 0 0 L 13 0 L 18 5 L 18 22 L 0 22 Z" StrokeThickness="0" Fill="{DynamicResource IconTertiaryFillBrush}"/>
                <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconTertiaryFillBrush}" Effect="{DynamicResource IconStrongOuterShadow}"/>
            </Grid>
        </Grid>
    </Grid>

    <!--Grid x:Key="DeleteButtonLargeIcon" Width="28" Height="28" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Background="{DynamicResource IconRedForegroundBrush}" Effect="{DynamicResource IconOuterShadow}"-->
    <Grid x:Key="DeleteButtonLargeIcon" Width="32" Height="32">
        <Path Data="M 0 0 L 24 24 M 0 24 L 24 0" UseLayoutRounding="True" StrokeThickness="4" Stroke="{DynamicResource IconRedForegroundBrush}" Effect="{DynamicResource IconOuterShadow}"  HorizontalAlignment="Center" VerticalAlignment="Center"/>
    </Grid>

    <Grid x:Key="RenameButtonLargeIcon" Width="32" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Border Height="12" BorderBrush="{DynamicResource IconPrimaryFillBrush}" Background="{DynamicResource IconForegroundBrush}" BorderThickness="3,3,13,3" CornerRadius="0" Effect="{DynamicResource IconOuterShadow}"/>
        <Canvas Width="12" Height="24" Background="{DynamicResource IconSecondaryFillBrush}" HorizontalAlignment="Right" Margin="3,0" Effect="{DynamicResource IconInnerShadow}">
            <Canvas.OpacityMask>
                <VisualBrush>
                    <VisualBrush.Visual>
                        <Border Width="12" Height="24" Background="Transparent" BorderBrush="Black" BorderThickness="0,2">
                            <Canvas Width="2" Background="Black"/>
                        </Border>
                    </VisualBrush.Visual>
                </VisualBrush>
            </Canvas.OpacityMask>
        </Canvas>
    </Grid>

    <Grid x:Key="NewFolderButtonLargeIcon" Width="30" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
            <Path Data="M 0 0 L 20 4 L 20 18 L 22 20 L 22 28 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
            <Path Data="M 0 0 L 7 5 L 8 32 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconGreenForegroundBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
        </Grid>
    </Grid>

    <Grid x:Key="NewItemButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid>
            <Border HorizontalAlignment="Left" VerticalAlignment="Top" Width="12" Height="10" Background="{DynamicResource IconPrimaryFillBrush}" BorderBrush="{DynamicResource IconTertiaryFillBrush}" BorderThickness="0,3,0,0" CornerRadius="2" Effect="{DynamicResource IconOuterShadow}"/>
            <Border HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="10" Height="12" Background="{DynamicResource IconGreenForegroundBrush}" BorderThickness="0" CornerRadius="0,3,0,0" Effect="{DynamicResource IconOuterShadow}"/>
        </Grid>
    </Grid>

    <Grid x:Key="EasyAccessButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Canvas UseLayoutRounding="True" Effect="{DynamicResource IconOuterShadow}">
            <Border HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="13" Height="16" Background="{DynamicResource IconSecondaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="0" CornerRadius="0,3,0,0" Canvas.Left="3"/>
            <Rectangle Fill="{DynamicResource IconForegroundBrush}" Width="6" Height="1" Canvas.Top="3" Canvas.Left="4"/>
            <Rectangle Fill="{DynamicResource IconForegroundBrush}" Width="6" Height="1" Canvas.Top="5" Canvas.Left="2"/>
            <Rectangle Fill="{DynamicResource IconForegroundBrush}" Width="6" Height="1" Canvas.Top="7" Canvas.Left="0"/>
        </Canvas>
    </Grid>

    <Grid x:Key="PropertiesButtonLargeIcon" Width="32" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid Width="30" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="#01000000">
            <Grid HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 0 L 15 0 L 20 5 L 20 24 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}"/>
                <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconInnerShadow}"/>
            </Grid>
            <Path Data="M 0 11 L 2 9 L 7 13 L 15 0 L 17 2 L 8 18 Z" Fill="{DynamicResource SelectedHighlightBrush}" Effect="{DynamicResource IconOuterShadow}" UseLayoutRounding="True" Margin="4,8,-4,-8"/>
        </Grid>
    </Grid>

    <Grid x:Key="EditButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Canvas UseLayoutRounding="True" Effect="{DynamicResource IconOuterShadow}">
            <Border HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="13" Height="16" Background="{DynamicResource IconSecondaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="0" CornerRadius="0,3,0,0" Canvas.Left="2"/>
            <!--Rectangle Fill="{DynamicResource IconForegroundBrush}" Width="6" Height="1" Canvas.Top="3" Canvas.Left="4"/>
            <Rectangle Fill="{DynamicResource IconForegroundBrush}" Width="6" Height="1" Canvas.Top="5" Canvas.Left="2"/>
            <Rectangle Fill="{DynamicResource IconForegroundBrush}" Width="6" Height="1" Canvas.Top="7" Canvas.Left="0"/-->
            <Path Data="M 8 0 L 0 8 L 0 9 L 1 9 L 9 1 Z" Fill="{DynamicResource IconForegroundBrush}" Canvas.Left="6" Canvas.Top="4"/>
        </Canvas>
    </Grid>

    <Grid x:Key="HistoryButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid>
            <!--Border HorizontalAlignment="Left" VerticalAlignment="Top" Width="12" Height="10" Background="{DynamicResource IconPrimaryFillBrush}" BorderBrush="{DynamicResource IconTertiaryFillBrush}" BorderThickness="0,3,0,0" CornerRadius="2" Effect="{DynamicResource IconOuterShadow}"/-->
            <Border HorizontalAlignment="Left" VerticalAlignment="Top" Width="10" Height="12" Background="{DynamicResource IconSecondaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="0" CornerRadius="0,3,0,0" Effect="{DynamicResource IconOuterShadow}"/>
            <Grid HorizontalAlignment="Right" VerticalAlignment="Bottom">
                <Ellipse Width="12" Height="12" Fill="{DynamicResource IconTertiaryFillBrush}" Stroke="{DynamicResource IconPrimaryFillBrush}" StrokeThickness="1"/>
                <Border Width="4" Height="3" BorderBrush="{DynamicResource IconForegroundBrush}" BorderThickness="1,0,0,1" Margin="0,3,2,0" HorizontalAlignment="Right" VerticalAlignment="Top"/>
            </Grid>
        </Grid>
    </Grid>

    <Grid x:Key="SelectAllButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource IconOuterShadow}">
        <UniformGrid Rows="2" Columns="2">
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="1"/>
        </UniformGrid>
    </Grid>

    <Grid x:Key="SelectNoneButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource IconOuterShadow}">
        <UniformGrid Rows="2" Columns="2">
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="Transparent" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="Transparent" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="Transparent" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="Transparent" BorderThickness="1"/>
        </UniformGrid>
    </Grid>

    <Grid x:Key="InvertSelectionButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource IconOuterShadow}">
        <UniformGrid Rows="2" Columns="2">
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="Transparent" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryFillBrush}" BorderThickness="1"/>
            <Border Background="{DynamicResource IconTertiaryFillBrush}" BorderBrush="Transparent" BorderThickness="1"/>
        </UniformGrid>
    </Grid>

    <!--#endregion Main Ribbon Icons-->


    <!--#region Ribbon ApplicationMenu Icons-->

    <Grid x:Key="NewWindowMenuItemIcon" Width="30" Height="25" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource IconOuterShadow}" Margin="1,3,1,4">
        <Border Background="{DynamicResource WindowBackgroundBrush}" BorderBrush="{DynamicResource WindowBorderBrush}" BorderThickness="1" CornerRadius="2">
            <DockPanel>
                <Border BorderBrush="{DynamicResource TitlebarBorderBrush}" BorderThickness="1" CornerRadius="1,1,0,0" Height="6" DockPanel.Dock="Top">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource TitlebarActiveGradientStops}"/>
                    </Border.Background>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Height="1">
                        <Rectangle Fill="{DynamicResource TitlebarIdleForegroundBrush}" Width="1" Margin="1,0,0,0"/>
                        <Rectangle Fill="{DynamicResource TitlebarIdleForegroundBrush}" Width="1" Margin="1,0,0,0"/>
                        <Rectangle Fill="{DynamicResource TitlebarIdleForegroundBrush}" Width="1" Margin="1,0,0,0"/>
                    </StackPanel>
                </Border>
                <Grid>
                    <Rectangle Margin="5,0" Fill="{DynamicResource HorizontalPanelBorderBrush}" Width="1" HorizontalAlignment="Left" VerticalAlignment="Stretch"/>
                    <Rectangle Margin="7,0" Fill="{DynamicResource HorizontalPanelBorderBrush}" Width="1" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                </Grid>
            </DockPanel>
        </Border>
    </Grid>

    <Grid x:Key="CommandPromptMenuItemIcon" Width="30" Height="25" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource IconOuterShadow}" Margin="1,3,1,4">
        <Border Background="{DynamicResource WindowBackgroundBrush}" BorderBrush="{DynamicResource WindowBorderBrush}" BorderThickness="1" CornerRadius="2">
            <DockPanel>
                <Border BorderBrush="{DynamicResource TitlebarBorderBrush}" BorderThickness="1" CornerRadius="1,1,0,0" Height="6" DockPanel.Dock="Top">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource TitlebarActiveGradientStops}"/>
                    </Border.Background>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Height="1">
                        <Rectangle Fill="{DynamicResource TitlebarIdleForegroundBrush}" Width="1" Margin="1,0,0,0"/>
                        <Rectangle Fill="{DynamicResource TitlebarIdleForegroundBrush}" Width="1" Margin="1,0,0,0"/>
                        <Rectangle Fill="{DynamicResource TitlebarIdleForegroundBrush}" Width="1" Margin="1,0,0,0"/>
                    </StackPanel>
                </Border>
                <Grid Background="Black">
                    <TextBlock Text="C:\&gt;" FontSize="8" Foreground="White" HorizontalAlignment="Left" TextAlignment="Left" VerticalAlignment="Top" Margin="1"/>
                </Grid>
            </DockPanel>
        </Border>
    </Grid>

    <Grid x:Key="PowerShellMenuItemIcon" Width="30" Height="22" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="1,5">
        <Rectangle Width="10" HorizontalAlignment="Left" VerticalAlignment="Stretch" Margin="0,2">
            <Rectangle.Effect>
                <BlurEffect Radius="2"/>
            </Rectangle.Effect>
            <Rectangle.Fill>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource TitlebarActiveGradientStops}"/>
            </Rectangle.Fill>
            <Rectangle.OpacityMask>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Offset="0" Color="Transparent"/>
                    <GradientStop Offset="1" Color="Black"/>
                </LinearGradientBrush>
            </Rectangle.OpacityMask>
        </Rectangle>
        <Grid Margin="5,0,0,0" UseLayoutRounding="True" Effect="{DynamicResource IconOuterShadow}">
            <Border BorderBrush="{DynamicResource TitlebarBorderBrush}" BorderThickness="1" CornerRadius="2" RenderTransformOrigin="0.5,0.5">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource TitlebarActiveGradientStops}"/>
                </Border.Background>
                <Border.RenderTransform>
                    <SkewTransform AngleX="-11.25"/>
                </Border.RenderTransform>
            </Border>
            <TextBlock Text="&gt;_" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center" TextAlignment="Center" VerticalAlignment="Center" Margin="1"/>
        </Grid>
    </Grid>

    <Grid x:Key="DeleteHistoryMenuItemIcon" Width="28" Height="28" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2" UseLayoutRounding="True" Effect="{DynamicResource IconOuterShadow}">
        <Ellipse Fill="{DynamicResource IconTertiaryFillBrush}" Stroke="{DynamicResource IconPrimaryFillBrush}" StrokeThickness="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
        <Border Width="9" Height="11" BorderBrush="{DynamicResource IconForegroundBrush}" BorderThickness="1,0,0,1" Margin="0,4,6,0" HorizontalAlignment="Right" VerticalAlignment="Top"/>
        <Path Data="M 1 1 L 13 13 M 1 13 L 13 1" UseLayoutRounding="True" StrokeThickness="1" Stroke="{DynamicResource IconRedForegroundBrush}" Effect="{DynamicResource IconOuterShadow}"  HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="1"/>
    </Grid>

        <!--#endregion Ribbon ApplicationMenu Icons-->


    <!--#region Navigation Bar Styles-->

    <Style x:Key="NavigationBarBackgroundStyle" TargetType="{x:Type ContentControl}">
        <Setter Property="Height" Value="50"/>
        <Setter Property="Padding" Value="6"/>
        <Setter Property="Margin" Value="0,0,0,-5"/>
        <Setter Property="Panel.ZIndex" Value="9999"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ContentControl}">
                    <Grid>
                        <Rectangle VerticalAlignment="Top" Height="18" IsHitTestVisible="False" Grid.Column="0">
                            <Rectangle.Fill>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ShadowGradientStops}"/>
                            </Rectangle.Fill>
                        </Rectangle>
                        <Border CornerRadius="3" UseLayoutRounding="True" Margin="5" Effect="{DynamicResource TertiaryDropShadow}">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,0.75" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                            </Border.Background>
                            <ContentPresenter Content="{TemplateBinding Content}" Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </Grid>
                    <!--ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding IsMinimized, ElementName=Ribbon}" Value="True">
                            <Setter TargetName="ShadowRectangle" Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                    </ControlTemplate.Triggers-->
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="NavigationButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource CaptionButtonStyle}">
        <Setter Property="Foreground" Value="{DynamicResource ButtonForegroundBrush}"/>
        <Setter Property="Height" Value="Auto"/>
        <Setter Property="Margin" Value="0"/>
        <Style.Triggers>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsActive, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type win:DecoratableWindow}}, FallbackValue=True}" Value="False"/>
                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Mode=Self}, FallbackValue=False}" Value="False"/>
                </MultiDataTrigger.Conditions>
                <Setter Property="Foreground" Value="{DynamicResource ButtonForegroundBrush}"/>
            </MultiDataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="NavigationBackButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource NavigationButtonStyle}">
        <Setter Property="Content">
            <Setter.Value>
                <Path HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 6 0 L 0 6 L 6 12" Stroke="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Button}}}" StrokeThickness="2"/>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="SmallNavigationButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource NavigationButtonStyle}">
    </Style>

    <Style x:Key="NavigationHistoryButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource NavigationButtonStyle}">
        <Setter Property="Width" Value="16"/>
        <Setter Property="Margin" Value="0,0,8,0"/>
        <Setter Property="Content">
            <Setter.Value>
                <Path HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 0 L 3 3 L 6 0 Z" Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Button}}}"/>
                <!--M 0 0 L 6 6 L 12 0-->
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="NavigationUpButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource NavigationButtonStyle}">
        <Setter Property="Content">
            <Setter.Value>
                <Path HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 6 L 6 0 L 12 6" Stroke="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Button}}}" StrokeThickness="2"/>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="NavigationSearchBoxStyle" TargetType="{x:Type TextBox}" BasedOn="{StaticResource {x:Type TextBox}}">
        <Setter Property="Margin" Value="5,0,0,0"/>
    </Style>

    <Style x:Key="NavigationAddressBoxStyle" TargetType="{x:Type TextBox}" BasedOn="{StaticResource NavigationSearchBoxStyle}"/>

    <Style x:Key="NavigationForwardButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource NavigationButtonStyle}">
        <Setter Property="Content">
            <Setter.Value>
                <Path HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 0 L 6 6 L 0 12" Stroke="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Button}}}" StrokeThickness="2"/>
            </Setter.Value>
        </Setter>
    </Style>

    <!--#endregion Navigation Bar Styles-->
    

    <!--#region Main Content Styles-->

    <Style x:Key="ToolbarBackgroundContentControlStyle" TargetType="ContentControl">
        <Setter Property="Panel.ZIndex" Value="9999"/>
    </Style>

    <Style x:Key="CurrentDirectoryListViewStyle" TargetType="{x:Type ListView}">
        <Setter Property="Panel.ZIndex" Value="-100"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="GridView.AllowsColumnReorder" Value="True"/>
        <Setter Property="Foreground" Value="{DynamicResource TextBoxForegroundBrush}"/>
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="{x:Type ListViewItem}" BasedOn="{StaticResource {x:Type ListViewItem}}">
                    <!--Setter Property="ContextMenu" Value="{DynamicResource ItemContextMenu}"/-->
                    <Setter Property="tic:AttachedProperties.CornerCurves">
                        <Setter.Value>
                            <tic:CornerCurves TopLeft="True" TopRight="True" BottomRight="True" BottomLeft="True"/>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Style.Resources>
            <!--Style x:Key="CurrentDirItemStyle" TargetType="{x:Type ListViewItem}" BasedOn="{StaticResource CurrentDirectoryListViewItemStyle}"/-->
        </Style.Resources>
        <Style.Triggers>
            <DataTrigger Binding="{Binding CurrentView, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Value="Icons">
                <Setter Property="ItemTemplate">
                    <Setter.Value>
                        <DataTemplate DataType="{x:Type disk:DiskItem}">
                            <DataTemplate.Resources>
                                <!--Style x:Key="{x:Type TextBlock}" TargetType="{x:Type TextBlock}">
                                    <Setter Property="Foreground" Value="{DynamicResource TextBoxForegroundBrush}"/>
                                </Style-->
                            </DataTemplate.Resources>
                            <StackPanel x:Name="RootStackPanel" Orientation="Vertical" Tag="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}">
                                <e:Interaction.Behaviors>
                                    <mgrbase:ClickToOpenBehavior x:Name="ClickToOpen" ManagerBase="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" ParentListViewItem="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListViewItem}}"/>
                                </e:Interaction.Behaviors>
                                <StackPanel.ContextMenu>
                                    <ContextMenu x:Name="ItemContextMenu">
                                        <e:Interaction.Behaviors>
                                            <mgrbase:ItemContextMenuBehavior ManagerBase="{Binding ManagerBase, Source={x:Reference ClickToOpen}}" OpenMenuItem="{Binding Source={x:Reference Name=OpenMenuItem}}" RunAsAdminMenuItem="{Binding Source={x:Reference Name=RunAsAdminMenuItem}}" CopyMenuItem="{Binding Source={x:Reference Name=CopyMenuItem}}" CutMenuItem="{Binding Source={x:Reference Name=CutMenuItem}}" RenameMenuItem="{Binding Source={x:Reference Name=RenameMenuItem}}" RenameTextBox="{Binding Source={x:Reference Name=RenameTextBox}}" PropertiesMenuItem="{Binding Source={x:Reference Name=PropertiesMenuItem}}" TargetItem="{Binding}"/>
                                        </e:Interaction.Behaviors>
                                        <!-- Opened="TouchableContextMenu_Opened"-->
                                        <MenuItem x:Name="OpenMenuItem" Header="Open"/>
                                        <!--Click="OpenMenuItem_Click"-->
                                        <!--Tag="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListViewItem}}}"-->
                                        <MenuItem x:Name="RunAsAdminMenuItem" Header="Run as administrator"/>
                                        <!-- Click="RunAsAdminMenuItem_Click"-->
                                        <Separator/>
                                        <MenuItem x:Name="CopyMenuItem" Header="Copy"/>
                                        <!-- Click="CopyMenuItem_Click"-->
                                        <MenuItem x:Name="CutMenuItem" Header="Cut"/>
                                        <!-- Click="CutMenuItem_Click"-->
                                        <Separator/>
                                        <MenuItem x:Name="DeleteMenuItem" Header="Delet"/>
                                        <!-- Click="DeleteMenuItem_Click"-->
                                        <MenuItem x:Name="RenameMenuItem" Header="Rename"/>
                                        <Separator/>
                                        <MenuItem x:Name="PropertiesMenuItem" Header="Properties"/>
                                        <!-- Click="PropertiesMenuItem_Click"-->
                                    </ContextMenu>
                                </StackPanel.ContextMenu>
                                <!--Width="52" MinHeight="52"-->
                                <!--StackPanel.ContextMenu>
                            <ui:TouchableContextMenu>
                                <MenuItem Header="Open"/>
                                <MenuItem Header="Properties"/>
                            </ui:TouchableContextMenu>
                        </StackPanel.ContextMenu-->
                                <Rectangle HorizontalAlignment="Center" Width="{Binding IconSize, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Height="{Binding IconSize, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Fill="{Binding ItemExtraLargeIcon, Converter={StaticResource IconToImageBrushConverter}, ConverterParameter='48'}" UseLayoutRounding="True" SnapsToDevicePixels="True" RenderOptions.EdgeMode="Aliased"/>
                                <!--Width="48" Height="48"-->
                                <Grid Width="{Binding IconSize, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}">
                                    <Grid>
                                        <TextBlock Text="{Binding ItemDisplayName}" HorizontalAlignment="Stretch" TextAlignment="Center" TextBlock.Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" TextWrapping="Wrap" MaxHeight="44"/>
                                        <TextBox x:Name="RenameTextBox" Visibility="Collapsed" HorizontalAlignment="Stretch" MaxWidth="{Binding IconSize, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}">
                                            <e:Interaction.Behaviors>
                                                <mgrbase:ItemRenameBehavior TargetItem="{Binding}" ManagerBase="{Binding ManagerBase, Source={x:Reference ClickToOpen}}" IsRenaming="{Binding IsRenamingFiles, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}"/>
                                            </e:Interaction.Behaviors>
                                        </TextBox>
                                    </Grid>
                                </Grid>
                            </StackPanel>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                <WrapPanel IsItemsHost="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{TemplateBinding Background}" KeyboardNavigation.DirectionalNavigation="Local"/>
                            </ScrollViewer>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding CurrentView, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Value="Details">
                <!--Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                <StackPanel IsItemsHost="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{TemplateBinding Background}" Orientation="Vertical" KeyboardNavigation.DirectionalNavigation="Local"/>
                            </ScrollViewer>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter-->
                <Setter Property="View">
                    <Setter.Value>
                        <GridView>
                            <GridViewColumn Header="Name" Width="160" DisplayMemberBinding="{Binding ItemDisplayName}"/>
                            <GridViewColumn Header="Type" Width="120" DisplayMemberBinding="{Binding ItemCategory}"/>
                            <GridViewColumn Header="Size" Width="80" DisplayMemberBinding="{Binding FriendlyItemSize}"/>
                        </GridView>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding CurrentView, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Value="Tiles">
                <Setter Property="ItemTemplate">
                    <Setter.Value>
                        <DataTemplate DataType="{x:Type disk:DiskItem}">
                            <DockPanel Width="240" Height="42">
                                <Rectangle HorizontalAlignment="Center" Width="32" Height="32" Fill="{Binding ItemExtraLargeIcon, Converter={StaticResource IconToImageBrushConverter}, ConverterParameter='32'}" UseLayoutRounding="True" SnapsToDevicePixels="True" RenderOptions.EdgeMode="Aliased" DockPanel.Dock="Left"/>
                                <TextBlock Text="{Binding ItemDisplayName}" HorizontalAlignment="Left" VerticalAlignment="Center" TextAlignment="Left" TextBlock.Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                            </DockPanel>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                <WrapPanel IsItemsHost="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{TemplateBinding Background}" KeyboardNavigation.DirectionalNavigation="Local"/>
                            </ScrollViewer>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding CurrentView, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Value="List">
                <Setter Property="ItemTemplate">
                    <Setter.Value>
                        <DataTemplate DataType="{x:Type disk:DiskItem}">
                            <StackPanel Orientation="Horizontal" Height="16">
                                <!--StackPanel.ContextMenu>
                                    <ui:TouchableContextMenu>
                                        <MenuItem Header="Open"/>
                                        <MenuItem Header="Properties"/>
                                    </ui:TouchableContextMenu>
                                </StackPanel.ContextMenu-->
                                <Rectangle HorizontalAlignment="Center" Width="16" Height="16" Fill="{Binding ItemSmallIcon, Converter={StaticResource IconToImageBrushConverter}, ConverterParameter='16'}" UseLayoutRounding="True" SnapsToDevicePixels="True" RenderOptions.EdgeMode="Aliased"/>
                                <TextBlock Text="{Binding ItemDisplayName}" HorizontalAlignment="Left" TextAlignment="Center" TextBlock.Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" Margin="5,0,0,0"/>
                            </StackPanel>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                                <WrapPanel IsItemsHost="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{TemplateBinding Background}" Orientation="Vertical" KeyboardNavigation.DirectionalNavigation="Local"/>
                            </ScrollViewer>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding CurrentView, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Value="Content">
                <Setter Property="ItemTemplate">
                    <Setter.Value>
                        <DataTemplate DataType="{x:Type disk:DiskItem}">
                            <Grid Height="32">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="32"/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="192"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <!--Grid.ContextMenu>
                                    <ui:TouchableContextMenu>
                                        <MenuItem Header="Open"/>
                                        <MenuItem Header="Properties"/>
                                    </ui:TouchableContextMenu>
                                </Grid.ContextMenu-->
                                <Rectangle HorizontalAlignment="Center" Width="32" Height="32" Fill="{Binding ItemLargeIcon, Converter={StaticResource IconToImageBrushConverter}, ConverterParameter='32'}" UseLayoutRounding="True" SnapsToDevicePixels="True" RenderOptions.EdgeMode="Aliased" Grid.Column="0" Grid.Row="0" Grid.RowSpan="2"/>
                                <TextBlock Text="{Binding ItemDisplayName}" HorizontalAlignment="Left" TextAlignment="Center" TextBlock.Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" TextWrapping="Wrap" Grid.Column="1" Grid.Row="0"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Grid.Column="1" Grid.Row="1">
                                    <TextBlock Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" Opacity="0.5" Margin="0,0,5,0">Type:</TextBlock>
                                    <TextBlock Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" Text="{Binding FriendlyItemType}"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Grid.Column="2" Grid.Row="0">
                                    <TextBlock Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" Opacity="0.5" Margin="0,0,5,0">Date modified:</TextBlock>
                                    <TextBlock Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" Text="NYI"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Grid.Column="2" Grid.Row="1">
                                    <TextBlock Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" Opacity="0.5" Margin="0,0,5,0">Size:</TextBlock>
                                    <TextBlock Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}" Text="{Binding FriendlyItemSize}"/>
                                </StackPanel>
                            </Grid>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                <StackPanel IsItemsHost="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{TemplateBinding Background}" Orientation="Vertical" KeyboardNavigation.DirectionalNavigation="Local"/>
                            </ScrollViewer>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <ControlTemplate x:Key="CurrentDirectoryListViewItemControlTemplate" TargetType="{x:Type ListViewItem}">
        <Grid>
            <Border x:Name="HoverBackground" CornerRadius="{Binding Path=(tic:AttachedProperties.CornerCurves), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource CornerCurvesToCornerRadiusConverter}, ConverterParameter='3,3,3,3;0,0,0,0'}" Margin="0" Padding="0" BorderBrush="{DynamicResource ButtonHoverBorderBrush}" BorderThickness="1" Opacity="0">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonHoverBackgroundGradientStops}"/>
                </Border.Background>
                <Border x:Name="HoverInnerBackground" CornerRadius="{Binding Path=(tic:AttachedProperties.CornerCurves), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource CornerCurvesToCornerRadiusConverter}, ConverterParameter='2,2,2,2;0,0,0,0'}" Margin="1" Padding="0" BorderBrush="Transparent" BorderThickness="0">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonHoverSecondaryBackgroundGradientStops}"/>
                    </Border.Background>
                </Border>
            </Border>
            <Border x:Name="SelectedBackground" CornerRadius="{Binding CornerRadius, ElementName=HoverBackground}" Margin="0" Padding="0" BorderBrush="{DynamicResource ButtonPressedBorderBrush}" BorderThickness="1" Opacity="0">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonPressedBackgroundGradientStops}"/>
                </Border.Background>
                <Border CornerRadius="{Binding CornerRadius, ElementName=HoverInnerBackground}" Margin="1" Padding="0" BorderBrush="Transparent" BorderThickness="0">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource ButtonPressedSecondaryBackgroundGradientStops}"/>
                    </Border.Background>
                </Border>
            </Border>
            <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Margin="{TemplateBinding Padding}">
                <ContentPresenter x:Name="PART_ContentPresenter" Margin="0" Visibility="Hidden"/>
                <DockPanel>
                    <Grid x:Name="SelectorCheckBoxGrid" VerticalAlignment="Top">
                        <CheckBox x:Name="SelectorCheckBox" IsThreeState="False" IsChecked="{Binding Path=IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}}" Visibility="Collapsed" DockPanel.Dock="Left"/>
                    </Grid>
                    <GridViewRowPresenter x:Name="PART_GridViewRowPesenter" Visibility="Visible" />
                </DockPanel>
            </Grid>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="GridView.ColumnCollection" Value="{x:Null}">
                <Setter TargetName="PART_ContentPresenter" Property="Visibility" Value="Visible"/>
                <Setter TargetName="PART_GridViewRowPesenter" Property="Visibility" Value="Collapsed"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Trigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.ExitActions>
            </Trigger>
            <Trigger Property="IsSelected" Value="True">
                <Trigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.ExitActions>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <Style x:Key="FavoritesTreeViewStyle" TargetType="{x:Type TreeView}" BasedOn="{StaticResource {x:Type TreeView}}">
        <Setter Property="Margin" Value="0,5,0,0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TreeView}">
                    <Grid>
                        <Border CornerRadius="3,4,4,3" UseLayoutRounding="True" Margin="5" Effect="{DynamicResource TertiaryDropShadow}">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,0.75" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                            </Border.Background>
                            <ScrollViewer Focusable="False" CanContentScroll="False">
                                <ItemsPresenter />
                            </ScrollViewer>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="FavoritesTreeViewFavoritesItemStyle" TargetType="{x:Type TreeViewItem}" BasedOn="{StaticResource {x:Type TreeViewItem}}"/>

    <LinearGradientBrush x:Key="EmblemPathFillBrush" StartPoint="0,0" EndPoint="0,1" GradientStops="{DynamicResource DarkIconGradientStops}"/>

    <Style x:Key="FavoritesItemHeaderStyle" TargetType="{x:Type Control}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Control}">
                    <StackPanel Orientation="Horizontal" Height="16" ClipToBounds="False">
                        <ContentControl>
                            <ContentControl.Effect>
                                <DropShadowEffect Color="Black" Direction="320" ShadowDepth="3" BlurRadius="10" Opacity="0.5" />
                            </ContentControl.Effect>
                            <Path Data="M 3 16 L 8 12 L 13 16 L 11 9 L 16 6 L 10 6 L 8 0 L 6 6 L 0 6 L 5 9" Fill="{DynamicResource EmblemPathFillBrush}" Stroke="{DynamicResource EmblemPathStrokeBrush}" StrokeThickness="1" Effect="{DynamicResource DropShadow}" UseLayoutRounding="True"/>
                            <!--RenderOptions.EdgeMode="Aliased"-->
                            <!--ContentPresenter Content="{TemplateBinding Content}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="10,0,0,0"/-->
                        </ContentControl>
                        <TextBlock Margin="5,0,0,0">Favorites</TextBlock>
                    </StackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ComputerItemHeaderStyle" TargetType="{x:Type Control}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Control}">
                    <StackPanel Orientation="Horizontal" Height="16" ClipToBounds="False">
                        <!--Path Data="M 3 16 L 8 12 L 13 16 L 11 9 L 16 6 L 10 6 L 8 0 L 6 6 L 0 6 L 5 9" Fill="{DynamicResource EmblemPathFillBrush}" Stroke="{DynamicResource EmblemPathStrokeBrush}" StrokeThickness="1" UseLayoutRounding="True">
                            <Path.Effect>
                                <DropShadowEffect Color="Black" Direction="320" ShadowDepth="3" BlurRadius="10" Opacity="0.5" />
                            </Path.Effect>
                        </Path-->
                        <Grid Width="16" Height="16">
                            <Grid.Effect>
                                <DropShadowEffect Color="Black" Direction="320" ShadowDepth="3" BlurRadius="10" Opacity="0.5" />
                            </Grid.Effect>
                            <Rectangle Width="4" Height="14" VerticalAlignment="Center" Fill="{DynamicResource EmblemPathFillBrush}" Stroke="{DynamicResource EmblemPathStrokeBrush}" StrokeThickness="1" UseLayoutRounding="True"/>
                            <Rectangle Width="4" Height="14" VerticalAlignment="Center" Fill="#36000000" StrokeThickness="0" UseLayoutRounding="True"/>
                            <Rectangle Height="10" VerticalAlignment="Top" Fill="{DynamicResource EmblemPathFillBrush}" Stroke="{DynamicResource EmblemPathStrokeBrush}" StrokeThickness="1" UseLayoutRounding="True"/>
                            <!--Rectangle.Effect>
                                    <DropShadowEffect Color="Black" Direction="320" ShadowDepth="3" BlurRadius="10" Opacity="0.125" />
                                </Rectangle.Effect>
                            </Rectangle-->
                            <Rectangle Height="3" VerticalAlignment="Bottom" Fill="{DynamicResource EmblemPathFillBrush}" Stroke="{DynamicResource EmblemPathStrokeBrush}" StrokeThickness="1" UseLayoutRounding="True"/>
                            <Rectangle Height="3" VerticalAlignment="Bottom" Fill="#26000000" StrokeThickness="0" UseLayoutRounding="True"/>
                        </Grid>
                        <!--ContentPresenter Content="{TemplateBinding Content}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="10,0,0,0"/-->
                        <TextBlock Margin="5,0,0,0">This PC</TextBlock>
                    </StackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <HierarchicalDataTemplate x:Key="NavigationPaneDataTemplate" DataType="{x:Type disk:DiskItem}">
        <StackPanel Orientation="Horizontal" Height="16">
            <Rectangle VerticalAlignment="Center" Width="16" Height="16" Fill="{Binding ItemSmallIcon, Converter={StaticResource IconToImageBrushConverter}, ConverterParameter='16'}" SnapsToDevicePixels="True" UseLayoutRounding="True" RenderOptions.EdgeMode="Aliased"/>
            <ContentPresenter Content="{Binding ItemDisplayName}" RecognizesAccessKey="True" TextBlock.Foreground="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type TreeViewItem}}}" Margin="5,0,0,0">
                <ContentPresenter.Resources>
                    <Style TargetType="{x:Type TextBlock}">
                        <Setter Property="TextWrapping" Value="WrapWithOverflow"/>
                    </Style>
                </ContentPresenter.Resources>
            </ContentPresenter>
        </StackPanel>
    </HierarchicalDataTemplate>

    <!--ControlTemplate x:Key="CurrentDirectoryListViewItemControlTemplate" TargetType="{x:Type ListViewItem}">
        <ControlTemplate.Resources>
            <CubicEase x:Key="ScalingEase" EasingMode="EaseOut"/>
        </ControlTemplate.Resources>
        <Grid x:Name="RootGrid" Margin="5" Background="#01000000" Effect="{DynamicResource TertiaryDropShadow}">
            <Grid RenderTransformOrigin="0.5,0.5" UseLayoutRounding="True">
                <Border x:Name="SizingAid" Background="#01000000"/>
                <Border x:Name="BackgroundBorder" BorderBrush="Transparent" BorderThickness="0" CornerRadius="3" ClipToBounds="True" UseLayoutRounding="True">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,0.75" GradientStops="{DynamicResource ButtonIdleBackgroundGradientStops}"/>
                    </Border.Background>
                    <Grid>
                        <Grid>
                            <Border x:Name="SelectedBorder" BorderBrush="Transparent" BorderThickness="0" CornerRadius="3" ClipToBounds="True" UseLayoutRounding="True" Opacity="0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,0.75" GradientStops="{DynamicResource CardListViewSelectedBackgroundGradientStops}"/>
                                </Border.Background>
                            </Border>
                            <Border x:Name="RootBorder" Padding="0">
                                <Grid Background="{TemplateBinding Background}" Margin="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                    <ContentPresenter x:Name="PART_ContentPresenter" Margin="0" Visibility="Hidden"/>
                                    <DockPanel>
                                        <Grid x:Name="SelectorCheckBoxGrid" VerticalAlignment="Top">
                                            <CheckBox x:Name="SelectorCheckBox" IsThreeState="False" IsChecked="{Binding Path=IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}}" Visibility="Collapsed" DockPanel.Dock="Left"/>
                                        </Grid>
                                        <GridViewRowPresenter x:Name="PART_GridViewRowPesenter" Visibility="Visible" />
                                    </DockPanel>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="GridView.ColumnCollection" Value="{x:Null}">
                <Setter TargetName="PART_ContentPresenter" Property="Visibility" Value="Visible"/>
                <Setter TargetName="PART_GridViewRowPesenter" Property="Visibility" Value="Hidden"/>
            </Trigger>
            <DataTrigger Binding="{Binding ShowItemCheckboxes, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Value="True">
                <Setter TargetName="SelectorCheckBox" Property="Visibility" Value="Visible"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding CurrentView, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Value="Details">
                <Setter TargetName="SelectorCheckBoxGrid" Property="VerticalAlignment" Value="Center"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding CurrentView, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type mgrbase:FileManagerBase}}}" Value="List">
                <Setter TargetName="SelectorCheckBoxGrid" Property="VerticalAlignment" Value="Center"/>
            </DataTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsMouseOver" Value="False"/>
                    <Condition Property="IsSelected" Value="False"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="SelectorCheckBoxGrid" Property="Visibility" Value="Hidden"/>
            </MultiTrigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Trigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <ThicknessAnimation Storyboard.TargetName="RootBorder" Storyboard.TargetProperty="Padding" To="5" Duration="0:0:0.125" EasingFunction="{StaticResource ScalingEase}"/>
                            <ThicknessAnimation Storyboard.TargetName="RootGrid" Storyboard.TargetProperty="Margin" To="0" Duration="0:0:0.125" EasingFunction="{StaticResource ScalingEase}"/>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <ThicknessAnimation Storyboard.TargetName="RootBorder" Storyboard.TargetProperty="Padding" To="0" Duration="0:0:0.125" EasingFunction="{StaticResource ScalingEase}"/>
                            <ThicknessAnimation Storyboard.TargetName="RootGrid" Storyboard.TargetProperty="Margin" To="5" Duration="0:0:0.125" EasingFunction="{StaticResource ScalingEase}"/>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.ExitActions>
            </Trigger>
            <Trigger Property="IsSelected" Value="True">
                <Trigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="SelectedBorder" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" EasingFunction="{StaticResource ScalingEase}" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="SelectedBorder" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" EasingFunction="{StaticResource ScalingEase}" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.ExitActions>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate-->

    <Style x:Key="StatusBarDetailsViewToggleButtonStyle" TargetType="{x:Type ToggleButton}" BasedOn="{StaticResource {x:Type ToggleButton}}">
        <Setter Property="Width" Value="24"/>
        <!--Setter Property="Height" Value="18"/-->
        <Setter Property="VerticalAlignment" Value="Stretch"/>
        <Setter Property="Foreground" Value="Black"/>
        <Setter Property="Margin" Value="-3,-4,0,-3"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="tic:AttachedProperties.CornerCurves">
            <Setter.Value>
                <tic:CornerCurves TopLeft="False" TopRight="False" BottomRight="False" BottomLeft="False"/>
            </Setter.Value>
        </Setter>
        <Setter Property="Content">
            <Setter.Value>
                <UniformGrid Width="15" Height="15" Rows="3" Columns="3" SnapsToDevicePixels="True">
                    <Rectangle Fill="{DynamicResource IconPrimaryFillBrush}" Margin="1"/>
                    <Rectangle Height="1" VerticalAlignment="Center" Fill="{DynamicResource IconSecondaryFillBrush}"/>
                    <Rectangle Height="1" VerticalAlignment="Center" Fill="{DynamicResource IconSecondaryFillBrush}" Margin="1,0"/>
                    <Rectangle Fill="{DynamicResource IconPrimaryFillBrush}" Margin="1"/>
                    <Rectangle Height="1" VerticalAlignment="Center" Fill="{DynamicResource IconSecondaryFillBrush}"/>
                    <Rectangle Height="1" VerticalAlignment="Center" Fill="{DynamicResource IconSecondaryFillBrush}" Margin="1,0"/>
                    <Rectangle Fill="{DynamicResource IconPrimaryFillBrush}" Margin="1"/>
                    <Rectangle Height="1" VerticalAlignment="Center" Fill="{DynamicResource IconSecondaryFillBrush}" Margin="0,0,1,0"/>
                    <Rectangle Height="1" VerticalAlignment="Center" Fill="{DynamicResource IconSecondaryFillBrush}" Margin="0,0,1,0"/>
                </UniformGrid>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="StatusBarIconsViewToggleButtonStyle" TargetType="{x:Type ToggleButton}" BasedOn="{StaticResource {x:Type ToggleButton}}">
        <Setter Property="Width" Value="24"/>
        <!--Setter Property="Height" Value="18"/-->
        <Setter Property="VerticalAlignment" Value="Stretch"/>
        <Setter Property="Foreground" Value="Black"/>
        <Setter Property="Margin" Value="-1,-4,-3,-3"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="tic:AttachedProperties.CornerCurves">
            <Setter.Value>
                <tic:CornerCurves TopLeft="False" TopRight="False" BottomRight="True" BottomLeft="False"/>
            </Setter.Value>
        </Setter>
        <Setter Property="Content">
            <Setter.Value>
                <Border Width="15" Height="12" Background="{DynamicResource IconForegroundBrush}" BorderBrush="{DynamicResource IconTertiaryFillBrush}" BorderThickness="1">
                    <Path Data="M 0 0 L 5 2 L 10 3 L 12 5 L 0 5 Z" Fill="{DynamicResource IconPrimaryFillBrush}" VerticalAlignment="Bottom"/>
                </Border>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>