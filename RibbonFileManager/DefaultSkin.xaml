<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:plex="clr-namespace:Start9.Api.Plex;assembly=Start9.Api"
                    xmlns:Fluent="urn:fluent-ribbon"
                    xmlns:apictrl="clr-namespace:Start9.Api.Controls;assembly=Start9.Api"
                    xmlns:local="clr-namespace:RibbonFileManager"
                    xmlns:converters="clr-namespace:Fluent.Converters;assembly=Fluent"
                    xmlns:disk="clr-namespace:Start9.Api.DiskItems;assembly=Start9.Api">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="pack://application:,,,/Fluent;Component/Themes/Generic.xaml" />
        <ResourceDictionary Source="pack://application:,,,/Start9.Api;component/Themes/Plex.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <local:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    <local:ThicknessLeftToSubtractDoubleConverter x:Key="ThicknessLeftToSubtractDoubleConverter"/>
    <local:DoubleAdderConverter x:Key="DoubleAdderConverter"/>

    <converters:ObjectToImageConverter x:Key="ObjectToImageConverter"/>

    <SolidColorBrush x:Key="PlexRibbonForegroundBrush">#FF9CCFFF</SolidColorBrush>
    <SolidColorBrush x:Key="PlexRibbonDarkForegroundBrush">#FF003363</SolidColorBrush>

    <Style x:Key="BreadcrumbStyle" TargetType="{x:Type Fluent:SplitButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="Padding" Value="10,0" />
        <Setter Property="Foreground" Value="White" />
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="FocusVisualStyle" Value="{DynamicResource PlexFocusVisualStyle}" />
        <Setter Property="Size" Value="Middle"/>
        <Setter Property="UseLayoutRounding" Value="True"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:SplitButton}">
                    <ControlTemplate.Resources>
                        <Style BasedOn="{StaticResource MenuSeparatorStyle}" TargetType="{x:Type Separator}" />

                        <Style x:Key="{x:Type ScrollBar}" TargetType="{x:Type ScrollBar}">
                            <Setter Property="SnapsToDevicePixels" Value="True" />
                            <Setter Property="OverridesDefaultStyle" Value="true" />
                            <Style.Triggers>
                                <Trigger Property="Orientation" Value="Horizontal">
                                    <Setter Property="Width" Value="Auto" />
                                    <Setter Property="Height" Value="17" />
                                    <Setter Property="Template" Value="{StaticResource HorizontalScrollBar}" />
                                </Trigger>
                                <Trigger Property="Orientation" Value="Vertical">
                                    <Setter Property="Width" Value="17" />
                                    <Setter Property="Height" Value="Auto" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type ScrollBar}">
                                                <ControlTemplate.Resources>
                                                    <!--LinearGradientBrush x:Key="VerticalScrollbarArrowIdleFillBrush" StartPoint="0,0" EndPoint="0,1">
                                                        <LinearGradientBrush.GradientStops>
                                                            <GradientStop Offset="0.5" Color="#FFBBBEC0" />
                                                            <GradientStop Offset="1" Color="#FF9DA4AE" />
                                                        </LinearGradientBrush.GradientStops>
                                                    </LinearGradientBrush>

                                                    <LinearGradientBrush x:Key="VerticalScrollbarArrowIdleStrokeBrush" StartPoint="0.375,0" EndPoint="0.625,1">
                                                        <LinearGradientBrush.GradientStops>
                                                            <GradientStop Offset="0" Color="#FF465B76" />
                                                            <GradientStop Offset="1" Color="#FF75818F" />
                                                        </LinearGradientBrush.GradientStops>
                                                    </LinearGradientBrush>

                                                    <LinearGradientBrush x:Key="VerticalScrollbarArrowHoverFillBrush" StartPoint="0.375,0" EndPoint="0.625,1">
                                                        <LinearGradientBrush.GradientStops>
                                                            <GradientStop Offset="0.5" Color="#FFC0C3C5" />
                                                            <GradientStop Offset="1" Color="#FFACB3BD" />
                                                        </LinearGradientBrush.GradientStops>
                                                    </LinearGradientBrush>

                                                    <LinearGradientBrush x:Key="VerticalScrollbarArrowHoverStrokeBrush" StartPoint="0,0" EndPoint="0,1">
                                                        <LinearGradientBrush.GradientStops>
                                                            <GradientStop Offset="0" Color="#FF224F8B" />
                                                            <GradientStop Offset="1" Color="#FF546E8D" />
                                                        </LinearGradientBrush.GradientStops>
                                                    </LinearGradientBrush-->
                                                </ControlTemplate.Resources>
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="22" />
                                                        <RowDefinition Height="0.00001*" />
                                                        <RowDefinition Height="22" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="3" CornerRadius="0">
                                                        <Border.Background>
                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                                <LinearGradientBrush.GradientStops>
                                                                    <GradientStop Offset="0" Color="#008997B2" />
                                                                    <GradientStop Offset="0.5" Color="#7F8997B2" />
                                                                    <GradientStop Offset="1" Color="#008997B2" />
                                                                </LinearGradientBrush.GradientStops>
                                                            </LinearGradientBrush>
                                                        </Border.Background>
                                                        <Border.OpacityMask>
                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                <LinearGradientBrush.GradientStops>
                                                                    <GradientStop Offset="0.1" Color="#00000000" />
                                                                    <GradientStop Offset="0.625" Color="#7F000000" />
                                                                    <GradientStop Offset="1" Color="Black" />
                                                                </LinearGradientBrush.GradientStops>
                                                            </LinearGradientBrush>
                                                        </Border.OpacityMask>
                                                    </Border>
                                                    <RepeatButton Grid.Row="0" Style="{DynamicResource VerticalScrollBarLineUpButton}" VerticalAlignment="Stretch" Command="ScrollBar.LineUpCommand" Content="M 0 4 L 8 4 L 4 0 Z"/>
                                                    <!--RepeatButton.Style>
                                                            <Style TargetType="{x:Type RepeatButton}">
                                                                <Setter Property="SnapsToDevicePixels" Value="True" />
                                                                <Setter Property="OverridesDefaultStyle" Value="true" />
                                                                <Setter Property="Focusable" Value="false" />
                                                                <Setter Property="Template">
                                                                    <Setter.Value>
                                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                                            <Grid Margin="1,0,-1,0">
                                                                                <Border Name="IdleArrow" Margin="0" CornerRadius="0" Background="Transparent"
                                BorderBrush="Transparent" BorderThickness="0">
                                                                                    <Grid>
                                                                                        <Path Data="M 0 6 L 1 7 L 11 7 L 12 6 L 6 0 Z" HorizontalAlignment="Center" VerticalAlignment="Center" StrokeThickness="1" Fill="{DynamicResource VerticalScrollbarArrowIdleFillBrush}" Stroke="{DynamicResource VerticalScrollbarArrowIdleStrokeBrush}"/>
                                                                                    </Grid>
                                                                                </Border>
                                                                                <Border Name="HoverArrow" Margin="0" CornerRadius="0" Background="Transparent"
                                BorderBrush="Transparent" BorderThickness="0">
                                                                                    <Grid>
                                                                                        <Path Data="M 0 6 L 1 7 L 11 7 L 12 6 L 6 0 Z" HorizontalAlignment="Center" VerticalAlignment="Center" StrokeThickness="1" Fill="{DynamicResource VerticalScrollbarArrowHoverFillBrush}" Stroke="{DynamicResource VerticalScrollbarArrowHoverStrokeBrush}"/>
                                                                                    </Grid>
                                                                                </Border>
                                                                            </Grid>
                                                                            <ControlTemplate.Triggers>
                                                                                <MultiTrigger>
                                                                                    <MultiTrigger.Conditions>
                                                                                        <Condition Property="IsMouseOver" Value="True" />
                                                                                        <Condition Property="IsPressed" Value="False" />
                                                                                    </MultiTrigger.Conditions>
                                                                                    <MultiTrigger.EnterActions>
                                                                                        <BeginStoryboard>
                                                                                            <Storyboard>
                                                                                                <DoubleAnimation Storyboard.TargetName="HoverArrow"
                                                         Storyboard.TargetProperty="Opacity" To="1"
                                                         Duration="0:0:0.125" />
                                                                                            </Storyboard>
                                                                                        </BeginStoryboard>
                                                                                    </MultiTrigger.EnterActions>
                                                                                    <MultiTrigger.ExitActions>
                                                                                        <BeginStoryboard>
                                                                                            <Storyboard>
                                                                                                <DoubleAnimation Storyboard.TargetName="HoverArrow"
                                                         Storyboard.TargetProperty="Opacity" To="0"
                                                         Duration="0:0:0.125" />
                                                                                            </Storyboard>
                                                                                        </BeginStoryboard>
                                                                                    </MultiTrigger.ExitActions>
                                                                                </MultiTrigger>
                                                                            </ControlTemplate.Triggers>
                                                                        </ControlTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </Style>
                                                        </>
                                                    </RepeatButton-->
                                                    <Track Name="PART_Track" Grid.Row="1" IsDirectionReversed="true">
                                                        <Track.DecreaseRepeatButton>
                                                            <RepeatButton Style="{DynamicResource ScrollBarPageButton}" Command="ScrollBar.PageUpCommand" />
                                                        </Track.DecreaseRepeatButton>
                                                        <Track.Thumb>
                                                            <Thumb Margin="0">
                                                                <Thumb.Style>
                                                                    <Style TargetType="{x:Type Thumb}">
                                                                        <Setter Property="SnapsToDevicePixels" Value="True" />
                                                                        <Setter Property="OverridesDefaultStyle" Value="true" />
                                                                        <Setter Property="IsTabStop" Value="false" />
                                                                        <Setter Property="Focusable" Value="false" />
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="{x:Type Thumb}">
                                                                                    <Grid Margin="3,0,-1,0">
                                                                                        <Border x:Name="IdleBackground" CornerRadius="0,2,2,0" BorderThickness="1" ClipToBounds="True">
                                                                                            <Border.BorderBrush>
                                                                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                                    <LinearGradientBrush.GradientStops>
                                                                                                        <GradientStop Offset="0" Color="#FF788DA8" />
                                                                                                        <GradientStop Offset="1" Color="#FFA7B3C1" />
                                                                                                    </LinearGradientBrush.GradientStops>
                                                                                                </LinearGradientBrush>
                                                                                            </Border.BorderBrush>
                                                                                            <Border.Background>
                                                                                                <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                                                                                    <RadialGradientBrush.GradientStops>
                                                                                                        <GradientStop Offset="0" Color="#FFCFD6E0" />
                                                                                                        <GradientStop Offset="1" Color="#FFEDF0F2" />
                                                                                                    </RadialGradientBrush.GradientStops>
                                                                                                </RadialGradientBrush>
                                                                                            </Border.Background>
                                                                                            <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                                                                <Grid.Background>
                                                                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                                                                        <LinearGradientBrush.GradientStops>
                                                                                                            <GradientStop Offset="0" Color="Transparent" />
                                                                                                            <GradientStop Offset="0.4" Color="Transparent" />
                                                                                                            <GradientStop Offset="0.6" Color="#7FFFFFFF" />
                                                                                                            <GradientStop Offset="1" Color="#40FFFFFF" />
                                                                                                        </LinearGradientBrush.GradientStops>
                                                                                                    </LinearGradientBrush>
                                                                                                </Grid.Background>
                                                                                                <Canvas HorizontalAlignment="Right" Width="3" Margin="0,3">
                                                                                                    <Canvas.Background>
                                                                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                                            <LinearGradientBrush.GradientStops>
                                                                                                                <GradientStop Offset="0" Color="White" />
                                                                                                                <GradientStop Offset="1" Color="#FFC4D5E7" />
                                                                                                            </LinearGradientBrush.GradientStops>
                                                                                                        </LinearGradientBrush>
                                                                                                    </Canvas.Background>
                                                                                                </Canvas>
                                                                                                <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="0,0,3,0">
                                                                                                    <Rectangle Fill="Transparent" Height="5" />
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="#00B4B7C0" />
                                                                                                                    <GradientStop Offset="0.5" Color="#FFB4B7C0" />
                                                                                                                    <GradientStop Offset="1" Color="#00B4B7C0" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Rectangle Fill="Transparent" Height="4" />
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="#00B4B7C0" />
                                                                                                                    <GradientStop Offset="0.5" Color="#FFB4B7C0" />
                                                                                                                    <GradientStop Offset="1" Color="#00B4B7C0" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Rectangle Fill="Transparent" Height="4" />
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="#00B4B7C0" />
                                                                                                                    <GradientStop Offset="0.5" Color="#FFB4B7C0" />
                                                                                                                    <GradientStop Offset="1" Color="#00B4B7C0" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Rectangle Fill="Transparent" Height="4" />
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="#00B4B7C0" />
                                                                                                                    <GradientStop Offset="0.5" Color="#FFB4B7C0" />
                                                                                                                    <GradientStop Offset="1" Color="#00B4B7C0" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                </StackPanel>
                                                                                            </Grid>
                                                                                        </Border>
                                                                                        <Border x:Name="HoverBackground" CornerRadius="0,2,2,0" BorderThickness="1" ClipToBounds="True"
                                Opacity="0">
                                                                                            <Border.BorderBrush>
                                                                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                                    <LinearGradientBrush.GradientStops>
                                                                                                        <GradientStop Offset="0" Color="#FF5481BD" />
                                                                                                        <GradientStop Offset="1" Color="#FF86A0BF" />
                                                                                                    </LinearGradientBrush.GradientStops>
                                                                                                </LinearGradientBrush>
                                                                                            </Border.BorderBrush>
                                                                                            <Border.Background>
                                                                                                <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                                                                                    <RadialGradientBrush.GradientStops>
                                                                                                        <GradientStop Offset="0" Color="#FFDEE5EF" />
                                                                                                        <GradientStop Offset="1" Color="#FFF2F5F7" />
                                                                                                    </RadialGradientBrush.GradientStops>
                                                                                                </RadialGradientBrush>
                                                                                            </Border.Background>
                                                                                            <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                                                                <Grid.Background>
                                                                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                                                                        <LinearGradientBrush.GradientStops>
                                                                                                            <GradientStop Offset="0" Color="Transparent" />
                                                                                                            <GradientStop Offset="0.5" Color="Transparent" />
                                                                                                            <GradientStop Offset="0.5" Color="#7FFFFFFF" />
                                                                                                            <GradientStop Offset="1" Color="#40FFFFFF" />
                                                                                                        </LinearGradientBrush.GradientStops>
                                                                                                    </LinearGradientBrush>
                                                                                                </Grid.Background>
                                                                                                <Canvas HorizontalAlignment="Right" Width="3" Margin="0,3">
                                                                                                    <Canvas.Background>
                                                                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                                            <LinearGradientBrush.GradientStops>
                                                                                                                <GradientStop Offset="0" Color="White" />
                                                                                                                <GradientStop Offset="1" Color="#FFC4D5E7" />
                                                                                                            </LinearGradientBrush.GradientStops>
                                                                                                        </LinearGradientBrush>
                                                                                                    </Canvas.Background>
                                                                                                </Canvas>
                                                                                                <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="0,0,3,0">
                                                                                                    <Rectangle Fill="Transparent" Height="5" />
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="#00B4B7C0" />
                                                                                                                    <GradientStop Offset="0.5" Color="#FFB4B7C0" />
                                                                                                                    <GradientStop Offset="1" Color="#00B4B7C0" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Rectangle Fill="Transparent" Height="4" />
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="#00B4B7C0" />
                                                                                                                    <GradientStop Offset="0.5" Color="#FFB4B7C0" />
                                                                                                                    <GradientStop Offset="1" Color="#00B4B7C0" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Rectangle Fill="Transparent" Height="4" />
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="#00B4B7C0" />
                                                                                                                    <GradientStop Offset="0.5" Color="#FFB4B7C0" />
                                                                                                                    <GradientStop Offset="1" Color="#00B4B7C0" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Rectangle Fill="Transparent" Height="4" />
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="#00B4B7C0" />
                                                                                                                    <GradientStop Offset="0.5" Color="#FFB4B7C0" />
                                                                                                                    <GradientStop Offset="1" Color="#00B4B7C0" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                    <Canvas HorizontalAlignment="Stretch" Height="1" Opacity="0.375">
                                                                                                        <Canvas.Background>
                                                                                                            <LinearGradientBrush>
                                                                                                                <LinearGradientBrush.GradientStops>
                                                                                                                    <GradientStop Offset="0" Color="Transparent" />
                                                                                                                    <GradientStop Offset="0.5" Color="White" />
                                                                                                                    <GradientStop Offset="1" Color="Transparent" />
                                                                                                                </LinearGradientBrush.GradientStops>
                                                                                                            </LinearGradientBrush>
                                                                                                        </Canvas.Background>
                                                                                                    </Canvas>
                                                                                                </StackPanel>
                                                                                            </Grid>
                                                                                        </Border>
                                                                                    </Grid>
                                                                                    <ControlTemplate.Triggers>
                                                                                        <MultiTrigger>
                                                                                            <MultiTrigger.Conditions>
                                                                                                <Condition Property="IsMouseOver" Value="True" />
                                                                                                <Condition Property="IsDragging" Value="False" />
                                                                                            </MultiTrigger.Conditions>
                                                                                            <MultiTrigger.EnterActions>
                                                                                                <BeginStoryboard>
                                                                                                    <Storyboard>
                                                                                                        <DoubleAnimation Storyboard.TargetName="HoverBackground"
                                                         Storyboard.TargetProperty="Opacity" To="1"
                                                         Duration="0:0:0.125" />
                                                                                                    </Storyboard>
                                                                                                </BeginStoryboard>
                                                                                            </MultiTrigger.EnterActions>
                                                                                            <MultiTrigger.ExitActions>
                                                                                                <BeginStoryboard>
                                                                                                    <Storyboard>
                                                                                                        <DoubleAnimation Storyboard.TargetName="HoverBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0"
                                                         Duration="0:0:0.125" />
                                                                                                    </Storyboard>
                                                                                                </BeginStoryboard>
                                                                                            </MultiTrigger.ExitActions>
                                                                                        </MultiTrigger>
                                                                                    </ControlTemplate.Triggers>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Thumb.Style>
                                                            </Thumb>
                                                        </Track.Thumb>
                                                        <Track.IncreaseRepeatButton>
                                                            <RepeatButton Style="{DynamicResource ScrollBarPageButton}" Command="ScrollBar.PageDownCommand" />
                                                        </Track.IncreaseRepeatButton>
                                                    </Track>
                                                    <RepeatButton Grid.Row="3" Style="{StaticResource VerticalScrollBarLineDownButton}" VerticalAlignment="Stretch" Command="ScrollBar.LineDownCommand" Content="M 0 0 L 4 4 L 8 0 Z" />
                                                </Grid>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ControlTemplate.Resources>
                    <Grid>
                        <Border x:Name="IdleBackground">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF6595D3"/>
                                        <GradientStop Offset="0.5" Color="#FF5888CC"/>
                                        <GradientStop Offset="1" Color="#FF6595D3"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Border x:Name="OuterHoverBackground" Opacity="0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#7F89CEFF"/>
                                        <GradientStop Offset="0.5" Color="#7F7CC2FF"/>
                                        <GradientStop Offset="1" Color="#7F89CEFF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Border x:Name="SelectedBackground" Opacity="0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF57B2FF"/>
                                        <GradientStop Offset="0.5" Color="#FF4A9EFF"/>
                                        <GradientStop Offset="1" Color="#FF57B2FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Border BorderThickness="1" Name="PART_ButtonBorder" BorderBrush="Transparent" Background="Transparent" VerticalAlignment="Stretch">
                            <DockPanel Name="stackPanel" KeyboardNavigation.TabNavigation="Local">
                                <Border BorderThickness="0,0,0,0" Name="downBorder" BorderBrush="Transparent" Background="Transparent" Margin="0,0,0,0" DockPanel.Dock="Right">
                                    <Grid>
                                        <Border x:Name="LowerHoverBackground" Opacity="0">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                    <LinearGradientBrush.GradientStops>
                                                        <GradientStop Offset="0" Color="#FF89CEFF"/>
                                                        <GradientStop Offset="0.5" Color="#FF7CC2FF"/>
                                                        <GradientStop Offset="1" Color="#FF89CEFF"/>
                                                    </LinearGradientBrush.GradientStops>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                        </Border>
                                        <Border x:Name="LowerSelectedBackground" Opacity="0">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                    <LinearGradientBrush.GradientStops>
                                                        <GradientStop Offset="0" Color="#FF57B2FF"/>
                                                        <GradientStop Offset="0.5" Color="#FF4A9EFF"/>
                                                        <GradientStop Offset="1" Color="#FF57B2FF"/>
                                                    </LinearGradientBrush.GradientStops>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                        </Border>
                                        <Path Data="M 0 0 L 4 4 L 8 0 Z" HorizontalAlignment="Center" VerticalAlignment="Center" Fill="{TemplateBinding Foreground}" Stroke="Transparent" StrokeThickness="0" Margin="5"/>
                                    </Grid>
                                </Border>
                                <Grid>
                                    <Border x:Name="HoverBackground" Opacity="0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                <LinearGradientBrush.GradientStops>
                                                    <GradientStop Offset="0" Color="#FF89CEFF"/>
                                                    <GradientStop Offset="0.5" Color="#FF7CC2FF"/>
                                                    <GradientStop Offset="1" Color="#FF89CEFF"/>
                                                </LinearGradientBrush.GradientStops>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                    </Border>
                                    <Fluent:ToggleButton x:Name="PART_Button" Command="{TemplateBinding Command}" CommandParameter="{TemplateBinding CommandParameter}" CommandTarget="{TemplateBinding CommandTarget}" Margin="0,0,0,0" Height="Auto" Width="Auto" Style="{DynamicResource InnerButtonStyle}" IsEnabled="{TemplateBinding IsButtonEnabled}" ToolTip="{TemplateBinding ToolTip}" GroupName="{Binding GroupName, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsChecked="{Binding IsChecked, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsDefinitive="{TemplateBinding IsDefinitive}" CanAddToQuickAccessToolBar="{TemplateBinding CanAddButtonToQuickAccessToolBar}" Foreground="{TemplateBinding Foreground}">
                                        <!--Header="{TemplateBinding Header}" -->
                                    </Fluent:ToggleButton>
                                    <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" Style="{DynamicResource TwoLineLabelStyle}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5,0" HasGlyph="False" HasTwoLines="False" Foreground="{TemplateBinding Foreground}" IsHitTestVisible="False"/>
                                </Grid>
                            </DockPanel>
                        </Border>
                        <Popup x:Name="PART_Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                            <Grid Name="DropDown" IsEnabled="{TemplateBinding IsEnabled}" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Top">
                                <Border x:Name="PART_DropDownBorder" MinWidth="{TemplateBinding ActualWidth}" SnapsToDevicePixels="True" Background="{DynamicResource ContextMenuBackgroundBrush}" BorderBrush="{DynamicResource ContextMenuBorderBrush}" BorderThickness="1" CornerRadius="3" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                    <!--d:LayoutOverrides="Width, Height"-->
                                    <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                        <Grid Margin="0" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Rectangle x:Name="StackSizingAid" MaxHeight="{TemplateBinding MaxDropDownHeight}" SnapsToDevicePixels="True"/>
                                            <ScrollViewer x:Name="PART_ScrollViewer" MaxHeight="{TemplateBinding MaxDropDownHeight}" SnapsToDevicePixels="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden" ClipToBounds="True">
                                                <StackPanel x:Name="PART_MenuPanel" Orientation="Vertical" IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" Margin="3"/>
                                            </ScrollViewer>
                                            <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" Background="Transparent" BorderBrush="Transparent" BorderThickness="0,1,0,0" Grid.Row="1" CornerRadius="0,0,1,1" Visibility="Collapsed">
                                                <Grid>
                                                    <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                                    <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                                </Grid>
                                            </Border>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="ResizeMode" Value="None">
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Both">
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Vertical">
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                        </Trigger>
                        <!--Trigger Property="Size" Value="Middle">
                            <Setter Property="Width" TargetName="controlLabel" Value="10" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="0,-19,0,0" />
                            <Setter Property="Text" TargetName="controlLabel" Value="" />
                        </Trigger-->
                        <Trigger Property="IsButtonEnabled" Value="False">
                            <Setter Property="IsEnabled" TargetName="PART_Button" Value="False" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="IdleReveal" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="LowerIdleReveal" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="controlLabel" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="IdleReveal" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="LowerIdleReveal" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="controlLabel" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter Property="IsEnabled" TargetName="PART_Button" Value="False" />
                            <!--Setter Property="Opacity" TargetName="controlLabel" Value="0.25" /-->
                        </Trigger>
                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerSelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerSelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <!--Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" /-->
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="PART_Button" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <!--Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" /-->
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                        <DoubleAnimation Storyboard.TargetName="OuterHoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                        <DoubleAnimation Storyboard.TargetName="OuterHoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="downBorder" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                            <!--Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                            <Setter Property="Background" TargetName="downBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                            <Setter Property="BorderBrush" TargetName="downBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" /-->
                        </MultiTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="OuterHoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="OuterHoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="68" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Bottom" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="22" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Right" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.Margin" Value="0,0,-5,0" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="32" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Right" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.Margin" Value="0,0,-5,0" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="OldBreadcrumbStyle" TargetType="Button">
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="Padding" Value="10,0" />
        <Setter Property="Foreground" Value="White" />
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="FocusVisualStyle" Value="{DynamicResource PlexFocusVisualStyle}" />
        <Setter Property="UseLayoutRounding" Value="True"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <Border x:Name="IdleBackground">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF6595D3"/>
                                        <GradientStop Offset="0.5" Color="#FF5888CC"/>
                                        <GradientStop Offset="1" Color="#FF6595D3"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Border x:Name="HoverBackground" Opacity="0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF89CEFF"/>
                                        <GradientStop Offset="0.5" Color="#FF7CC2FF"/>
                                        <GradientStop Offset="1" Color="#FF89CEFF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <Border x:Name="PressedBackground" Opacity="0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF57B2FF"/>
                                        <GradientStop Offset="0.5" Color="#FF4A9EFF"/>
                                        <GradientStop Offset="1" Color="#FF57B2FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <ContentControl Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Margin="{TemplateBinding Padding}" Focusable="False" IsTabStop="False" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="PressedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="PressedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        <!--Trigger Property="IsEnabled" Value="False">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="DisabledBackground"
                                                         Storyboard.TargetProperty="Opacity" To="1"
                                                         Duration="0:0:0.125" />
                                        <DoubleAnimation Storyboard.TargetName="DisabledSecondaryBackground"
                                                         Storyboard.TargetProperty="Opacity" To="1"
                                                         Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="DisabledBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0"
                                                         Duration="0:0:0.125" />
                                        <DoubleAnimation Storyboard.TargetName="DisabledSecondaryBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0"
                                                         Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger-->
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:QuickAccessMenuItem}" TargetType="{x:Type Fluent:QuickAccessMenuItem}">
        <Setter Property="OverridesDefaultStyle" Value="True"/>
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Hidden" />
        <Setter Property="Background" Value="{DynamicResource Fluent.Ribbon.Brushes.MenuItem.Background}" />
        <Setter Property="Foreground" Value="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:QuickAccessMenuItem}">
                    <Border Name="Border" Padding="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="#01000000">
                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <Border x:Name="HoverBackground" Background="Transparent" BorderBrush="{DynamicResource ToolbarButtonHoverBorderBrush}" BorderThickness="1" CornerRadius="4" Opacity="0">
                                <Border BorderThickness="1" CornerRadius="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}">
                                    <Border BorderThickness="0,1,0,2" CornerRadius="2" Background="{DynamicResource ToolbarButtonHoverTertiaryBackgroundBrush}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}"/>
                                </Border>
                            </Border>
                            <Label x:Name="Check" FontFamily="Marlett" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="3,0" Foreground="{TemplateBinding Foreground}" Visibility="Hidden">b</Label>
                            <Grid x:Name="CheckOffsetGrid" Margin="0">
                                <ContentPresenter Name="Content" Margin="{TemplateBinding Padding}" ContentSource="Header" RecognizesAccessKey="True" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                            </Grid>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsHighlighted" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource ToolbarButtonHoverForegroundBrush}" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Foreground" Value="{DynamicResource ToolbarButtonDisabledForegroundBrush}" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="Check" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="IsCheckable" Value="True">
                            <Setter TargetName="CheckOffsetGrid" Property="Margin" Value="12,0,0,0"/>
                        </Trigger>
                        <DataTrigger Binding="{Binding Description, RelativeSource={RelativeSource TemplatedParent}, Converter={x:Static converters:IsNullConverter.Instance}}" Value="False">
                            <Setter Property="Template" Value="{DynamicResource MenuItemWithDescriptionTemplate}" />
                            <Setter Property="HeaderTemplate">
                                <Setter.Value>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" FontWeight="Bold" />
                                    </DataTemplate>
                                </Setter.Value>
                            </Setter>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="HeaderTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock Text="{Binding}" />
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Fluent:MenuItem.IsSplited" Value="True" />
                    <Condition Property="HasItems" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="Template" Value="{DynamicResource SplitedMenuItemTemplate}" />
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Fluent:MenuItem.IsSplited" Value="False" />
                    <Condition Property="HasItems" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="Template" Value="{DynamicResource HeaderMenuItemTemplate}" />
            </MultiTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="PlexRibbonButtonStyle" TargetType="{x:Type Fluent:Button}">
        <Setter Property="Height" Value="68" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="2,1"/>
        <Setter Property="Padding" Value="6,2"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:Button}">
                    <Grid>
                        <Border x:Name="HoverBackground" Background="Transparent" BorderBrush="{DynamicResource ToolbarButtonHoverPrimaryBorderBrush}" BorderThickness="1" CornerRadius="4" Opacity="0">
                            <Border BorderThickness="1" CornerRadius="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}">
                                <Border BorderThickness="0,1,0,2" CornerRadius="2" Background="#FF68A2CC" BorderBrush="#FF58BFEA"/>
                            </Border>
                        </Border>
                        <Border x:Name="SelectedBackground" Background="Transparent" BorderBrush="{DynamicResource ToolbarButtonHoverPrimaryBorderBrush}" BorderThickness="1" CornerRadius="4" Opacity="0">
                            <Border BorderThickness="1" CornerRadius="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}">
                                <Border BorderThickness="0,1,0,2" CornerRadius="2" Background="{DynamicResource ToolbarToggleButtonSelectedBackground}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}"/>
                            </Border>
                        </Border>
                        <Canvas x:Name="SizingAid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                        <apictrl:Reveal x:Name="IdleReveal" HoverWidth="512" HoverHeight="512" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0">
                            <apictrl:Reveal.Hover>
                                <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                    <RadialGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FFEEFEFE"/>
                                        <GradientStop Offset="0.5" Color="#B076BDEF"/>
                                        <GradientStop Offset="0.75" Color="#5076BEEF"/>
                                        <GradientStop Offset="1" Color="#0076BEEF"/>
                                    </RadialGradientBrush.GradientStops>
                                </RadialGradientBrush>
                            </apictrl:Reveal.Hover>
                            <apictrl:Reveal.OpacityMask>
                                <VisualBrush>
                                    <VisualBrush.Visual>
                                        <Border Width="{Binding ActualWidth, RelativeSource={RelativeSource Mode=TemplatedParent}}" Height="{Binding ActualHeight, RelativeSource={RelativeSource Mode=TemplatedParent}}" Background="Transparent" BorderBrush="Black" BorderThickness="1" CornerRadius="4"/>
                                    </VisualBrush.Visual>
                                </VisualBrush>
                            </apictrl:Reveal.OpacityMask>
                        </apictrl:Reveal>
                        <apictrl:Reveal x:Name="HoverReveal" HoverWidth="128" HoverHeight="128" Width="{TemplateBinding ActualWidth}" Height="{TemplateBinding ActualHeight}" Opacity="0">
                            <apictrl:Reveal.Hover>
                                <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                    <RadialGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#C0B8F2FB"/>
                                        <GradientStop Offset="1" Color="#00B8F2FB"/>
                                    </RadialGradientBrush.GradientStops>
                                </RadialGradientBrush>
                            </apictrl:Reveal.Hover>
                            <apictrl:Reveal.OpacityMask>
                                <VisualBrush>
                                    <VisualBrush.Visual>
                                        <Border Width="{TemplateBinding ActualWidth}" Height="{TemplateBinding ActualHeight}" Background="Black" BorderBrush="Transparent" BorderThickness="3" CornerRadius="4"/>
                                    </VisualBrush.Visual>
                                </VisualBrush>
                            </apictrl:Reveal.OpacityMask>
                        </apictrl:Reveal>
                        <StackPanel x:Name="stackPanel" Width="Auto" Margin="{TemplateBinding Padding}" Orientation="Horizontal">
                            <ContentPresenter x:Name="largeIconImage" HorizontalAlignment="Center" VerticalAlignment="Center" Width="32" Height="32" Margin="0,2,0,0" SnapsToDevicePixels="True" Visibility="Collapsed" Content="{Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='32,32'}"/>
                            <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" VerticalAlignment="Center" Width="16" Height="16" Margin="0,2" SnapsToDevicePixels="True" Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='16,16'}"/>
                            <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2,0" HasTwoLines="False"/>
                        </StackPanel>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <!--DataTrigger Binding="{Binding IsManipulationEnabled, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:RibbonTabControl}}}" Value="False">
                            <Setter TargetName="IdleReveal" Property="Visibility" Value="Hidden"/>
                            <Setter TargetName="HoverReveal" Property="Visibility" Value="Hidden"/>
                        </DataTrigger-->
                        <Trigger Property="Size" Value="Small">
                            <Setter Property="Visibility" TargetName="controlLabel" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="Size" Value="Large">
                            <Setter Property="HasTwoLines" TargetName="controlLabel" Value="True" />
                            <Setter Property="Orientation" TargetName="stackPanel" Value="Vertical" />
                            <Setter Property="Visibility" TargetName="largeIconImage" Value="Visible" />
                            <Setter Property="Visibility" TargetName="iconImage" Value="Collapsed" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="2,0,0,0" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                        <DoubleAnimation Storyboard.TargetName="HoverReveal" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                        <DoubleAnimation Storyboard.TargetName="HoverReveal" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource ToolbarButtonHoverForegroundBrush}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource ToolbarButtonHoverForegroundBrush}" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="IdleReveal" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="iconImage" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="largeIconImage" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="controlLabel" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="IdleReveal" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="iconImage" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="largeIconImage" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="controlLabel" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <!--Setter Property="Opacity" TargetName="iconImage" Value="0.25" />
                            <Setter Property="Opacity" TargetName="controlLabel" Value="0.25" /-->
                            <Setter Property="Effect" TargetName="iconImage">
                                <Setter.Value>
                                    <Fluent:GrayscaleEffect />
                                </Setter.Value>
                            </Setter>
                            <Setter Property="Effect" TargetName="largeIconImage">
                                <Setter.Value>
                                    <Fluent:GrayscaleEffect />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="68" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="22" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="22" />
                <Setter Property="HorizontalAlignment" Value="Left" />
            </Trigger>
        </Style.Triggers>
    </Style>
    <Style x:Key="{x:Type Fluent:Button}" TargetType="{x:Type Fluent:Button}" BasedOn="{StaticResource PlexRibbonButtonStyle}"/>

    <Style x:Key="{x:Type Fluent:SplitButton}" TargetType="{x:Type Fluent:SplitButton}">
        <Setter Property="Height" Value="68" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="2,1"/>
        <Setter Property="Padding" Value="6,2"/>
        <Setter Property="Fluent:KeyTip.AutoPlacement" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:SplitButton}">
                    <ControlTemplate.Resources>
                        <Style BasedOn="{StaticResource MenuSeparatorStyle}" TargetType="{x:Type Separator}" />
                    </ControlTemplate.Resources>
                    <Grid>
                        <Border x:Name="OuterHoverBackground" Background="Transparent" BorderBrush="{DynamicResource ToolbarButtonHoverPrimaryBorderBrush}" BorderThickness="1" CornerRadius="4" Opacity="0" IsHitTestVisible="False"/>
                        <Border BorderThickness="1" Name="PART_ButtonBorder" BorderBrush="Transparent" Background="Transparent" VerticalAlignment="Stretch">
                            <DockPanel Name="stackPanel" KeyboardNavigation.TabNavigation="Local">
                                <Border BorderThickness="0,0,0,0" Name="downBorder" BorderBrush="Transparent" Background="Transparent" Margin="0,0,0,0" Height="32" DockPanel.Dock="Bottom">
                                    <Grid>
                                        <Border x:Name="LowerHoverBackground" BorderThickness="1" CornerRadius="0,0,3,3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}" IsHitTestVisible="False" Opacity="0">
                                            <Border BorderThickness="0,1,0,2" CornerRadius="0,0,2,2" Background="#FF68A2CC" BorderBrush="#FF58BFEA" IsHitTestVisible="False"/>
                                        </Border>
                                        <Border x:Name="LowerSelectedBackground" BorderThickness="1" CornerRadius="0,0,3,3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}" IsHitTestVisible="False" Opacity="0">
                                            <Border BorderThickness="0,1,0,2" CornerRadius="0,0,2,2" Background="{DynamicResource ToolbarToggleButtonSelectedBackground}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}" IsHitTestVisible="False"/>
                                        </Border>
                                        <Canvas x:Name="LowerSizingAid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-1,0,-1,-1"/>
                                        <apictrl:Reveal x:Name="LowerIdleReveal" HoverWidth="512" HoverHeight="512" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-1,0,-1,-1">
                                            <apictrl:Reveal.Hover>
                                                <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                                    <RadialGradientBrush.GradientStops>
                                                        <GradientStop Offset="0" Color="#FFEEFEFE"/>
                                                        <GradientStop Offset="0.5" Color="#B076BDEF"/>
                                                        <GradientStop Offset="0.75" Color="#5076BEEF"/>
                                                        <GradientStop Offset="1" Color="#0076BEEF"/>
                                                    </RadialGradientBrush.GradientStops>
                                                </RadialGradientBrush>
                                            </apictrl:Reveal.Hover>
                                            <apictrl:Reveal.OpacityMask>
                                                <VisualBrush>
                                                    <VisualBrush.Visual>
                                                        <Border Width="{Binding ActualWidth, Source={x:Reference LowerSizingAid}}" Height="{Binding ActualHeight, Source={x:Reference LowerSizingAid}}" Background="Transparent" BorderBrush="Black" BorderThickness="1,0,1,1" CornerRadius="0,0,4,4"/>
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </apictrl:Reveal.OpacityMask>
                                        </apictrl:Reveal>
                                        <apictrl:Reveal x:Name="LowerHoverReveal" HoverWidth="128" HoverHeight="128" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-1,0,-1,-1" Opacity="0">
                                            <apictrl:Reveal.Hover>
                                                <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                                    <RadialGradientBrush.GradientStops>
                                                        <GradientStop Offset="0" Color="#FFB8F2FB"/>
                                                        <GradientStop Offset="1" Color="#00B8F2FB"/>
                                                    </RadialGradientBrush.GradientStops>
                                                </RadialGradientBrush>
                                            </apictrl:Reveal.Hover>
                                            <apictrl:Reveal.OpacityMask>
                                                <VisualBrush>
                                                    <VisualBrush.Visual>
                                                        <Border Width="{Binding ActualWidth, Source={x:Reference LowerSizingAid}}" Height="{Binding ActualHeight, Source={x:Reference LowerSizingAid}}" Background="Transparent" BorderBrush="Black" BorderThickness="1,0,1,1" CornerRadius="0,0,4,4"/>
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </apictrl:Reveal.OpacityMask>
                                        </apictrl:Reveal>
                                        <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="{TemplateBinding Padding}" HasTwoLines="False"/>
                                        <!--Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" Style="{DynamicResource TwoLineLabelStyle}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2,1,2,2" HasGlyph="{TemplateBinding HasTriangle}" Foreground="{TemplateBinding Foreground}" /-->
                                    </Grid>
                                </Border>
                                <Grid>
                                    <Border x:Name="HoverBackground" BorderThickness="1" CornerRadius="3,3,0,0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}" IsHitTestVisible="False" Opacity="0">
                                        <Border BorderThickness="0,1,0,2" CornerRadius="2,2,0,0" Background="#FF68A2CC" BorderBrush="#FF58BFEA" IsHitTestVisible="False"/>
                                    </Border>
                                    <Border x:Name="SelectedBackground" BorderThickness="1" CornerRadius="3,3,0,0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}" IsHitTestVisible="False" Opacity="0">
                                        <Border BorderThickness="0,1,0,2" CornerRadius="2,2,0,0" Background="{DynamicResource ToolbarToggleButtonSelectedBackground}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}" IsHitTestVisible="False"/>
                                    </Border>
                                    <Canvas x:Name="SizingAid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-1,-1,-1,0"/>
                                    <apictrl:Reveal x:Name="IdleReveal" HoverWidth="512" HoverHeight="512" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-1,-1,-1,0">
                                        <apictrl:Reveal.Hover>
                                            <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                                <RadialGradientBrush.GradientStops>
                                                    <GradientStop Offset="0" Color="#FFEEFEFE"/>
                                                    <GradientStop Offset="0.5" Color="#B076BDEF"/>
                                                    <GradientStop Offset="0.75" Color="#5076BEEF"/>
                                                    <GradientStop Offset="1" Color="#0076BEEF"/>
                                                </RadialGradientBrush.GradientStops>
                                            </RadialGradientBrush>
                                        </apictrl:Reveal.Hover>
                                        <apictrl:Reveal.OpacityMask>
                                            <VisualBrush>
                                                <VisualBrush.Visual>
                                                    <Border Width="{Binding ActualWidth, Source={x:Reference SizingAid}}" Height="{Binding ActualHeight, Source={x:Reference SizingAid}}" Background="Transparent" BorderBrush="Black" BorderThickness="1" CornerRadius="4,4,0,0"/>
                                                </VisualBrush.Visual>
                                            </VisualBrush>
                                        </apictrl:Reveal.OpacityMask>
                                    </apictrl:Reveal>
                                    <apictrl:Reveal x:Name="HoverReveal" HoverWidth="128" HoverHeight="128" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="-1,-1,-1,0" Opacity="0">
                                        <apictrl:Reveal.Hover>
                                            <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                                <RadialGradientBrush.GradientStops>
                                                    <GradientStop Offset="0" Color="#FFB8F2FB"/>
                                                    <GradientStop Offset="1" Color="#00B8F2FB"/>
                                                </RadialGradientBrush.GradientStops>
                                            </RadialGradientBrush>
                                        </apictrl:Reveal.Hover>
                                        <apictrl:Reveal.OpacityMask>
                                            <VisualBrush>
                                                <VisualBrush.Visual>
                                                    <Border Width="{Binding ActualWidth, Source={x:Reference SizingAid}}" Height="{Binding ActualHeight, Source={x:Reference SizingAid}}" Background="Black" BorderBrush="Transparent" BorderThickness="3" CornerRadius="4,4,0,0"/>
                                                </VisualBrush.Visual>
                                            </VisualBrush>
                                        </apictrl:Reveal.OpacityMask>
                                    </apictrl:Reveal>

                                    <!--apictrl:Reveal x:Name="HoverReveal" HoverWidth="128" HoverHeight="128" Width="{TemplateBinding ActualWidth}" Height="{TemplateBinding ActualHeight}" Opacity="0">
                                        <apictrl:Reveal.Hover>
                                            <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5">
                                                <RadialGradientBrush.GradientStops>
                                                    <GradientStop Offset="0" Color="#C0B8F2FB"/>
                                                    <GradientStop Offset="1" Color="#00B8F2FB"/>
                                                </RadialGradientBrush.GradientStops>
                                            </RadialGradientBrush>
                                        </apictrl:Reveal.Hover>
                                        <apictrl:Reveal.OpacityMask>
                                            <VisualBrush>
                                                <VisualBrush.Visual>
                                                    <Border Width="{TemplateBinding ActualWidth}" Height="{TemplateBinding ActualHeight}" Background="Black" BorderBrush="Transparent" BorderThickness="3" CornerRadius="4"/>
                                                </VisualBrush.Visual>
                                            </VisualBrush>
                                        </apictrl:Reveal.OpacityMask>
                                    </apictrl:Reveal-->
                                    <Fluent:ToggleButton x:Name="PART_Button" Command="{TemplateBinding Command}" CommandParameter="{TemplateBinding CommandParameter}" CommandTarget="{TemplateBinding CommandTarget}" Margin="0,0,0,0" Height="Auto" Width="Auto" Style="{DynamicResource InnerButtonStyle}" IsEnabled="{TemplateBinding IsButtonEnabled}" Header="{TemplateBinding Header}" ToolTip="{TemplateBinding ToolTip}" GroupName="{Binding GroupName, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsChecked="{Binding IsChecked, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsDefinitive="{TemplateBinding IsDefinitive}" CanAddToQuickAccessToolBar="{TemplateBinding CanAddButtonToQuickAccessToolBar}" Foreground="{TemplateBinding Foreground}" />

                                    <ContentPresenter x:Name="largeIconImage" HorizontalAlignment="Center" VerticalAlignment="Center" Width="32" Height="32" Margin="0,2,0,0" SnapsToDevicePixels="True" Visibility="Collapsed" Content="{Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='32,32'}"/>
                                    <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" VerticalAlignment="Center" Width="16" Height="16" Margin="0,2" SnapsToDevicePixels="True" Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='16,16'}"/>
                                </Grid>
                                <!--LargeIcon="{Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}, Converter={x:Static Converters:StaticConverters.ObjectToImageConverter}}"
                                         Icon="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={x:Static Converters:StaticConverters.ObjectToImageConverter}}"-->
                            </DockPanel>
                        </Border>
                        <Popup x:Name="PART_Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                            <Grid Name="DropDown" IsEnabled="{TemplateBinding IsEnabled}" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Top">
                                <Border x:Name="PART_DropDownBorder" MinWidth="{TemplateBinding ActualWidth}" SnapsToDevicePixels="True" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BorderBrush}" BorderThickness="1" CornerRadius="1" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                    <!--d:LayoutOverrides="Width, Height"-->
                                    <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                        <Border VerticalAlignment="Top" Width="Auto" Height="Auto" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderThickness="1" />
                                        <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <ScrollViewer x:Name="PART_ScrollViewer" Style="{DynamicResource MenuScrollViewer}" Margin="1" MaxHeight="{TemplateBinding MaxDropDownHeight}" SnapsToDevicePixels="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                                                <StackPanel x:Name="PART_MenuPanel" Orientation="Vertical" IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                            </ScrollViewer>
                                            <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BorderBrush}" BorderThickness="0,1,0,0" Grid.Row="1" CornerRadius="0,0,1,1" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BackgoundBrush}">
                                                <Grid>
                                                    <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                                    <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                                </Grid>
                                            </Border>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Size" Value="Small">
                            <Setter Property="Visibility" TargetName="controlLabel" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="Size" Value="Large">
                            <Setter Property="HasTwoLines" TargetName="controlLabel" Value="True" />
                            <Setter Property="Visibility" TargetName="largeIconImage" Value="Visible" />
                            <Setter Property="Visibility" TargetName="iconImage" Value="Collapsed" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="2,0,0,0" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="None">
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Both">
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="ResizeMode" Value="Vertical">
                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Visible" />
                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                        </Trigger>
                        <Trigger Property="Size" Value="Small">
                            <Setter Property="Size" TargetName="PART_Button" Value="Small" />
                            <!--Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" /-->
                            <Setter TargetName="downBorder" Property="DockPanel.Dock" Value="Right"/>
                            <Setter Property="Width" TargetName="controlLabel" Value="10" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="0,-19,0,0" />
                            <Setter Property="Text" TargetName="controlLabel" Value="" />
                            <Setter Property="Padding" TargetName="downBorder" Value="1,0,0,0" />
                        </Trigger>
                        <Trigger Property="Size" Value="Middle">
                            <Setter Property="Size" TargetName="PART_Button" Value="Middle" />
                            <Setter TargetName="downBorder" Property="DockPanel.Dock" Value="Right"/>
                            <!--Setter Property="Orientation" TargetName="stackPanel" Value="Horizontal" /-->
                            <Setter Property="Width" TargetName="controlLabel" Value="10" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="0,-19,0,0" />
                            <Setter Property="Text" TargetName="controlLabel" Value="" />
                        </Trigger>
                        <Trigger Property="IsButtonEnabled" Value="False">
                            <Setter Property="IsEnabled" TargetName="PART_Button" Value="False" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="IdleReveal" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="LowerIdleReveal" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="controlLabel" Storyboard.TargetProperty="Opacity" To="0.25" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="IdleReveal" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="LowerIdleReveal" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="controlLabel" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter Property="IsEnabled" TargetName="PART_Button" Value="False" />
                            <!--Setter Property="Opacity" TargetName="controlLabel" Value="0.25" /-->
                        </Trigger>
                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerSelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerSelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <!--Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" /-->
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="PART_Button" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <!--Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" /-->
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                        <DoubleAnimation Storyboard.TargetName="HoverReveal" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                        <DoubleAnimation Storyboard.TargetName="HoverReveal" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="downBorder" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverReveal" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverReveal" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                            <!--Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                            <Setter Property="Background" TargetName="downBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                            <Setter Property="BorderBrush" TargetName="downBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" /-->
                        </MultiTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="OuterHoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="OuterHoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="68" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Bottom" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="22" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Right" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.Margin" Value="0,0,-5,0" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="32" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Right" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.Margin" Value="0,0,-5,0" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!--Style x:Key="{x:Type Fluent:SplitButton}" TargetType="{x:Type Fluent:SplitButton}">
        <Setter Property="Height" Value="68" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="2,1"/>
        <Setter Property="Padding" Value="2"/>
        <Setter Property="Fluent:KeyTip.AutoPlacement" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:SplitButton}">
                    <ControlTemplate.Resources>
                        <Style BasedOn="{StaticResource MenuSeparatorStyle}"
                   TargetType="{x:Type Separator}" />
                    </ControlTemplate.Resources>
                    <Grid Background="#01000000">
                        <Grid>
                            <Border x:Name="PART_ButtonBorder" Background="Transparent" BorderBrush="{DynamicResource ToolbarButtonHoverPrimaryBorderBrush}" BorderThickness="1" CornerRadius="4" Opacity="0" IsHitTestVisible="False"/>
                            <DockPanel Name="stackPanel" KeyboardNavigation.TabNavigation="Local">
                                <Grid x:Name="TopSegment" DockPanel.Dock="Top" Margin="1,1,1,0">
                                    <Border x:Name="HoverBackground" BorderThickness="1" CornerRadius="3,3,0,0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}" IsHitTestVisible="False" Opacity="0">
                                        <Border BorderThickness="0,1,0,2" CornerRadius="2,2,0,0" Background="{DynamicResource ToolbarButtonHoverTertiaryBackgroundBrush}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}" IsHitTestVisible="False"/>
                                    </Border>
                                    <Border x:Name="SelectedBackground" BorderThickness="1" CornerRadius="3,3,0,0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}" IsHitTestVisible="False" Opacity="0">
                                        <Border BorderThickness="0,1,0,2" CornerRadius="2,2,0,0" Background="{DynamicResource ToolbarToggleButtonSelectedBackground}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}" IsHitTestVisible="False"/>
                                    </Border>
                                    <Fluent:ToggleButton x:Name="PART_Button" Command="{TemplateBinding Command}" CommandParameter="{TemplateBinding CommandParameter}" CommandTarget="{TemplateBinding CommandTarget}" Margin="0,0,0,0" Height="Auto" Width="Auto" IsEnabled="{TemplateBinding IsButtonEnabled}" Header="{TemplateBinding Header}" ToolTip="{TemplateBinding ToolTip}" GroupName="{Binding GroupName, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsChecked="{Binding IsChecked, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsDefinitive="{TemplateBinding IsDefinitive}" CanAddToQuickAccessToolBar="{TemplateBinding CanAddButtonToQuickAccessToolBar}" Background="Red"/>
    </Grid>
    <Border BorderThickness="0" Name="downBorder" Background="#01000000" BorderBrush="Transparent" Margin="1,0,1,1" Height="50">
                                    <Grid>
                                        <Border x:Name="LowerHoverBackground" BorderThickness="1" CornerRadius="0,0,3,3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}" IsHitTestVisible="False" Opacity="0">
                                            <Border BorderThickness="0,1,0,2" CornerRadius="0,0,2,2" Background="{DynamicResource ToolbarButtonHoverTertiaryBackgroundBrush}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}" IsHitTestVisible="False"/>
                                        </Border>
                                        <Border x:Name="LowerSelectedBackground" BorderThickness="1" CornerRadius="0,0,3,3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="{DynamicResource ToolbarButtonHoverSecondaryBorderBrush}" IsHitTestVisible="False" Opacity="0">
                                            <Border BorderThickness="0,1,0,2" CornerRadius="0,0,2,2" Background="{DynamicResource ToolbarToggleButtonSelectedBackground}" BorderBrush="{DynamicResource ToolbarButtonHoverTertiaryBorderBrush}" IsHitTestVisible="False"/>
                                        </Border>
                                        <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" Style="{DynamicResource TwoLineLabelStyle}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2,1,2,2" HasGlyph="{TemplateBinding HasTriangle}" />
                                    </Grid>
                                </Border>
                            </DockPanel>
                        </Grid>
                        <Popup x:Name="PART_Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                            <Grid Name="DropDown" IsEnabled="{TemplateBinding IsEnabled}" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Top">
                                <Border x:Name="PART_DropDownBorder" MinWidth="{TemplateBinding ActualWidth}" SnapsToDevicePixels="True" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BorderBrush}" BorderThickness="1" CornerRadius="1" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                    <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                        <Border VerticalAlignment="Top" Width="Auto" Height="Auto" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderThickness="1" />
                                        <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <ScrollViewer x:Name="PART_ScrollViewer" Style="{DynamicResource MenuScrollViewer}" Margin="1" MaxHeight="{TemplateBinding MaxDropDownHeight}" SnapsToDevicePixels="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                                                <StackPanel x:Name="PART_MenuPanel" Orientation="Vertical" IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                            </ScrollViewer>
                                            <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BorderBrush}" BorderThickness="0,1,0,0" Grid.Row="1" CornerRadius="0,0,1,1" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BackgoundBrush}">
                                                <Grid>
                                                    <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                                    <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                                </Grid>
                                            </Border>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="ResizeMode"
                     Value="None">
                            <Setter Property="Visibility"
                        TargetName="resizeBorder"
                        Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ResizeMode"
                     Value="Both">
                            <Setter Property="Visibility"
                        TargetName="PART_ResizeVerticalThumb"
                        Value="Collapsed" />
                            <Setter Property="Visibility"
                        TargetName="PART_ResizeBothThumb"
                        Value="Visible" />
                            <Setter Property="Visibility"
                        TargetName="resizeBorder"
                        Value="Visible" />
                        </Trigger>
                        <Trigger Property="ResizeMode"
                     Value="Vertical">
                            <Setter Property="Visibility"
                        TargetName="PART_ResizeBothThumb"
                        Value="Collapsed" />
                            <Setter Property="Visibility"
                        TargetName="PART_ResizeVerticalThumb"
                        Value="Visible" />
                            <Setter Property="Visibility"
                        TargetName="resizeBorder"
                        Value="Visible" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                        </Trigger>
                        <Trigger Property="Size" Value="Small">
                            <Setter Property="Size" TargetName="PART_Button" Value="Small" />
                            <Setter Property="Width" TargetName="controlLabel" Value="10" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="0,-19,0,0" />
                            <Setter Property="Text" TargetName="controlLabel" Value="" />
                            <Setter Property="Padding" TargetName="downBorder" Value="1,0,0,0" />
                        </Trigger>
                        <Trigger Property="Size" Value="Middle">
                            <Setter Property="Size" TargetName="PART_Button" Value="Middle" />
                            <Setter Property="Width" TargetName="controlLabel" Value="10" />
                            <Setter Property="Margin" TargetName="controlLabel" Value="0,-19,0,0" />
                            <Setter Property="Text" TargetName="controlLabel" Value="" />
                        </Trigger>
                        <Trigger Property="IsButtonEnabled" Value="False">
                            <Setter Property="IsEnabled" TargetName="PART_Button" Value="False" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="IsEnabled" TargetName="PART_Button" Value="False" />
                            <Setter Property="Opacity" TargetName="controlLabel" Value="0.5" />
                        </Trigger>
                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="PART_Button" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.0625" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <Trigger SourceName="controlLabel" Property="IsFocused" Value="True">
                            <Setter Property="IsDropDownOpen" Value="True"/>
                            <Setter TargetName="PART_Popup" Property="IsOpen" Value="True"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="downBorder" />
                                <Condition Property="IsDropDownOpen" Value="False" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="LowerHoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource ToolbarButtonHoverForegroundBrush}" />
                        </MultiTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="PART_ButtonBorder" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="PART_ButtonBorder" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource ToolbarButtonHoverForegroundBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Size" Value="Large">
                <Setter Property="Height" Value="68" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Bottom" />
            </Trigger>
            <Trigger Property="Size" Value="Middle">
                <Setter Property="Height" Value="22" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Right" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.Margin" Value="0,0,-5,0" />
            </Trigger>
            <Trigger Property="Size" Value="Small">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="32" />
                <Setter Property="Fluent:KeyTip.HorizontalAlignment" Value="Right" />
                <Setter Property="Fluent:KeyTip.VerticalAlignment" Value="Center" />
                <Setter Property="Fluent:KeyTip.Margin" Value="0,0,-5,0" />
            </Trigger>
        </Style.Triggers>
    </Style-->

    <!--Style x:Key="{x:Type Fluent:Button}" TargetType="{x:Type Fluent:Button}" BasedOn="{StaticResource {x:Type Fluent:Button}}"/-->

    <Style x:Key="PlexRibbonBackstageButtonStyle" TargetType="{x:Type Fluent:Button}">
        <Setter Property="Height" Value="20" />
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Foreground" Value="{DynamicResource PlexDarkRibbonForegroundBrush}"/>
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:Button}">
                    <Grid>
                        <Border x:Name="HoverBackground" BorderThickness="1" Padding="0" Margin="0,-1,214,-1" CornerRadius="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0" MinWidth="0">
                            <Border.BorderBrush>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF599EE2"/>
                                        <GradientStop Offset="1" Color="#FF61B4FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.BorderBrush>
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF80C3FF"/>
                                        <GradientStop Offset="0.45" Color="#FF70B2FF"/>
                                        <GradientStop Offset="0.9" Color="#FF8CCEFF"/>
                                        <GradientStop Offset="1" Color="#FF83C4FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border BorderBrush="Transparent" BorderThickness="0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop x:Name="LightColorTop" Offset="0" Color="#FF1C5F9B"/>
                                            <GradientStop x:Name="LightColorMiddle" Offset="0.45" Color="#FF0C4E9B"/>
                                            <GradientStop x:Name="LightColorBottom" Offset="0.9" Color="#FF286A9B"/>
                                            <GradientStop x:Name="LightColorBottomBelow" Offset="1" Color="#FF83C4FF"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>
                        <Border x:Name="SelectedBackground" BorderThickness="1" Padding="0" Margin="0,-1" CornerRadius="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0" MinWidth="0">
                            <Border.BorderBrush>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF599EE2"/>
                                        <GradientStop Offset="1" Color="#FF61B4FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.BorderBrush>
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF80C3FF"/>
                                        <GradientStop Offset="0.45" Color="#FF70B2FF"/>
                                        <GradientStop Offset="0.9" Color="#FF8CCEFF"/>
                                        <GradientStop Offset="1" Color="#FF83C4FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border BorderBrush="Transparent" BorderThickness="0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="#401C5F9B"/>
                                            <GradientStop Offset="0.45" Color="#400C4E9B"/>
                                            <GradientStop Offset="0.9" Color="#40286A9B"/>
                                            <GradientStop Offset="1" Color="#4083C4FF"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>
                        <StackPanel x:Name="stackPanel" Width="Auto" Margin="{TemplateBinding Padding}" Orientation="Horizontal" VerticalAlignment="Center">
                            <ContentPresenter x:Name="iconImage" HorizontalAlignment="Left" Width="16" Height="16" VerticalAlignment="Center" Content="{Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='16,16'}" Margin="5,0" SnapsToDevicePixels="True"/>
                            <Fluent:TwoLineLabel x:Name="controlLabel" Text="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" HorizontalContentAlignment="Left" VerticalContentAlignment="Center" Margin="2,0" Foreground="{DynamicResource PlexRibbonDarkForegroundBrush}" HasTwoLines="False"/>
                        </StackPanel>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorTop" Storyboard.TargetProperty="Color" To="#FF80C3FF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorMiddle" Storyboard.TargetProperty="Color" To="#FF70B2FF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottom" Storyboard.TargetProperty="Color" To="#FF8CCEFF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottomBelow" Storyboard.TargetProperty="Color" To="#FF83C4FF" Duration="0:0:0.125"/>
                                        <ThicknessAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Margin" To="0,-1" Duration="0:0:0.125">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorTop" Storyboard.TargetProperty="Color" To="#FF1C5F9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorMiddle" Storyboard.TargetProperty="Color" To="#FF0C4E9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottom" Storyboard.TargetProperty="Color" To="#FF286A9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottomBelow" Storyboard.TargetProperty="Color" To="#FF1F609B" Duration="0:0:0.375"/>
                                        <ThicknessAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Margin" To="0,-1,214,-1" Duration="0:0:0.375">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter TargetName="controlLabel" Property="Foreground" Value="White" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="controlLabel" Property="Foreground" Value="White" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" TargetName="iconImage" Value="0.5" />
                            <Setter Property="Opacity" TargetName="controlLabel" Value="0.5" />
                            <Setter Property="Effect" TargetName="iconImage">
                                <Setter.Value>
                                    <Fluent:GrayscaleEffect />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="PlexRibbonTabFocusVisualStyle">
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border BorderThickness="1" CornerRadius="2" SnapsToDevicePixels="true" BorderBrush="{DynamicResource FocusVisualBorderBrush}"
                            Background="Transparent" Margin="101,1">
                        <Border BorderThickness="2" CornerRadius="2" SnapsToDevicePixels="True" Background="Transparent" BorderBrush="{DynamicResource FocusVisualLinearGradientBrush}"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="PlexRibbonSeparatorStyle" TargetType="{x:Type Separator}">
        <Setter Property="Width" Value="1"/>
        <Setter Property="Margin" Value="4,0,4,0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Separator}">
                    <Rectangle HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Fill="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" Stroke="Transparent" StrokeThickness="0">
                        <Rectangle.OpacityMask>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                <LinearGradientBrush.GradientStops>
                                    <GradientStop Offset="0" Color="Transparent"/>
                                    <GradientStop Offset="0.5" Color="White"/>
                                    <GradientStop Offset="1" Color="Transparent"/>
                                </LinearGradientBrush.GradientStops>
                            </LinearGradientBrush>
                        </Rectangle.OpacityMask>
                    </Rectangle>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:QuickAccessToolBar}" TargetType="{x:Type Fluent:QuickAccessToolBar}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:QuickAccessToolBar}">
                    <DockPanel x:Name="PART_RootPanel" KeyboardNavigation.TabNavigation="Local">
                        <ContentControl x:Name="menuContentControl" DockPanel.Dock="Right" HorizontalAlignment="Right" Focusable="False">
                            <Fluent:DropDownButton CanAddToQuickAccessToolBar="False" x:Name="PART_MenuDownButton" Width="13" HorizontalAlignment="Right" VerticalAlignment="Stretch" Height="22" DockPanel.Dock="Right" IsEnabled="{TemplateBinding IsEnabled}" Visibility="{Binding IsMenuDropDownVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}" Size="Small" ToolTip="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarDropDownButtonTooltip, Mode=OneWay}" KeyboardNavigation.TabIndex="3">
                                <Fluent:DropDownButton.Style>
                                    <Style TargetType="{x:Type Fluent:DropDownButton}">
                                        <Setter Property="VerticalAlignment" Value="Stretch" />
                                        <Setter Property="Width" Value="13" />
                                        <Setter Property="Foreground" Value="{DynamicResource CaptionButtonActiveIdleBrush}" />
                                        <Setter Property="SnapsToDevicePixels" Value="True" />
                                        <Setter Property="UseLayoutRounding" Value="True" />
                                        <Setter Property="Effect">
                                            <Setter.Value>
                                                <DropShadowEffect x:Name="DropShadow" Color="Black" Direction="320" ShadowDepth="3"
                                              BlurRadius="10" Opacity="0.5" />
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Icon">
                                            <Setter.Value>
                                                <StackPanel Orientation="Vertical" Width="7" VerticalAlignment="Center">
                                                    <Rectangle HorizontalAlignment="Stretch" Height="1" Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Fluent:DropDownButton}}}" Stroke="Transparent" StrokeThickness="0" Margin="0,0,0,2"/>
                                                    <Path Data="M 0 0 L 2 2 L 4 0 Z" HorizontalAlignment="Center" Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Fluent:DropDownButton}}}" Stroke="Transparent" StrokeThickness="0"/>
                                                </StackPanel>
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type Fluent:DropDownButton}">
                                                    <Grid Margin="0,3,0,0">
                                                        <Border x:Name="PART_ButtonBorder" BorderThickness="1" Background="Transparent" BorderBrush="Transparent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="13">
                                                            <!--Image x:Name="iconImage" HorizontalAlignment="Center" VerticalAlignment="Center" Stretch="None" Source="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={x:Static converters:ObjectToImageConverter}, ConverterParameter='8,8'}" Width="8" Margin="-3,0,2,0" /-->
                                                            <ContentControl Content="{TemplateBinding Icon}" Foreground="{TemplateBinding Foreground}" />
                                                        </Border>
                                                        <Popup x:Name="PART_Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" Margin="0,0,-4,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                                                            <Grid Name="DropDown" SnapsToDevicePixels="True" Margin="0" VerticalAlignment="Top">
                                                                <Border x:Name="PART_DropDownBorder" MinWidth="{TemplateBinding ActualWidth}" SnapsToDevicePixels="True" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BorderBrush}" BorderThickness="1" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                                    <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                                        <Border VerticalAlignment="Top" Width="Auto" Height="Auto" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.BackgroundBrush}" BorderThickness="1" />
                                                                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                                            <Grid.RowDefinitions>
                                                                                <RowDefinition Height="*" />
                                                                                <RowDefinition Height="Auto" />
                                                                            </Grid.RowDefinitions>
                                                                            <ScrollViewer Margin="1" MaxHeight="{TemplateBinding MaxDropDownHeight}" SnapsToDevicePixels="True" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Hidden">
                                                                                <StackPanel x:Name="PART_MenuPanel" Orientation="Vertical" IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                                                            </ScrollViewer>
                                                                            <Border x:Name="resizeBorder" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="11" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BorderBrush}" BorderThickness="0,1,0,0" Grid.Row="1" Background="{DynamicResource Fluent.Ribbon.Brushes.DropDown.Resize.BackgoundBrush}">
                                                                                <Grid>
                                                                                    <Thumb x:Name="PART_ResizeVerticalThumb" HorizontalAlignment="Stretch" Margin="0,0,0,-90" Width="Auto" Height="10" VerticalAlignment="Top" Cursor="SizeNS" Template="{DynamicResource ResizeVerticalThumbControlTemplate}" />
                                                                                    <Thumb x:Name="PART_ResizeBothThumb" HorizontalAlignment="Right" Margin="0,0,0,-90" Width="10" Height="10" VerticalAlignment="Top" Cursor="SizeNWSE" Template="{DynamicResource ResizeBothThumbControlTemplate}" />
                                                                                </Grid>
                                                                            </Border>
                                                                        </Grid>
                                                                    </Grid>
                                                                </Border>
                                                            </Grid>
                                                        </Popup>
                                                    </Grid>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="ResizeMode" Value="None">
                                                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Collapsed" />
                                                        </Trigger>
                                                        <Trigger Property="ResizeMode" Value="Both">
                                                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Collapsed" />
                                                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Visible" />
                                                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                                                        </Trigger>
                                                        <Trigger Property="ResizeMode" Value="Vertical">
                                                            <Setter Property="Visibility" TargetName="PART_ResizeBothThumb" Value="Collapsed" />
                                                            <Setter Property="Visibility" TargetName="PART_ResizeVerticalThumb" Value="Visible" />
                                                            <Setter Property="Visibility" TargetName="resizeBorder" Value="Visible" />
                                                        </Trigger>
                                                        <Trigger Property="Size" Value="Middle">
                                                            <Setter Property="VerticalAlignment" TargetName="PART_ButtonBorder" Value="Stretch" />
                                                        </Trigger>
                                                        <Trigger Property="IsDropDownOpen" Value="True">
                                                            <!--Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                                                            <Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" /-->
                                                            <Setter Property="Foreground" Value="{DynamicResource CaptionButtonActivePressedBrush}"/>
                                                        </Trigger>
                                                        <MultiTrigger>
                                                            <MultiTrigger.Conditions>
                                                                <Condition Property="IsMouseOver" Value="True" />
                                                                <Condition Property="IsDropDownOpen" Value="False" />
                                                            </MultiTrigger.Conditions>
                                                            <Setter Property="Foreground" Value="{DynamicResource CaptionButtonActiveHoverBrush}"/>
                                                            <!--Setter Property="Background" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.Background}" />
                                                            <Setter Property="BorderBrush" TargetName="PART_ButtonBorder" Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" /-->
                                                        </MultiTrigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Fluent:DropDownButton.Style>
                                <!--Icon="pack://application:,,,/Fluent;Component/Themes/Images/QuickAccessToolBarDropDown.png"-->
                                <Fluent:GroupSeparatorMenuItem Style="{DynamicResource MenuGroupSeparatorStyle}" Header="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarMenuHeader, Mode=OneWay}" />
                                <StackPanel x:Name="PART_MenuPanel" />
                                <Separator x:Name="menuSeparator" Style="{DynamicResource MenuSeparatorStyle}" />
                                <Fluent:MenuItem x:Name="PART_ShowBelow" CanAddToQuickAccessToolBar="False" Header="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarMenuShowBelow, Mode=OneWay}" />
                                <Fluent:MenuItem x:Name="PART_ShowAbove" CanAddToQuickAccessToolBar="False" Header="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarMenuShowAbove, Mode=OneWay}" Visibility="Collapsed" />
                            </Fluent:DropDownButton>
                        </ContentControl>
                        <Fluent:DropDownButton x:Name="PART_ToolbarDownButton" HorizontalAlignment="Right" Width="13" Visibility="Collapsed" VerticalAlignment="Stretch" Style="{DynamicResource ToolbarDropDownButtonStyle}" Height="22" DockPanel.Dock="Right" Fluent:KeyTip.Keys="00" Size="Small" IsEnabled="{TemplateBinding IsEnabled}" Icon="pack://application:,,,/Fluent;Component/Themes/Images/QuickAccessToolBarExtender.png" ToolTip="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.QuickAccessToolBarMoreControlsButtonTooltip, Mode=OneWay}" KeyboardNavigation.TabIndex="2" KeyboardNavigation.TabNavigation="Local">
                            <Fluent:DropDownButton.ContextMenu>
                                <ContextMenu/>
                            </Fluent:DropDownButton.ContextMenu>

                            <StackPanel Orientation="Horizontal" Background="{TemplateBinding Background}" Width="Auto" Height="26" Margin="-1">
                                <StackPanel Orientation="Horizontal" x:Name="PART_ToolBarOverflowPanel" HorizontalAlignment="Left" Width="Auto" Height="Auto" VerticalAlignment="Center" Margin="1,0,0,0" />
                                <Label x:Name="popupContentControl" VerticalAlignment="Center" HorizontalAlignment="Left" Width="13" Background="{x:Null}" Height="22" Focusable="False" Padding="0" Margin="1,0" />
                            </StackPanel>
                        </Fluent:DropDownButton>
                        <StackPanel x:Name="PART_ToolBarPanel" Orientation="Horizontal" Width="Auto" Height="Auto" VerticalAlignment="Stretch" KeyboardNavigation.TabNavigation="Local" KeyboardNavigation.TabIndex="1"/>
                    </DockPanel>
                    <ControlTemplate.Triggers>
                        <Trigger Property="CanQuickAccessLocationChanging" Value="False">
                            <Setter Property="Visibility" TargetName="PART_ShowBelow" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ShowAbove" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="menuSeparator" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ShowAboveRibbon" Value="False">
                            <Setter Property="Visibility" TargetName="PART_ShowBelow" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_ShowAbove" Value="Visible" />
                        </Trigger>
                        <Trigger Property="HasOverflowItems" Value="True">
                            <Setter Property="Visibility" TargetName="PART_ToolbarDownButton" Value="Visible" />
                            <Setter Property="Content" TargetName="popupContentControl" Value="{Binding ElementName=PART_MenuDownButton, Mode=OneWay}" />
                            <Setter Property="Content" TargetName="menuContentControl" Value="{x:Null}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:RibbonTitleBar}"
           TargetType="{x:Type Fluent:RibbonTitleBar}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="HeaderTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center" Text="{Binding}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" />
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:RibbonTitleBar}">
                    <Grid>
                        <ContentPresenter x:Name="PART_QuickAccessToolbarHolder" ContentSource="QuickAccessToolBar" />
                        <ContentPresenter x:Name="PART_HeaderHolder" ContentSource="Header" ContentStringFormat="{TemplateBinding HeaderStringFormat}" ContentTemplate="{TemplateBinding HeaderTemplate}" ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" IsHitTestVisible="False" />
                        <Fluent:RibbonContextualGroupsContainer x:Name="PART_ItemsContainer" IsItemsHost="True" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsCollapsed" Value="True">
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_QuickAccessToolbarHolder" />
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_ItemsContainer" />
                        </Trigger>
                        <Trigger Property="HideContextTabs" Value="True">
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_ItemsContainer" />
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_QuickAccessToolbarHolder" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:Ribbon}" TargetType="{x:Type Fluent:Ribbon}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
        <Setter Property="FocusVisualStyle" Value="{DynamicResource PlexFocusVisualStyle}" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="Fluent:FrameworkHelper.UseLayoutRounding" Value="True" />
        <!--Setter Property="IsManipulationEnabled" Value="True"/-->
        <Setter Property="QuickAccessToolBarHeight" Value="{Binding TitleBarHeight, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type plex:PlexWindow}}}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:Ribbon}">
                    <ControlTemplate.Resources>
                        <Style x:Key="{x:Type Separator}" BasedOn="{StaticResource PlexRibbonSeparatorStyle}" TargetType="{x:Type Separator}"/>
                        <Style BasedOn="{StaticResource FluentRibbonDefaultContextMenuStyle}" TargetType="{x:Type ContextMenu}" />
                    </ControlTemplate.Resources>
                    <Grid>
                        <Border Background="Transparent" BorderThickness="0" BorderBrush="Transparent">
                            <Grid x:Name="PART_LayoutRoot" Width="Auto" Height="Auto">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <Fluent:RibbonTabControl x:Name="PART_RibbonTabControl"
                                         Menu="{TemplateBinding Menu}"
                                         ContentHeight="{TemplateBinding ContentHeight}"
                                         ContextMenu="{Binding ContextMenu, ElementName=PART_LayoutRoot}"
                                         IsMouseWheelScrollingEnabled="{TemplateBinding IsMouseWheelScrollingEnabled}" ClipToBounds="False" />
                                <ContentControl x:Name="quickAccessToolBarHolder"
                            Grid.Row="1"
                            HorizontalAlignment="Left" Height="{TemplateBinding QuickAccessToolBarHeight}">
                                    <Fluent:QuickAccessToolBar x:Name="PART_QuickAccessToolBar" ShowAboveRibbon="{Binding ShowQuickAccessToolBarAboveRibbon, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" IsMenuDropDownVisible="{TemplateBinding IsQuickAccessToolBarMenuDropDownVisible}" HorizontalAlignment="Left" Focusable="False" />
                                </ContentControl>
                            </Grid>
                        </Border>
                        <Border Background="Transparent" BorderBrush="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderThickness="0,0,0,1" CornerRadius="0" Height="10" VerticalAlignment="Bottom" IsHitTestVisible="False">
                            <Border.OpacityMask>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="Transparent"/>
                                        <GradientStop Offset="0.5" Color="White"/>
                                        <GradientStop Offset="1" Color="Transparent"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.OpacityMask>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsQuickAccessToolBarVisible"
                     Value="False">
                            <Setter Property="Visibility"
                        TargetName="quickAccessToolBarHolder"
                        Value="Collapsed" />
                            <Setter Property="Visibility"
                        TargetName="PART_QuickAccessToolBar"
                        Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="IsCollapsed" Value="True">
                            <Setter Property="Visibility"
                        TargetName="PART_RibbonTabControl"
                        Value="Collapsed" />
                            <Setter Property="Visibility"
                        TargetName="quickAccessToolBarHolder"
                        Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="ShowQuickAccessToolBarAboveRibbon" Value="True">
                            <Setter Property="Content"
                        TargetName="quickAccessToolBarHolder"
                        Value="{x:Null}" />
                            <Setter Property="Visibility"
                        TargetName="quickAccessToolBarHolder"
                        Value="Collapsed" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:RibbonTabControl}" TargetType="{x:Type Fluent:RibbonTabControl}">
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="ClipToBounds" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:RibbonTabControl}">
                    <ControlTemplate.Resources>
                        <Style TargetType="{x:Type ScrollViewer}">
                            <Setter Property="CanContentScroll" Value="True" />
                            <Setter Property="HorizontalScrollBarVisibility" Value="Auto" />
                            <Setter Property="VerticalScrollBarVisibility" Value="Disabled" />
                            <Setter Property="PanningMode" Value="HorizontalOnly" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ScrollViewer}">
                                        <Grid x:Name="Grid" Background="{TemplateBinding Background}" IsHitTestVisible="True">
                                            <ScrollContentPresenter Width="{TemplateBinding ActualWidth}" Margin="{TemplateBinding Padding}" x:Name="PART_ScrollContentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" CanContentScroll="{TemplateBinding CanContentScroll}" IsHitTestVisible="True" ClipToBounds="False" />
                                            <RepeatButton Command="{x:Static ScrollBar.LineLeftCommand}" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" Focusable="false" HorizontalAlignment="Left" Width="13" Height="Auto" VerticalAlignment="Stretch" Style="{DynamicResource ScrollButtonStyle}">
                                                <RepeatButton.Visibility>
                                                    <MultiBinding FallbackValue="Visibility.Collapsed" Converter="{StaticResource MenuScrollingVisibilityConverter}" ConverterParameter="0">
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ComputedHorizontalScrollBarVisibility" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="HorizontalOffset" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ExtentWidth" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ViewportWidth" />
                                                    </MultiBinding>
                                                </RepeatButton.Visibility>
                                                <Path Fill="{DynamicResource BlackBrush}" Stretch="Fill" Stroke="{x:Null}" StrokeThickness="0" HorizontalAlignment="Center" Margin="0" VerticalAlignment="Center" Width="3" Height="5" Data="M0,0L1,1 1,-1z" />
                                            </RepeatButton>
                                            <RepeatButton Command="{x:Static ScrollBar.LineRightCommand}" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" Focusable="false" HorizontalAlignment="Right" Width="13" Height="Auto" VerticalAlignment="Stretch" Style="{DynamicResource ScrollButtonStyle}">
                                                <RepeatButton.Visibility>
                                                    <MultiBinding FallbackValue="Visibility.Collapsed" Converter="{StaticResource MenuScrollingVisibilityConverter}" ConverterParameter="100">
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ComputedHorizontalScrollBarVisibility" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="HorizontalOffset" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ExtentWidth" />
                                                        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ViewportWidth" />
                                                    </MultiBinding>
                                                </RepeatButton.Visibility>
                                                <Path Fill="{DynamicResource BlackBrush}" Stretch="Fill" Stroke="{x:Null}" StrokeThickness="0" HorizontalAlignment="Center" Margin="0" VerticalAlignment="Center" Width="3" Height="5" Data="M1,0L0,1 0,-1z" />
                                            </RepeatButton>
                                        </Grid>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                        <Style x:Key="{x:Type Separator}" BasedOn="{StaticResource PlexRibbonSeparatorStyle}" TargetType="{x:Type Separator}"/>
                    </ControlTemplate.Resources>
                    <Grid x:Name="ContentGrid" Background="{TemplateBinding Background}" KeyboardNavigation.TabNavigation="Local" Height="Auto" VerticalAlignment="Top">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <!--RowDefinition x:Name="rowDefinition" MinHeight="{TemplateBinding ContentHeight}" MaxHeight="{TemplateBinding ContentHeight}" />
                            <RowDefinition x:Name="rowDefinition1" MinHeight="{TemplateBinding ContentGapHeight}" MaxHeight="{TemplateBinding ContentGapHeight}" /-->
                            <RowDefinition x:Name="rowDefinition" MinHeight="0" MaxHeight="{TemplateBinding ContentHeight}" />
                            <RowDefinition x:Name="rowDefinition1" MinHeight="0" MaxHeight="{TemplateBinding ContentGapHeight}" />
                        </Grid.RowDefinitions>
                        <Border x:Name="border" HorizontalAlignment="Stretch" Margin="0,-1,0,0" Width="Auto" BorderThickness="0" Grid.Row="1" BorderBrush="Transparent" />
                        <Border x:Name="mainContentControlBorder" Height="94" HorizontalAlignment="Stretch" Margin="1,0,1,0" Grid.Row="1" Grid.RowSpan="1" Background="Transparent" BorderBrush="Transparent" BorderThickness="0" TextElement.Foreground="{DynamicResource PlexRibbonForegroundBrush}" KeyboardNavigation.TabNavigation="Local" KeyboardNavigation.DirectionalNavigation="Contained" KeyboardNavigation.TabIndex="2">
                            <ContentControl x:Name="mainContentControl" Margin="0" Focusable="False">
                                <ContentPresenter ContentSource="SelectedContent" x:Name="PART_SelectedContentPresenter" HorizontalAlignment="Stretch" Margin="0" />
                            </ContentControl>
                        </Border>
                        <Border Margin="0" VerticalAlignment="Stretch" Grid.Row="2" Background="{Binding Path=SelectedItem.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                        <Grid x:Name="TabsGrid" Background="Transparent" TextElement.Foreground="{DynamicResource PlexRibbonForegroundBrush}" HorizontalAlignment="Stretch" Width="Auto" Margin="0" Grid.Row="0" KeyboardNavigation.TabIndex="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Fluent:WindowSteeringHelperControl Grid.ColumnSpan="4" />
                            <ContentPresenter Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" ContentSource="Menu" />
                            <Fluent:RibbonScrollViewer Grid.Column="1"  HorizontalAlignment="Stretch" Margin="0" Width="Auto" Style="{DynamicResource RibbonTabScrollViewer}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" IsHitTestVisible="True" IsTabStop="False">
                                <!--Visibility="{Binding AreTabHeadersVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}"-->
                                <Fluent:RibbonTabsContainer x:Name="PART_TabsContainer" IsItemsHost="True" Height="Auto" HorizontalAlignment="Stretch" Margin="0" KeyboardNavigation.TabIndex="1" />
                            </Fluent:RibbonScrollViewer>
                            <StackPanel HorizontalAlignment="Right" Grid.Column="3" Orientation="Horizontal" Margin="0,0,0,-1">
                                <Grid>
                                    <Image x:Name="image" Width="22" Height="22" Source="/Fluent;Component/Themes/Images/RibbonPin.png" Stretch="None" Visibility="Collapsed" />
                                    <Fluent:ToggleButton x:Name="PART_MinimizeButton" Margin="0" Width="22" VerticalAlignment="Stretch" Size="Small" IsChecked="{Binding Path=IsMinimized, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding CanMinimize, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <Fluent:ToggleButton.Style>
                                            <Style TargetType="{x:Type Fluent:ToggleButton}">
                                                <Setter Property="Width" Value="22" />
                                                <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
                                                <Setter Property="CanAddToQuickAccessToolBar" Value="False" />
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type Fluent:ToggleButton}">
                                                            <Grid Background="#01000000">
                                                                <Grid x:Name="HoverBackground" Opacity="0" ClipToBounds="False" IsHitTestVisible="False">
                                                                    <Border Margin="0" Background="{DynamicResource PlexGlowToggleButtonHoverBackground}" BorderBrush="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderThickness="2" RenderTransformOrigin="0.5,0.5" CornerRadius="0,8,0,0" ClipToBounds="False" IsHitTestVisible="False">
                                                                        <Border.ToolTip>
                                                                            <Fluent:ScreenTip x:Name="screenTip" Title="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.MinimizeButtonScreenTipTitle, Mode=OneWay}" Text="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.MinimizeButtonScreenTipText, Mode=OneWay}" />
                                                                        </Border.ToolTip>
                                                                    </Border>
                                                                    <Border Background="Transparent" BorderBrush="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderThickness="0,1,1,0" CornerRadius="0,8,0,0" Height="8" VerticalAlignment="Top" Margin="-100,-1,0,1" IsHitTestVisible="False">
                                                                        <Border.OpacityMask>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                <LinearGradientBrush.GradientStops>
                                                                                    <GradientStop Offset="0" Color="Transparent"/>
                                                                                    <GradientStop Offset="1" Color="White"/>
                                                                                </LinearGradientBrush.GradientStops>
                                                                            </LinearGradientBrush>
                                                                        </Border.OpacityMask>
                                                                    </Border>
                                                                    <Border Background="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderBrush="Transparent" BorderThickness="0" Height="1" VerticalAlignment="Bottom" Margin="-100,0,0,0" IsHitTestVisible="False">
                                                                        <Border.OpacityMask>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                <LinearGradientBrush.GradientStops>
                                                                                    <GradientStop Offset="0" Color="Transparent"/>
                                                                                    <GradientStop Offset="1" Color="White"/>
                                                                                </LinearGradientBrush.GradientStops>
                                                                            </LinearGradientBrush>
                                                                        </Border.OpacityMask>
                                                                    </Border>
                                                                </Grid>
                                                                <Grid UseLayoutRounding="True">
                                                                    <Grid.Effect>
                                                                        <DropShadowEffect Color="Black" Direction="320" ShadowDepth="3"
                                              BlurRadius="10" Opacity="0.5" />
                                                                    </Grid.Effect>
                                                                    <Path x:Name="iconImage" Fill="{DynamicResource CaptionButtonActiveIdleBrush}" Stroke="{DynamicResource CaptionButtonActiveIdleBrush}" StrokeThickness="1" Data="M 0 5 L 4 0 L 8 5 Z" HorizontalAlignment="Center" VerticalAlignment="Center" UseLayoutRounding="True"/>
                                                                    <Path x:Name="iconImageChecked" Fill="{DynamicResource CaptionButtonActiveIdleBrush}" Stroke="{DynamicResource CaptionButtonActiveIdleBrush}" StrokeThickness="1" Data="M 0 0 L 4 5 L 8 0 Z" HorizontalAlignment="Center" VerticalAlignment="Center" UseLayoutRounding="True" Visibility="Collapsed"/>
                                                                </Grid>
                                                            </Grid>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsChecked" Value="True">
                                                                    <Setter Property="Visibility" TargetName="iconImage" Value="Collapsed" />
                                                                    <Setter Property="Visibility" TargetName="iconImageChecked" Value="Visible" />
                                                                    <Setter Property="Title" TargetName="screenTip" Value="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.ExpandButtonScreenTipTitle , Mode=OneWay}" />
                                                                    <Setter Property="Text" TargetName="screenTip" Value="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.ExpandButtonScreenTipText , Mode=OneWay}" />
                                                                </Trigger>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Trigger.EnterActions>
                                                                        <BeginStoryboard>
                                                                            <Storyboard>
                                                                                <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                                                            </Storyboard>
                                                                        </BeginStoryboard>
                                                                    </Trigger.EnterActions>
                                                                    <Trigger.ExitActions>
                                                                        <BeginStoryboard>
                                                                            <Storyboard>
                                                                                <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                                                            </Storyboard>
                                                                        </BeginStoryboard>
                                                                    </Trigger.ExitActions>
                                                                    <Setter Property="Foreground" Value="{DynamicResource PlexRibbonDarkForegroundBrush}" />
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Fluent:ToggleButton.Style>
                                    </Fluent:ToggleButton>
                                </Grid>
                                <StackPanel x:Name="PART_ToolbarPanel" Visibility="{Binding IsQuickAccessToolBarVisible, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Fluent:Ribbon}}, Converter={StaticResource BoolToVisibilityConverter}}" Orientation="Horizontal" />
                            </StackPanel>
                        </Grid>
                        <Border Background="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderBrush="Transparent" BorderThickness="0" Height="1" VerticalAlignment="Bottom" Margin="0" IsHitTestVisible="False" Grid.Row="0">
                            <Border.OpacityMask>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="Transparent"/>
                                        <GradientStop Offset="0.5" Color="White"/>
                                        <GradientStop Offset="1" Color="Transparent"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.OpacityMask>
                        </Border>
                        <Popup x:Name="PART_Popup" PlacementTarget="{Binding Path=SelectedTabItem, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" Placement="Custom" StaysOpen="True" AllowsTransparency="True" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" IsOpen="{TemplateBinding IsDropDownOpen}" HorizontalOffset="0" VerticalOffset="-10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition MinHeight="20"
                                       MaxHeight="20" />
                                    <RowDefinition MinHeight="{TemplateBinding ContentHeight}" MaxHeight="{TemplateBinding ContentHeight}" />
                                    <RowDefinition MinHeight="{TemplateBinding ContentGapHeight}" MaxHeight="{TemplateBinding ContentGapHeight}" />
                                    <RowDefinition Height="20" />
                                </Grid.RowDefinitions>
                                <Border Grid.Row="1"  Grid.RowSpan="2" BorderThickness="0" Margin="1,0" BorderBrush="Transparent" Background="Transparent" TextElement.Foreground="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.Content.Foreground}" KeyboardNavigation.TabNavigation="Local" KeyboardNavigation.DirectionalNavigation="Contained">
                                    <ContentControl x:Name="popupContentControl" Focusable="False" Margin="0" />
                                </Border>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMinimized" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="mainContentControlBorder" Storyboard.TargetProperty="Height" To="0" Duration="0:0:0.25">
                                            <DoubleAnimation.EasingFunction>
                                                <QuinticEase EasingMode="EaseOut"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <!--ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="RibbonTabControl.IsManipulationEnabled">
                                            <ObjectAnimationUsingKeyFrames.KeyFrames>
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False"/>
                                            </ObjectAnimationUsingKeyFrames.KeyFrames>
                                        </ObjectAnimationUsingKeyFrames-->
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="mainContentControlBorder" Storyboard.TargetProperty="Height" To="94" Duration="0:0:0.25">
                                            <DoubleAnimation.EasingFunction>
                                                <QuinticEase EasingMode="EaseOut"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <!--ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="RibbonTabControl.IsManipulationEnabled">
                                            <ObjectAnimationUsingKeyFrames.KeyFrames>
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0.25" Value="True"/>
                                            </ObjectAnimationUsingKeyFrames.KeyFrames>
                                        </ObjectAnimationUsingKeyFrames-->
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <!--Setter Property="MinHeight" TargetName="rowDefinition" Value="0" />
                            <Setter Property="MinHeight" TargetName="rowDefinition1" Value="0" /-->
                            <!--Setter TargetName="mainContentControlBorder" Property="Height" Value="0"/-->
                            <Setter Property="Content" TargetName="popupContentControl" Value="{Binding ElementName=PART_SelectedContentPresenter, Mode=OneWay}" />
                            <Setter Property="Visibility" TargetName="image" Value="Collapsed" />
                        </Trigger>
                        <!--/Trigger-->
                        <Trigger SourceName="mainContentControlBorder" Property="Height" Value="0">
                            <Setter TargetName="mainContentControl" Property="Content" Value="{x:Null}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsDropDownOpen" Value="True" />
                                <Condition Property="IsMinimized" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Visibility" TargetName="image" Value="Visible" />
                            <Setter Property="Opacity" TargetName="PART_MinimizeButton" Value="0" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:RibbonTabItem}" TargetType="{x:Type Fluent:RibbonTabItem}">
        <Setter Property="FocusVisualStyle" Value="{DynamicResource PlexRibbonTabFocusVisualStyle}" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="Height" Value="Auto" />
        <Setter Property="Margin" Value="-100,0" />
        <Setter Property="IsMinimized" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:RibbonTabControl}}, Path=IsMinimized, Mode=OneWay, FallbackValue=False}" />
        <Setter Property="IsOpen" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:RibbonTabControl}}, Path=IsDropDownOpen, Mode=OneWay, FallbackValue=True}" />
        <Setter Property="Indent" Value="12" />
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="ActiveTabBackground" Value="Transparent" />
        <Setter Property="ActiveTabBorderBrush" Value="Transparent" />
        <Setter Property="Fluent:RibbonProperties.MouseOverBackground" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.MouseOver.Background}" />
        <Setter Property="Fluent:RibbonProperties.AppTheme" Value="{DynamicResource Fluent.Ribbon.AppTheme}" />
        <Setter Property="ClipToBounds" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:RibbonTabItem}">
                    <ControlTemplate.Resources>
                        <!--Style x:Key="{x:Type Fluent:Button}" BasedOn="{StaticResource PlexRibbonButtonStyle}" TargetType="{x:Type Fluent:Button}"/-->
                    </ControlTemplate.Resources>
                    <Grid x:Name="grid" Height="Auto" Margin="0" ClipToBounds="False">
                        <Grid x:Name="HoverBackground" Opacity="0" ClipToBounds="False" IsHitTestVisible="False">
                            <Border Margin="100,2,100,0" Background="{DynamicResource PlexGlowToggleButtonHoverBackground}" BorderBrush="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderThickness="2" RenderTransformOrigin="0.5,0.5" ClipToBounds="False" IsHitTestVisible="False">
                                <Border.RenderTransform>
                                    <RotateTransform Angle="0"/>
                                </Border.RenderTransform>
                                <Border.OpacityMask>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="#00000000"/>
                                            <GradientStop Offset="0.875" Color="#FF000000"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.OpacityMask>
                            </Border>
                            <Border Background="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderBrush="Transparent" BorderThickness="0" Height="1" VerticalAlignment="Top" Margin="0,1" IsHitTestVisible="False">
                                <Border.OpacityMask>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="Transparent"/>
                                            <GradientStop Offset="0.5" Color="White"/>
                                            <GradientStop Offset="1" Color="Transparent"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.OpacityMask>
                            </Border>
                        </Grid>
                        <Border x:Name="groupBorder" Margin="100,0,100,1" BorderThickness="0" Background="{Binding Group.Background, RelativeSource={RelativeSource TemplatedParent}, FallbackValue=Transparent}" OpacityMask="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.Contextual.Background.OpacityMask}" />
                        <Grid x:Name="selectedBorder" Opacity="0" ClipToBounds="False" IsHitTestVisible="False">
                            <Border Margin="100,2,100,0" Background="{DynamicResource PlexGlowToggleButtonHoverBackground}" BorderBrush="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderThickness="2" RenderTransformOrigin="0.5,0.5" ClipToBounds="False" IsHitTestVisible="False"/>
                            <Border Background="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderBrush="Transparent" BorderThickness="0" Height="1" VerticalAlignment="Top" Margin="0,1" IsHitTestVisible="False">
                                <Border.OpacityMask>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="Transparent"/>
                                            <GradientStop Offset="0.5" Color="White"/>
                                            <GradientStop Offset="1" Color="Transparent"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.OpacityMask>
                            </Border>
                            <Border Background="{DynamicResource PlexGlowToggleButtonHoverBorderBrush}" BorderBrush="Transparent" BorderThickness="0" Height="1" VerticalAlignment="Bottom" Margin="0" IsHitTestVisible="False">
                                <Border.OpacityMask>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="Transparent"/>
                                            <GradientStop Offset="0.5" Color="White"/>
                                            <GradientStop Offset="1" Color="Transparent"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.OpacityMask>
                            </Border>
                        </Grid>
                        <Border x:Name="PART_ContentContainer" HorizontalAlignment="Stretch" Margin="106,2,104,0" VerticalAlignment="Stretch" Padding="15,0,0,0" BorderThickness="0" BorderBrush="Transparent">
                            <ContentControl AutomationProperties.Name="{TemplateBinding Header}" AutomationProperties.AutomationId="{TemplateBinding Name}" Content="{TemplateBinding Header}" ContentTemplate="{TemplateBinding HeaderTemplate}" Margin="5,1,5,4" HorizontalAlignment="Center" VerticalAlignment="Center" Height="Auto" />
                        </Border>
                        <Grid x:Name="separatorGrid" Margin="0" Visibility="Collapsed" HorizontalAlignment="Right" Width="1">
                            <Separator Style="{DynamicResource PlexRibbonSeparatorStyle}" HorizontalAlignment="Right" Width="1"/>
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" TargetName="PART_ContentContainer" Value="0.5" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="Selector.IsSelected" Value="False" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource PlexRibbonDarkForegroundBrush}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasRightGroupBorder" Value="False" />
                                <Condition Property="HasLeftGroupBorder" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Margin" TargetName="groupBorder" Value="2,0,0,0" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasLeftGroupBorder" Value="False" />
                                <Condition Property="HasRightGroupBorder" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Margin" TargetName="groupBorder" Value="0,0,2,0" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasLeftGroupBorder" Value="False" />
                                <Condition Property="HasRightGroupBorder" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Margin" TargetName="groupBorder" Value="0,0,0,0" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasLeftGroupBorder" Value="True" />
                                <Condition Property="HasRightGroupBorder" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Margin" TargetName="groupBorder" Value="2,0,2,0" />
                        </MultiTrigger>
                        <Trigger Property="Group" Value="{x:Null}">
                            <Setter Property="Visibility" TargetName="groupBorder" Value="Collapsed" />
                            <Setter Property="Margin" TargetName="separatorGrid" Value="-1,0,0,1" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Selector.IsSelected" Value="True" />
                                <Condition Property="IsMinimized" Value="False" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="selectedBorder" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="selectedBorder" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource PlexRibbonDarkForegroundBrush}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Selector.IsSelected" Value="True" />
                                <Condition Property="IsMinimized" Value="False" />
                                <Condition Property="Group" Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="selectedBorder" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="selectedBorder" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource PlexRibbonDarkForegroundBrush}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Selector.IsSelected"
                               Value="True" />
                                <Condition Property="IsMinimized"
                               Value="True" />
                                <Condition Property="IsOpen"
                               Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Opacity" TargetName="selectedBorder" Value="1" />
                            <Setter Property="Background"
                        TargetName="grid"
                        Value="Transparent" />
                            <Setter Property="Foreground"
                        Value="{Binding Group.Foreground}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Selector.IsSelected"
                               Value="True" />
                                <Condition Property="IsMinimized"
                               Value="True" />
                                <Condition Property="IsOpen"
                               Value="True" />
                                <Condition Property="Group"
                               Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Opacity" TargetName="selectedBorder" Value="1" />
                            <Setter Property="Background"
                        TargetName="grid"
                        Value="Transparent" />
                            <!--Setter Property="Foreground"
                        Value="{Binding Path=(Fluent:RibbonProperties.MouseOverForeground), RelativeSource={RelativeSource Self}}" /-->
                        </MultiTrigger>
                        <Trigger Property="IsSeparatorVisible"
                     Value="True">
                            <Setter Property="Visibility"
                        TargetName="separatorGrid"
                        Value="Visible" />
                            <Setter Property="Margin"
                        TargetName="PART_ContentContainer"
                        Value="6,2,6,0" />
                        </Trigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding IsContextual, RelativeSource={RelativeSource TemplatedParent}}" Value="True" />
                                <Condition Binding="{Binding Group.Visibility, RelativeSource={RelativeSource TemplatedParent}}" Value="Collapsed" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Visibility" Value="Collapsed" />
                        </MultiDataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="HeaderTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               Text="{Binding}"
                               TextWrapping="NoWrap"
                               TextTrimming="None" />
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Fluent:RibbonProperties.AppTheme"
                     Value="BaseLight">
                <Setter Property="Fluent:RibbonProperties.MouseOverForeground"
                        Value="{DynamicResource Fluent.Ribbon.Brushes.HighlightBrush}" />
            </Trigger>
            <Trigger Property="Fluent:RibbonProperties.AppTheme"
                     Value="BaseDark">
                <Setter Property="Fluent:RibbonProperties.MouseOverForeground"
                        Value="{DynamicResource BlackBrush}" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:Backstage}" TargetType="{x:Type Fluent:Backstage}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="Fluent:FrameworkHelper.UseLayoutRounding" Value="True" />
        <Setter Property="Fluent:KeyTip.Keys" Value="{Binding Source={x:Static Fluent:RibbonLocalization.Current}, Path=Localization.BackstageButtonKeyTip, Mode=OneWay}" />
        <Setter Property="HideAnimationDuration" Value="0:0:0.3" />
        <Setter Property="HideContextTabsOnOpen" Value="True" />
        <Setter Property="IsOpenAnimationEnabled" Value="{DynamicResource {x:Static SystemParameters.ClientAreaAnimationKey}}" />
        <Setter Property="Fluent:RibbonProperties.AppTheme" Value="{DynamicResource Fluent.Ribbon.AppTheme}" />
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Width" Value="49"/>
        <Setter Property="Height" Value="48"/>
        <Setter Property="Margin" Value="0,-23,0,-1"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:Backstage}">
                    <Border x:Name="border2" Background="Transparent" Margin="0">
                        <Grid>
                            <Border Background="#FF3566A4" BorderBrush="#FF3566A4" BorderThickness="0,0,1,1" CornerRadius="0,0,24,0" Margin="1,24,0,0">
                                <Border Background="#FF528CD8" BorderBrush="#FF528CD8" BorderThickness="0" CornerRadius="0,0,23,0" Margin="-1,-1,0,0"/>
                            </Border>
                            <Grid Margin="8,7,9,9">
                                <Grid x:Name="IdleBackground" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                              Margin="0" Background="Transparent" Opacity="1">
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonIdlePrimaryFillBrush}"/>
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonIdleSecondaryFillBrush}"/>
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonIdleTertiaryFillBrush}"/>
                                </Grid>
                                <Grid x:Name="HoverBackground" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                              Margin="0" Background="Transparent" Opacity="0">
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonHoverPrimaryFillBrush}"/>
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonHoverSecondaryFillBrush}"/>
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonHoverTertiaryFillBrush}"/>
                                </Grid>
                                <Grid x:Name="PressedBackground" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                              Margin="0" Background="Transparent" Opacity="0">
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonPressedPrimaryFillBrush}"/>
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonPressedSecondaryFillBrush}"/>
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonPressedTertiaryFillBrush}"/>
                                </Grid>
                                <Grid x:Name="DisabledBackground" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                              Margin="0" Background="Transparent" Opacity="0">
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonDisabledPrimaryFillBrush}"/>
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonDisabledSecondaryFillBrush}"/>
                                    <Ellipse HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0" Fill="{DynamicResource RoundButtonDisabledTertiaryFillBrush}"/>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="IdleBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="PressedBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="DisabledBackground"
                                                         Storyboard.TargetProperty="Opacity" To="1"
                                                         Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="IdleBackground"
                                                         Storyboard.TargetProperty="Opacity" To="1"
                                                         Duration="0:0:0.125" />
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="PressedBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.25" />
                                        <DoubleAnimation Storyboard.TargetName="DisabledBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground"
                                                         Storyboard.TargetProperty="Opacity" To="1"
                                                         Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        <Trigger Property="IsOpen" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="PressedBackground"
                                                         Storyboard.TargetProperty="Opacity" To="1"
                                                         Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="PressedBackground"
                                                         Storyboard.TargetProperty="Opacity" To="0"
                                                         Duration="0:0:0.125" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Fluent:RibbonProperties.AppTheme" Value="BaseLight">
                <Setter Property="Background"  Value="{DynamicResource Fluent.Ribbon.Brushes.AccentBaseColorBrush}" />
                <Setter Property="Foreground" Value="{DynamicResource Fluent.Ribbon.Brushes.IdealForegroundColorBrush}" />
            </Trigger>
            <Trigger Property="Fluent:RibbonProperties.AppTheme" Value="BaseDark">
                <Setter Property="Background"  Value="{DynamicResource WhiteBrush}" />
                <Setter Property="Foreground" Value="{DynamicResource BlackBrush}" />
            </Trigger>
            <Trigger Property="IsOpenAnimationEnabled" Value="False">
                <Setter Property="HideAnimationDuration" Value="0" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="{x:Type Fluent:BackstageTabControl}" TargetType="{x:Type Fluent:BackstageTabControl}">
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonDarkForegroundBrush}" />
        <Setter Property="FocusVisualStyle" Value="{DynamicResource PlexFocusVisualStyle}" />
        <Setter Property="Background" Value="{DynamicResource WhiteBrush}" />
        <Setter Property="Fluent:RibbonProperties.AppTheme" Value="{DynamicResource Fluent.Ribbon.AppTheme}" />
        <Setter Property="SelectedContentMargin" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:BackstageTabControl}">
                    <ControlTemplate.Resources>
                        <Style x:Key="{x:Type Fluent:Button}" BasedOn="{StaticResource PlexRibbonBackstageButtonStyle}" TargetType="{x:Type Fluent:Button}"/>
                    </ControlTemplate.Resources>
                    <Grid x:Name="grid">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="164" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid x:Name="PART_ItemsPanelGrid" VerticalAlignment="Stretch">
                            <Fluent:WindowSteeringHelperControl Height="{Binding SelectedContentMargin.Top, RelativeSource={RelativeSource TemplatedParent}}" VerticalAlignment="Top" IsEnabled="{TemplateBinding IsWindowSteeringHelperEnabled}" />
                            <Button x:Name="backbutton" Style="{DynamicResource BackstageBackButtonStyle}" Width="0" Height="0" Visibility="Hidden"/>
                            <ItemsPresenter Margin="0,77,0,0" Height="Auto"/>
                        </Grid>
                        <Border x:Name="PART_SelectedContentGrid" BorderThickness="1" CornerRadius="6,6,0,0" Height="Auto" Grid.Column="1" Margin="0,50,50,0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#40FFFFFF"/>
                                        <GradientStop Offset="1" Color="#60FFFFFF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.BorderBrush>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#C0FFFFFF"/>
                                        <GradientStop Offset="0.5" Color="Transparent"/>
                                        <GradientStop Offset="1" Color="#C0FFFFFF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.BorderBrush>
                            <ContentPresenter x:Name="PART_SelectedContentHost" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Height="Auto" ContentSource="SelectedContent"/>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Visibility" Value="Visible">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <!--Style.Triggers>
            <Trigger Property="Fluent:RibbonProperties.AppTheme" Value="BaseLight">
                <Setter Property="ItemsPanelBackground" Value="{Binding ParentBackstage.Background, RelativeSource={RelativeSource Self}, FallbackValue=Red}" />
            </Trigger>
            <Trigger Property="Fluent:RibbonProperties.AppTheme" Value="BaseDark">
                <Setter Property="ItemsPanelBackground" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.Content.Background}" />
            </Trigger>
        </Style.Triggers-->
    </Style>

    <Style x:Key="{x:Type Fluent:BackstageTabItem}" TargetType="{x:Type Fluent:BackstageTabItem}">
        <Setter Property="FocusVisualStyle" Value="{DynamicResource ControlStyleEmptyFocus}" />
        <Setter Property="Height" Value="38" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{DynamicResource PlexDarkRibbonForegroundBrush}"/>
        <Setter Property="Margin" Value="0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:BackstageTabItem}">
                    <ControlTemplate.Resources>
                        <Style x:Key="{x:Type Fluent:Button}" TargetType="{x:Type Fluent:Button}" BasedOn="{StaticResource PlexRibbonButtonStyle}">
                            <Setter Property="Foreground" Value="{DynamicResource PlexRibbonDarkForegroundBrush}"/>
                        </Style>
                    </ControlTemplate.Resources>
                    <Grid x:Name="rootGrid" Background="Transparent">
                        <Border x:Name="HoverBackground" BorderThickness="1" Padding="0" Margin="0,-1,214,-1" CornerRadius="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0" MinWidth="0">
                            <Border.BorderBrush>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF599EE2"/>
                                        <GradientStop Offset="1" Color="#FF61B4FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.BorderBrush>
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF80C3FF"/>
                                        <GradientStop Offset="0.45" Color="#FF70B2FF"/>
                                        <GradientStop Offset="0.9" Color="#FF8CCEFF"/>
                                        <GradientStop Offset="1" Color="#FF83C4FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border BorderBrush="Transparent" BorderThickness="0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop x:Name="LightColorTop" Offset="0" Color="#FF1C5F9B"/>
                                            <GradientStop x:Name="LightColorMiddle" Offset="0.45" Color="#FF0C4E9B"/>
                                            <GradientStop x:Name="LightColorBottom" Offset="0.9" Color="#FF286A9B"/>
                                            <GradientStop x:Name="LightColorBottomBelow" Offset="1" Color="#FF83C4FF"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>
                        <Border x:Name="SelectedBackground" BorderThickness="1" Padding="0" Margin="0,-1,214,-1" CornerRadius="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0" MinWidth="0">
                            <Border.BorderBrush>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF599EE2"/>
                                        <GradientStop Offset="1" Color="#FF61B4FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.BorderBrush>
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FF80C3FF"/>
                                        <GradientStop Offset="0.45" Color="#FF70B2FF"/>
                                        <GradientStop Offset="0.9" Color="#FF8CCEFF"/>
                                        <GradientStop Offset="1" Color="#FF83C4FF"/>
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border BorderBrush="Transparent" BorderThickness="0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="#401C5F9B"/>
                                            <GradientStop Offset="0.45" Color="#400C4E9B"/>
                                            <GradientStop Offset="0.9" Color="#40286A9B"/>
                                            <GradientStop Offset="1" Color="#4083C4FF"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>
                        <ContentControl x:Name="PART_Header" Foreground="{DynamicResource PlexRibbonDarkForegroundBrush}" Margin="25,0,15,0" HorizontalAlignment="Left" VerticalAlignment="Center" Content="{TemplateBinding Header}"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="PART_Header" Property="Opacity" Value="0.5" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Header" Property="Foreground" Value="White" />
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125"/>
                                        <ThicknessAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Margin" To="0,-1" Duration="0:0:0.125">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5"/>
                                        <ThicknessAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Margin" To="0,-1,214,-1" Duration="0:0:0.375">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter TargetName="PART_Header" Property="Foreground" Value="White" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="True"/>
                                <Condition Property="IsMouseOver" Value="True"/>
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0.5" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorTop" Storyboard.TargetProperty="Color" To="#FF80C3FF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorMiddle" Storyboard.TargetProperty="Color" To="#FF70B2FF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottom" Storyboard.TargetProperty="Color" To="#FF8CCEFF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottomBelow" Storyboard.TargetProperty="Color" To="#FF83C4FF" Duration="0:0:0.125"/>
                                        <ThicknessAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Margin" To="0,-1" Duration="0:0:0.125">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorTop" Storyboard.TargetProperty="Color" To="#FF1C5F9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorMiddle" Storyboard.TargetProperty="Color" To="#FF0C4E9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottom" Storyboard.TargetProperty="Color" To="#FF286A9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottomBelow" Storyboard.TargetProperty="Color" To="#FF1F609B" Duration="0:0:0.375"/>
                                        <ThicknessAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Margin" To="0,-1,214,-1" Duration="0:0:0.375">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="False"/>
                                <Condition Property="IsMouseOver" Value="True"/>
                            </MultiTrigger.Conditions>
                            <MultiTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorTop" Storyboard.TargetProperty="Color" To="#FF80C3FF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorMiddle" Storyboard.TargetProperty="Color" To="#FF70B2FF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottom" Storyboard.TargetProperty="Color" To="#FF8CCEFF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottomBelow" Storyboard.TargetProperty="Color" To="#FF83C4FF" Duration="0:0:0.125"/>
                                        <ThicknessAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Margin" To="0,-1" Duration="0:0:0.125">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.EnterActions>
                            <MultiTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorTop" Storyboard.TargetProperty="Color" To="#FF1C5F9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorMiddle" Storyboard.TargetProperty="Color" To="#FF0C4E9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottom" Storyboard.TargetProperty="Color" To="#FF286A9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottomBelow" Storyboard.TargetProperty="Color" To="#FF1F609B" Duration="0:0:0.375"/>
                                        <ThicknessAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Margin" To="0,-1,214,-1" Duration="0:0:0.375">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </MultiTrigger.ExitActions>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="False"/>
                                <Condition Property="IsMouseOver" Value="False"/>
                            </MultiTrigger.Conditions>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="{x:Type Fluent:RibbonGroupBox}" TargetType="{x:Type Fluent:RibbonGroupBox}">
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Height" Value="Auto" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="Fluent:KeyTip.Margin" Value="0,15,0,0" />
        <Setter Property="Margin" Value="4" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:RibbonGroupBox}">
                    <ControlTemplate.Resources>
                        <ResourceDictionary>
                            <Style TargetType="{x:Type Separator}" BasedOn="{StaticResource PlexRibbonSeparatorStyle}" />
                        </ResourceDictionary>
                    </ControlTemplate.Resources>
                    <Grid x:Name="grid2" HorizontalAlignment="Stretch">
                        <Grid>
                            <ContentControl x:Name="border1" Focusable="False" Margin="0,0,4,0">
                                <Grid x:Name="PART_ParentPanel" Height="Auto">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Grid x:Name="PART_DownGrid" MaxWidth="{Binding ActualWidth, ElementName=PART_ParentPanel}" VerticalAlignment="Stretch" Height="Auto">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <ContentControl Content="{TemplateBinding Header}" Height="Auto" HorizontalAlignment="Stretch" Margin="2,0" />
                                        <Fluent:Button x:Name="PART_DialogLauncherButton" HorizontalAlignment="Stretch" Width="15" Height="14" Grid.Column="1" Focusable="False" IsTabStop="False" Template="{DynamicResource DialogLauncherButtonControlTemplate}" Background="Transparent" BorderBrush="Transparent" VerticalAlignment="Stretch" Icon="{TemplateBinding LauncherIcon}" />
                                    </Grid>
                                    <Fluent:RibbonGroupBoxWrapPanel x:Name="PART_UpPanel" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="Stretch" Width="Auto" Height="Auto" IsItemsHost="True" Margin="0,0,5,0" Grid.Row="1"/>
                                </Grid>
                            </ContentControl>
                            <Grid x:Name="grid1" Margin="0,0,4,0" Width="Auto" Height="Auto" Visibility="Collapsed" Grid.RowSpan="2">
                                <ContentControl Content="{TemplateBinding Header}" Style="{DynamicResource Fluent.Ribbon.Styles.RibbonGroupBox.TwoLineHeaderContentControl}" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="5,38,5,0" />
                                <Border HorizontalAlignment="Center" VerticalAlignment="Top" Width="31" Height="31" BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Collapsed.BorderBrush}" BorderThickness="1" Margin="5,3,8,0">
                                    <ContentPresenter x:Name="iconImage" Height="16" Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='16,16'}" Width="16" SnapsToDevicePixels="True" />
                                </Border>
                                <Popup x:Name="PART_Popup" Width="Auto" Height="Auto" AllowsTransparency="True" PlacementTarget="{Binding ElementName=grid1, Mode=OneWay}" StaysOpen="True" IsOpen="{TemplateBinding IsDropDownOpen}">
                                    <Grid Width="Auto" Height="Auto" Margin="0,20">
                                        <Border x:Name="border" Height="Auto" Background="{DynamicResource Fluent.Ribbon.Brushes.Ribbon.Background}" BorderBrush="Transparent" BorderThickness="0">
                                            <ContentControl x:Name="popupContent" />
                                        </Border>
                                    </Grid>
                                </Popup>
                            </Grid>
                            <Rectangle x:Name="separator" HorizontalAlignment="Right" VerticalAlignment="Stretch" Width="1" Fill="{DynamicResource PlexRibbonForegroundBrush}" Stroke="Transparent" StrokeThickness="0" Grid.RowSpan="2" Visibility="{Binding IsSeparatorVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <Rectangle.OpacityMask>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="Transparent"/>
                                            <GradientStop Offset="0.125" Color="#C0FFFFFF"/>
                                            <GradientStop Offset="0.5" Color="White"/>
                                            <GradientStop Offset="1" Color="Transparent"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Rectangle.OpacityMask>
                            </Rectangle>
                        </Grid>
                        <Image x:Name="PART_SnappedImage" Visibility="Collapsed" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="State" Value="Collapsed">
                            <Setter Property="Visibility" TargetName="grid1" Value="Visible" />
                            <Setter Property="UIElement.Visibility" TargetName="border1" Value="Collapsed" />
                            <Setter Property="HorizontalAlignment" TargetName="grid2" Value="Left" />
                            <Setter Property="Content" TargetName="border1" Value="{x:Null}" />
                            <Setter Property="Content" TargetName="popupContent" Value="{Binding ElementName=PART_ParentPanel}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="State" Value="Collapsed" />
                                <Condition Property="IsMouseOver" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Collapsed.MouseOver.Background}" />
                        </MultiTrigger>
                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Setter Property="Background" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.DropDownOpen.Background}" />
                        </Trigger>
                        <Trigger Property="IsLauncherVisible" Value="False">
                            <Setter Property="Visibility" TargetName="PART_DialogLauncherButton" Value="Collapsed" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="State" Value="QuickAccess">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="22" />
                <Setter Property="Focusable" Value="False" />
                <Setter Property="SnapsToDevicePixels" Value="False" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Fluent:RibbonGroupBox}">
                            <Grid Width="22">
                                <Border x:Name="PART_ButtonBorder"
                    BorderThickness="1"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    Height="Auto"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Stretch">
                                    <ContentPresenter x:Name="iconImage"
                                  HorizontalAlignment="Center"
                                  Height="16"
                                  VerticalAlignment="Center"
                                  Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToImageConverter}, ConverterParameter='16,16'}"
                                  Width="16"
                                  Margin="1,1,0,0"
                                  SnapsToDevicePixels="True" />
                                </Border>

                                <Popup x:Name="PART_Popup"
                   Placement="Bottom"
                   IsOpen="{TemplateBinding IsDropDownOpen}"
                   AllowsTransparency="True"
                   Focusable="False"
                   PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}"
                   Margin="0,0,-4,0"
                   VerticalAlignment="Top"
                   Grid.ColumnSpan="2">
                                    <Grid Width="Auto"
                      Height="Auto"
                      Margin="0,20">
                                        <Border x:Name="border"
                            Height="Auto"
                            Background="{DynamicResource Fluent.Ribbon.Brushes.Ribbon.Background}"
                            BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.BorderBrush}"
                            BorderThickness="1">
                                            <Grid x:Name="PART_ParentPanel"
                              Margin="0,1,0,2"
                              Height="85">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>

                                                <Fluent:RibbonGroupBoxWrapPanel x:Name="PART_UpPanel"
                                                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                            VerticalAlignment="Stretch"
                                                            Width="Auto"
                                                            Height="Auto"
                                                            IsItemsHost="True"
                                                            Margin="2,0,4,0" />

                                                <Grid x:Name="PART_DownGrid"
                                  Margin="0,-2,2,2"
                                  Grid.Row="1"
                                  VerticalAlignment="Bottom"
                                  Height="Auto"
                                  MaxWidth="{Binding ActualWidth, ElementName=PART_UpPanel}">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <ContentControl Content="{TemplateBinding Header}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="2,0"/>
                                                    <Fluent:Button Margin="0,0,1,1" x:Name="PART_DialogLauncherButton" HorizontalAlignment="Stretch" Width="15" Height="14" Grid.Column="1" Focusable="False" IsTabStop="False" Template="{DynamicResource DialogLauncherButtonControlTemplate}" Background="Transparent" BorderBrush="Transparent" VerticalAlignment="Bottom" Icon="{TemplateBinding LauncherIcon}" Header="{TemplateBinding LauncherText}" Command="{Binding LauncherCommand, RelativeSource={RelativeSource TemplatedParent}}" CommandTarget="{Binding LauncherCommandTarget, RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="{Binding LauncherCommandParameter, RelativeSource={RelativeSource TemplatedParent}}" ToolTip="{Binding LauncherToolTip, RelativeSource={RelativeSource TemplatedParent}}" IsEnabled="{Binding IsLauncherEnabled, RelativeSource={RelativeSource TemplatedParent}}" />
                                                </Grid>
                                            </Grid>
                                        </Border>
                                    </Grid>
                                </Popup>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDropDownOpen"
                     Value="True">
                                    <Setter Property="BorderBrush"
                        TargetName="PART_ButtonBorder"
                        Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.BorderBrush}" />
                                    <Setter Property="Background"
                        TargetName="PART_ButtonBorder"
                        Value="{DynamicResource Fluent.Ribbon.Brushes.Button.Pressed.Background}" />
                                </Trigger>
                                <Trigger Property="IsEnabled"
                     Value="False">
                                    <Setter Property="Opacity"
                        TargetName="iconImage"
                        Value="0.5" />
                                    <Setter Property="Effect"
                        TargetName="iconImage">
                                        <Setter.Value>
                                            <Fluent:GrayscaleEffect />
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver"
                               Value="True" />
                                        <Condition Property="IsDropDownOpen"
                               Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Background"
                        TargetName="PART_ButtonBorder"
                        Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.Background}" />
                                    <Setter Property="BorderBrush"
                        TargetName="PART_ButtonBorder"
                        Value="{DynamicResource Fluent.Ribbon.Brushes.Button.MouseOver.BorderBrush}" />
                                </MultiTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>


    <Style x:Key="{x:Type Fluent:ContextMenu}" TargetType="{x:Type Fluent:ContextMenu}">
        <Setter Property="OverridesDefaultStyle" Value="True"/>
        <Setter Property="Foreground" Value="{DynamicResource PlexRibbonForegroundBrush}" />
        <Setter Property="MinWidth" Value="0" />
        <Setter Property="MinHeight" Value="0" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Fluent:ContextMenu}">
                    <Grid Margin="{TemplateBinding Margin}">
                        <Border IsHitTestVisible="False" Background="Black" BorderBrush="Transparent">
                            <Border.Effect>
                                <DropShadowEffect x:Name="DropShadow" Color="Black" Direction="230" ShadowDepth="3" BlurRadius="3" Opacity="0.375"/>
                            </Border.Effect>
                        </Border>
                        <Border BorderThickness="1" CornerRadius="0" Margin="0" Padding="{TemplateBinding Padding}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{DynamicResource ContextMenuBackgroundBrush}" BorderBrush="{DynamicResource ContextMenuBorderBrush}">
                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" Margin="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="CurrentDirectoryListViewItemStyle" TargetType="{x:Type ListViewItem}" BasedOn="{StaticResource {x:Type ListViewItem}}"/>

    <Style x:Key="CurrentDirectoryListViewStyle" TargetType="ListView">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="{x:Type ListViewItem}" BasedOn="{StaticResource {x:Type ListViewItem}}">
                    <Setter Property="IsSelected" Value="{Binding Selected}"/>
                </Style>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding CurrentView, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type local:MainWindow}}}" Value="Icons">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <WrapPanel IsItemsHost="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{TemplateBinding Background}"/>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="ItemTemplate">
                    <Setter.Value>
                        <DataTemplate DataType="{x:Type disk:DiskItem}">
                            <StackPanel x:Name="RootStackPanel" Width="{Binding IconSize, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type local:MainWindow}}, Converter={StaticResource DoubleAdderConverter}, ConverterParameter=8}" MaxHeight="{Binding IconSize, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type local:MainWindow}}, Converter={StaticResource DoubleAdderConverter}, ConverterParameter=41}" Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Top">
                                <Canvas Width="{Binding IconSize, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type local:MainWindow}}}" Height="{Binding IconSize, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type local:MainWindow}}}" HorizontalAlignment="Center">
                                    <Canvas.Background>
                                        <Binding ConverterParameter="48">
                                            <Binding.Converter>
                                                <disk:DiskItemToIconImageBrushOrThumbnailConverter/>
                                            </Binding.Converter>
                                        </Binding>
                                    </Canvas.Background>
                                </Canvas>
                                <Grid>
                                    <TextBlock Text="{Binding ItemName}" HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap"/>
                                </Grid>
                            </StackPanel>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <!--Style x:Key="CurrentDirectoryListViewStyle" TargetType="ListView">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <WrapPanel IsItemsHost="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{TemplateBinding Background}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style-->

    <Style x:Key="NavigationPaneTreeViewStyle" TargetType="TreeView">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="ItemTemplate" Value="{DynamicResource NavigationPaneDataTemplate}"/>
        <Setter Property="ItemContainerStyle" Value="{DynamicResource NavigationPaneTreeViewItemStyle}"/>
        <Setter Property="Width" Value="190"/>
        <Setter Property="Margin" Value="0"/>
        <Setter Property="Padding" Value="0"/>
    </Style>

    <Style x:Key="NavigationPaneTreeViewItemStyle" TargetType="TreeViewItem" BasedOn="{StaticResource {x:Type TreeViewItem}}">
        <Setter Property="OverridesDefaultStyle" Value="True"/>
        <Setter Property="ItemTemplate" Value="{DynamicResource NavigationPaneDataTemplate}"/>
        <Setter Property="ItemContainerStyle" Value="{DynamicResource NavigationPaneTreeViewItemStyle}"/>
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Foreground" Value="Black" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        <Setter Property="MinHeight" Value="30" />
        <Setter Property="Margin" Value="0"/>
        <Setter Property="Width" Value="190"/>
        <Setter Property="Padding">
            <Setter.Value>
                <Binding ConverterParameter="5" Path="Padding" RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType=TreeViewItem}">
                    <Binding.FallbackValue>
                        <Thickness>0</Thickness>
                    </Binding.FallbackValue>
                    <Binding.Converter>
                        <local:NavPaneTreeViewItemMarginConverter/>
                    </Binding.Converter>
                    <!--Binding>
                        <Binding.FallbackValue>
                            <Thickness>0</Thickness>
                        </Binding.FallbackValue>
                    </Binding>
                    <Binding Path="Margin" RelativeSource="{RelativeSource Mode=Self}"/-->
                </Binding>
            </Setter.Value>
        </Setter>
        <!-- Value="{Binding Tag, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=TreeViewItem}, FallbackValue=0}"/-->
        <!--Setter Property="Width">
            <Setter.Value>
                <MultiBinding Converter="{StaticResource ThicknessLeftToSubtractDoubleConverter}">
                    <Binding Path="Width" RelativeSource="{RelativeSource Mode=Self}"/>
                    <Binding Path="Padding" RelativeSource="{RelativeSource Mode=Self}"/>
                </MultiBinding>
            </Setter.Value>
        </Setter-->
        <Setter Property="MaxWidth" Value="{Binding Width, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=TreeViewItem}, FallbackValue=190}"/>
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="Tag" Value="{x:Static Visibility.Visible}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TreeViewItem}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Grid HorizontalAlignment="Stretch" Height="Auto" Grid.Row="0">
                            <Border x:Name="HoverBackground" BorderThickness="1" Padding="0" Margin="0,0,214,0" CornerRadius="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0" MinWidth="0">
                                <Border.BorderBrush>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="#FF599EE2"/>
                                            <GradientStop Offset="1" Color="#FF61B4FF"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.BorderBrush>
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="#FF80C3FF"/>
                                            <GradientStop Offset="0.45" Color="#FF70B2FF"/>
                                            <GradientStop Offset="0.9" Color="#FF8CCEFF"/>
                                            <GradientStop Offset="1" Color="#FF83C4FF"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Border BorderBrush="Transparent" BorderThickness="0">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                            <LinearGradientBrush.GradientStops>
                                                <GradientStop x:Name="LightColorTop" Offset="0" Color="#FF1C5F9B"/>
                                                <GradientStop x:Name="LightColorMiddle" Offset="0.45" Color="#FF0C4E9B"/>
                                                <GradientStop x:Name="LightColorBottom" Offset="0.9" Color="#FF286A9B"/>
                                                <GradientStop x:Name="LightColorBottomBelow" Offset="1" Color="#FF83C4FF"/>
                                            </LinearGradientBrush.GradientStops>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                            </Border>
                            <Border x:Name="SelectedBackground" BorderThickness="1" Padding="0" Margin="0" CornerRadius="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0" MinWidth="0">
                                <Border.BorderBrush>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="#FF599EE2"/>
                                            <GradientStop Offset="1" Color="#FF61B4FF"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.BorderBrush>
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="#FF80C3FF"/>
                                            <GradientStop Offset="0.45" Color="#FF70B2FF"/>
                                            <GradientStop Offset="0.9" Color="#FF8CCEFF"/>
                                            <GradientStop Offset="1" Color="#FF83C4FF"/>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Border BorderBrush="Transparent" BorderThickness="0">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                            <LinearGradientBrush.GradientStops>
                                                <GradientStop Offset="0" Color="#401C5F9B"/>
                                                <GradientStop Offset="0.45" Color="#400C4E9B"/>
                                                <GradientStop Offset="0.9" Color="#40286A9B"/>
                                                <GradientStop Offset="1" Color="#4083C4FF"/>
                                            </LinearGradientBrush.GradientStops>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                            </Border>
                            <DockPanel Grid.Row="0" Margin="{TemplateBinding Padding}">
                                <ToggleButton x:Name="Expander" Margin="8,0" ClickMode="Release" IsChecked="{Binding Path=IsExpanded, RelativeSource={x:Static RelativeSource.TemplatedParent}, Mode=TwoWay}" VerticalContentAlignment="center" HorizontalContentAlignment="Left" SnapsToDevicePixels="True" UseLayoutRounding="True" Visibility="Visible" HorizontalAlignment="Center" VerticalAlignment="Center" FocusVisualStyle="{x:Null}" DockPanel.Dock="Left">
                                    <ToggleButton.Style>
                                        <Style TargetType="ToggleButton">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="BorderBrush" Value="Transparent" />
                                            <Setter Property="HorizontalAlignment" Value="Left"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="BorderThickness" Value="0" />
                                            <Setter Property="Width" Value="8"/>
                                            <Setter Property="Height" Value="16"/>
                                            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                            <Setter Property="SnapsToDevicePixels" Value="True" />
                                            <Setter Property="UseLayoutRounding" Value="True" />
                                            <Setter Property="Effect">
                                                <Setter.Value>
                                                    <DropShadowEffect x:Name="DropShadow" Color="Black" Direction="320" ShadowDepth="1.5"
                                              BlurRadius="5" Opacity="0.5" />
                                                </Setter.Value>
                                            </Setter>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="ToggleButton">
                                                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" RenderTransformOrigin="0.5,0.5">
                                                            <Grid.RenderTransform>
                                                                <RotateTransform x:Name="Rotator" Angle="0"/>
                                                            </Grid.RenderTransform>
                                                            <Rectangle HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                                <Path x:Name="Arrow" Data="M 0 0 L 8 8 L 0 16 Z" Stroke="#FFA0D2FF" StrokeThickness="1">
                                                                    <Path.Fill>
                                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                            <LinearGradientBrush.GradientStops>
                                                                                <GradientStop Offset="0" Color="#FF66B7CC"/>
                                                                                <GradientStop Offset="1" Color="#FF66B7CC"/>
                                                                            </LinearGradientBrush.GradientStops>
                                                                        </LinearGradientBrush>
                                                                    </Path.Fill>
                                                                </Path>
                                                                <ContentPresenter HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="{TemplateBinding Padding}"/>
                                                            </StackPanel>
                                                        </Grid>
                                                        <ControlTemplate.Triggers>
                                                            <Trigger Property="IsChecked" Value="True">
                                                                <Trigger.EnterActions>
                                                                    <BeginStoryboard>
                                                                        <Storyboard>
                                                                            <DoubleAnimation Storyboard.TargetName="Rotator" Storyboard.TargetProperty="Angle" To="45" Duration="0:0:0.125"/>
                                                                        </Storyboard>
                                                                    </BeginStoryboard>
                                                                </Trigger.EnterActions>
                                                                <Trigger.ExitActions>
                                                                    <BeginStoryboard>
                                                                        <Storyboard>
                                                                            <DoubleAnimation Storyboard.TargetName="Rotator" Storyboard.TargetProperty="Angle" To="0" Duration="0:0:0.125"/>
                                                                        </Storyboard>
                                                                    </BeginStoryboard>
                                                                </Trigger.ExitActions>
                                                            </Trigger>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter TargetName="Arrow" Property="Fill" Value="{DynamicResource CaptionButtonActiveHoverBrush}"/>
                                                                <Setter TargetName="Arrow" Property="Fill" Value="{DynamicResource CaptionButtonActiveHoverBrush}"/>
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ToggleButton.Style>
                                    <!--Margin="{Binding Padding, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type TreeViewItem}, PreviousData={RelativeSource Mode=FindAncestor, AncestorType={x:Type TreeViewItem}}}}"-->
                                </ToggleButton>
                                <ContentPresenter x:Name="PART_Header" ContentSource="Header" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            </DockPanel>
                        </Grid>
                        <ItemsPresenter x:Name="ItemsHost" HorizontalAlignment="Stretch" Height="Auto" Visibility="Visible" Width="{TemplateBinding Width}" Grid.Row="1" Margin="0"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Tag" Value="{x:Static Visibility.Hidden}">
                            <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
                            <Setter TargetName="Expander" Property="Margin" Value="9,0,0,0"/>
                            <!--Setter TargetName="Expander" Property="Margin" Value="0"/-->
                        </Trigger>
                        <Trigger SourceName="Expander" Property="IsChecked" Value="True">
                            <Setter Property="IsExpanded" Value="True"/>
                            <Setter TargetName="ItemsHost" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="IsExpanded" Value="False">
                            <Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasHeader" Value="false"/>
                                <Condition Property="Width" Value="Auto"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_Header" Property="MinWidth" Value="75"/>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HasHeader" Value="false"/>
                                <Condition Property="Height" Value="Auto"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_Header" Property="MinHeight" Value="19"/>
                        </MultiTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorTop" Storyboard.TargetProperty="Color" To="#FF80C3FF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorMiddle" Storyboard.TargetProperty="Color" To="#FF70B2FF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottom" Storyboard.TargetProperty="Color" To="#FF8CCEFF" Duration="0:0:0.125"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottomBelow" Storyboard.TargetProperty="Color" To="#FF83C4FF" Duration="0:0:0.125"/>
                                        <ThicknessAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Margin" To="0" Duration="0:0:0.125">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorTop" Storyboard.TargetProperty="Color" To="#FF1C5F9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorMiddle" Storyboard.TargetProperty="Color" To="#FF0C4E9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottom" Storyboard.TargetProperty="Color" To="#FF286A9B" Duration="0:0:0.375"/>
                                        <ColorAnimation Storyboard.TargetName="LightColorBottomBelow" Storyboard.TargetProperty="Color" To="#FF1F609B" Duration="0:0:0.375"/>
                                        <ThicknessAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Margin" To="0,0,214,0" Duration="0:0:0.375">
                                            <ThicknessAnimation.EasingFunction>
                                                <CircleEase EasingMode="EaseOut"/>
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.125"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.5"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="true"/>
                                <Condition Property="IsSelectionActive" Value="false"/>
                            </MultiTrigger.Conditions>
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                        </MultiTrigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="VirtualizingStackPanel.IsVirtualizing" Value="True">
                <Setter Property="ItemsPanel">
                    <Setter.Value>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel />
                        </ItemsPanelTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="NavigationFavoritesTreeViewItemStyle" TargetType="TreeViewItem" BasedOn="{StaticResource NavigationPaneTreeViewItemStyle}">
        <Setter Property="Tag" Value="{x:Static Visibility.Hidden}"/>
    </Style>

    <HierarchicalDataTemplate x:Key="NavigationPaneDataTemplate" DataType="{x:Type disk:DiskItem}" ItemsSource="{Binding SubItems}" ItemContainerStyle="{StaticResource NavigationPaneTreeViewItemStyle}">
        <!--TreeViewItem Style="{DynamicResource NavigationPaneTreeViewItemStyle}" ItemsSource="{Binding SubItems}" ItemTemplate="{DynamicResource NavigationPaneDataTemplate}">
            <TreeViewItem.Header-->
        <DockPanel Margin="0,2">
            <Canvas Width="16" Height="16" DockPanel.Dock="Left" Margin="0,0,8,0">
                <Canvas.Background>
                    <Binding ConverterParameter="16">
                        <Binding.Converter>
                            <disk:DiskItemToIconImageBrushConverter/>
                        </Binding.Converter>
                    </Binding>
                </Canvas.Background>
            </Canvas>
            <TextBlock Text="{Binding ItemName}"/>
        </DockPanel>
        <!--/TreeViewItem.Header>
        </TreeViewItem.Header-->
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate x:Key="NavigationFavoritesDataTemplate" DataType="{x:Type disk:DiskItem}" ItemContainerStyle="{StaticResource NavigationFavoritesTreeViewItemStyle}">
        <!--TreeViewItem Style="{DynamicResource NavigationPaneTreeViewItemStyle}" ItemsSource="{Binding SubItems}" ItemTemplate="{DynamicResource NavigationPaneDataTemplate}">
            <TreeViewItem.Header-->
        <DockPanel Margin="0,2">
            <Canvas Width="16" Height="16" DockPanel.Dock="Left" Margin="0,0,8,0">
                <Canvas.Background>
                    <Binding ConverterParameter="16">
                        <Binding.Converter>
                            <disk:DiskItemToIconImageBrushConverter/>
                        </Binding.Converter>
                    </Binding>
                </Canvas.Background>
            </Canvas>
            <TextBlock Text="{Binding ItemName}"/>
        </DockPanel>
        <!--/TreeViewItem.Header>
        </TreeViewItem.Header-->
    </HierarchicalDataTemplate>

    <DropShadowEffect x:Key="IconOuterShadow" Color="Black" Direction="225" ShadowDepth="3" BlurRadius="25" Opacity="0.375" />

    <DropShadowEffect x:Key="IconInnerShadow" Color="#FF5AA8F5" Direction="225" ShadowDepth="2" BlurRadius="7" Opacity="1" />

    <DropShadowEffect x:Key="IconSmallShadow" Color="Black" Direction="225" ShadowDepth="3" BlurRadius="7" Opacity="0.375" />

    <LinearGradientBrush x:Key="IconPrimaryFillBrush" StartPoint="0,1" EndPoint="1,0">
        <LinearGradientBrush.GradientStops>
            <GradientStop Offset="0" Color="#FF87BAE8"/>
            <GradientStop Offset="1" Color="#FF9DD0FE"/>
        </LinearGradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="IconPrimaryDarkFillBrush" StartPoint="0,1" EndPoint="1,0">
        <LinearGradientBrush.GradientStops>
            <GradientStop Offset="0" Color="#FF5588B6"/>
            <GradientStop Offset="1" Color="#FF6B9ECC"/>
        </LinearGradientBrush.GradientStops>
    </LinearGradientBrush>

    <RadialGradientBrush x:Key="IconSecondaryFillBrush" GradientOrigin="0.5,0.5" Center="0.5,0.5">
        <RadialGradientBrush.GradientStops>
            <GradientStop Offset="0" Color="#FFACD4FF"/>
            <GradientStop Offset="1" Color="#FFFAFBFF"/>
        </RadialGradientBrush.GradientStops>
    </RadialGradientBrush>

    <LinearGradientBrush x:Key="IconTertiaryFillBrush" StartPoint="0,1" EndPoint="1,0">
        <LinearGradientBrush.GradientStops>
            <GradientStop Offset="0" Color="#FFA0D3FF"/>
            <GradientStop Offset="1" Color="#FFB6E9FF"/>
        </LinearGradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="IconForegroundBrush" StartPoint="0,1" EndPoint="1,0">
        <LinearGradientBrush.GradientStops>
            <GradientStop Offset="0" Color="#FF002452"/>
            <GradientStop Offset="1" Color="#FF073A68"/>
        </LinearGradientBrush.GradientStops>
    </LinearGradientBrush>

    <Grid x:Key="CopyButtonLargeIcon" Width="30" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}">
            <Path Data="M 0 0 L 13 0 L 18 5 L 18 22 L 0 22 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}"/>
            <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconInnerShadow}"/>
        </Grid>
        <Grid HorizontalAlignment="Right" VerticalAlignment="Bottom" Effect="{DynamicResource IconOuterShadow}">
            <Path Data="M 0 0 L 13 0 L 18 5 L 18 22 L 0 22 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}"/>
            <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconInnerShadow}"/>
        </Grid>
    </Grid>

    <Grid x:Key="PasteButtonLargeIcon" Width="24" Height="28" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Border Background="{DynamicResource IconPrimaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryDarkFillBrush}" BorderThickness="3" CornerRadius="1" Effect="{DynamicResource IconOuterShadow}">
            <Path Data="M 0 6 L 7 0 L 14 6 Z" HorizontalAlignment="Center" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Margin="0,-6">
                <Path.Effect>
                    <DropShadowEffect Color="#FF5AA8F5" Direction="135" ShadowDepth="3" BlurRadius="7" Opacity="1"/>
                </Path.Effect>
            </Path>
        </Border>
    </Grid>

    <Grid x:Key="CutButtonIcon" Width="16" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid Effect="{DynamicResource IconOuterShadow}" >
            <Path Data="m 12.315449 282 -5.4981337 7.73217 c -1.7253089 0.32017 -3.5727233 0.91709 -4.7478438 1.85197 -0.3465542 0.2757 -0.6386254 0.57846 -0.8374526 0.94097 -0.1988273 0.36252 -0.29141216 0.80816 -0.1914178 1.24053 0.1999887 0.86475 0.9861796 1.49354 2.315813 2.05991 L 3.7700132 296 l 0.1691995 -0.23789 0.011964 0.0106 8.3642723 -9.47841 z m -1.136543 3.58239 v 0.25725 l -0.945125 1.07137 z m -5.3938793 5.59999 -2.3739219 3.33921 c -0.8117398 -0.42222 -1.2174223 -0.82278 -1.2647243 -1.02731 -0.0279 -0.12065 -0.015234 -0.22319 0.076909 -0.39119 0.092143 -0.16801 0.2758698 -0.37876 0.5417806 -0.59031 0.6691648 -0.53236 1.819182 -0.97754 3.0199566 -1.3304 z" Fill="{DynamicResource IconPrimaryFillBrush}" Width="16" Height="16" StrokeThickness="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
        </Grid>
    </Grid>

    <Grid x:Key="CopyPathButtonIcon" Width="16" Height="12" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Background="#01000000">
        <Border Background="{DynamicResource IconPrimaryFillBrush}" BorderThickness="0" CornerRadius="1" Effect="{DynamicResource IconSmallShadow}">
            <TextBlock Foreground="{DynamicResource IconForegroundBrush}" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="7" Text="\\..."/>
        </Border>
    </Grid>

    <Grid x:Key="PasteShortcutButtonIcon" Width="14" Height="16" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center" Background="#01000000">
        <Border Background="{DynamicResource IconPrimaryFillBrush}" BorderBrush="{DynamicResource IconPrimaryDarkFillBrush}" BorderThickness="2" CornerRadius="1" Effect="{DynamicResource IconSmallShadow}">
            <Grid>
                <Path Data="M 0 2 L 2 0 L 4 2 Z" HorizontalAlignment="Center" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Margin="0,-2">
                    <Path.Effect>
                        <DropShadowEffect Color="#FF5AA8F5" Direction="135" ShadowDepth="3" BlurRadius="1" Opacity="0.75"/>
                    </Path.Effect>
                </Path>
                <Canvas Width="8" Height="8" Background="{DynamicResource IconForegroundBrush}" Margin="-2,0,1,0">
                    <Canvas.OpacityMask>
                        <VisualBrush>
                            <VisualBrush.Visual>
                                <Grid Width="8" Height="8" Background="#01000000">
                                    <Path Data="M 0 0 L 4 0 L 4 4 Z" Fill="Black" Stroke="Black" StrokeThickness="0" HorizontalAlignment="Right" VerticalAlignment="Top"/>
                                    <Path Data="M 8 0 L 4 4 L 4 8 L 4 4 Z" Fill="Black" Stroke="Black" StrokeThickness="1"/>
                                </Grid>
                            </VisualBrush.Visual>
                        </VisualBrush>
                    </Canvas.OpacityMask>
                </Canvas>
            </Grid>
        </Border>
    </Grid>

    <Grid x:Key="MoveToButtonLargeIcon" Width="30" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
            <Path Data="M 0 0 L 20 4 L 20 18 L 22 20 L 22 28 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
            <Path Data="M 0 0 L 7 5 L 8 32 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconTertiaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
        </Grid>
        <Path Data="M 0 8 L 8 0 L 8 5 L 16 5 L 16 11 L 8 11 L 8 16 Z" Fill="{DynamicResource IconSecondaryFillBrush}" Stroke="Transparent" StrokeThickness="0" HorizontalAlignment="Right" VerticalAlignment="Center" Effect="{DynamicResource IconInnerShadow}"/>
    </Grid>

    <Grid x:Key="CopyToButtonLargeIcon" Width="30" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
            <Path Data="M 0 0 L 20 4 L 20 18 L 22 20 L 22 28 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
            <Path Data="M 0 0 L 7 5 L 8 32 L 0 24 Z" StrokeThickness="0" Fill="{DynamicResource IconTertiaryFillBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}"/>
        </Grid>
        <Grid Width="30" Height="32" HorizontalAlignment="Right" VerticalAlignment="Center" RenderTransformOrigin="1,0.5">
            <Grid.RenderTransform>
                <ScaleTransform ScaleX="0.5" ScaleY="0.5"/>
            </Grid.RenderTransform>
            <Grid HorizontalAlignment="Left" VerticalAlignment="Top" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 0 L 13 0 L 18 5 L 18 22 L 0 22 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}"/>
                <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconSmallShadow}"/>
            </Grid>
            <Grid HorizontalAlignment="Right" VerticalAlignment="Bottom" Effect="{DynamicResource IconOuterShadow}">
                <Path Data="M 0 0 L 13 0 L 18 5 L 18 22 L 0 22 Z" StrokeThickness="0" Fill="{DynamicResource IconPrimaryFillBrush}"/>
                <Path Data="M 0 0 L 0 6 L 6 6 Z" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="0" Fill="{DynamicResource IconSecondaryFillBrush}" Effect="{DynamicResource IconSmallShadow}"/>
            </Grid>
        </Grid>
    </Grid>

    <Grid x:Key="DeletThisButtonLargeIcon" Width="32" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid Width="32" Height="32" Background="{DynamicResource IconPrimaryFillBrush}" Effect="{DynamicResource IconOuterShadow}">
            <Grid.OpacityMask>
                <VisualBrush>
                    <VisualBrush.Visual>
                        <Grid Width="32" Height="24" Background="#01000000">
                            <Path Data="M 0 18 L 6 0 L 32 0" Fill="Transparent" Stroke="Black" StrokeThickness="6" HorizontalAlignment="Center" VerticalAlignment="Center" Width="32" Height="24"/>
                            <Path Data="M 0 0 L 12 0 L 9 12 L 0 12 Z" Stroke="Black" StrokeThickness="1" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="-5,-5,5,5"/>
                        </Grid>
                    </VisualBrush.Visual>
                </VisualBrush>
            </Grid.OpacityMask>
        </Grid>
    </Grid>

    <Grid x:Key="RenameButtonLargeIcon" Width="32" Height="32" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center">
        <Border Height="12" Background="{DynamicResource IconPrimaryFillBrush}" BorderThickness="0" CornerRadius="1" Effect="{DynamicResource IconOuterShadow}"/>
        <Canvas Width="12" Height="24" Background="{DynamicResource IconSecondaryFillBrush}" HorizontalAlignment="Right" Margin="6,0" Effect="{DynamicResource IconOuterShadow}">
            <Canvas.OpacityMask>
                <VisualBrush>
                    <VisualBrush.Visual>
                        <Border Width="12" Height="24" Background="Transparent" BorderBrush="Black" BorderThickness="0,2">
                            <Canvas Width="2" Background="Black"/>
                        </Border>
                    </VisualBrush.Visual>
                </VisualBrush>
            </Canvas.OpacityMask>
        </Canvas>
    </Grid>
</ResourceDictionary>